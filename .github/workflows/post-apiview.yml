name: After APIView

on:
  check_suite:
    types: [completed]
    
permissions:
  issues: write
  contents: read

jobs:
  event-handler:
    name: After APIView
    runs-on: ubuntu-24.04
    if: github.event.check_suite.app.name == 'Azure Pipelines'
    steps:
      - name: Checkout
        uses: actions/checkout@v2
        with:
          sparse-checkout: 'eng/common'
    
      - name: Create APIView Comment on PR
        run: |
          . ../../../eng/common/scripts/helpers/ApiView-Helpers.ps1
          Set-ApiViewCommentForRelatedIssues -HeadCommitish ${{ github.event.check_suite.head_sha }} -AuthToken ${{ secrets.GITHUB_TOKEN }}
        shell: pwsh
