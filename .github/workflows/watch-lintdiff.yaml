# Use ~ to sort the workflow to the bottom of the list
name: "~Watch - LintDiff"

on:
  # check_suite is preferred over check_run to avoid triggering on all check
  # runs. In some cases, check_run must be used in testing environments.
  check_suite:
    types: completed

  workflow_run:
    types: completed
    workflows: 
      - "\\[TEST-IGNORE\\] Swagger LintDiff"

permissions:
  checks: read
  contents: read

jobs:
  LintDiff:
    name: Watch LintDiff
    if: ${{ (github.event_name == 'workflow_run') || (github.event_name == 'check_suite' && github.event.check_suite.app.name == 'openapi-pipeline-app') || (github.event_name == 'check_run' && github.event.check_run.name == 'Swagger LintDiff') }}
    uses: ./.github/workflows/_reusable-verify-run-status.yaml
    with:
      check_run_name: "Swagger LintDiff"
      workflow_name: "[TEST-IGNORE] Swagger LintDiff"
