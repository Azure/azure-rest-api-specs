name: Upload KeyValue Artifact
description: Uploads an empty artifact with the specified key and value encoded in the name

inputs:
  key:
    description: Key
    required: true
  value:
    description: Value
    required: true

runs:
  using: composite

  steps:
    # When possible, it's best to upload an empty file with all information in the artifact name, so consumers
    # can query the information without needing to download files to disk.
    - name: Create empty file to upload artifact
      run: "> $RUNNER_TEMP/empty.txt"
      shell: bash

    # A recommended format is "key=value".  The maximum length is reported to be 260 characters.
    #
    # A full list of invalid artifact name characters is documented here:
    # https://github.com/actions/toolkit/blob/main/packages/artifact/src/internal/upload/path-and-artifact-name-validation.ts
    - uses: actions/upload-artifact@v4
      with:
        name: ${{ inputs.key }}=${{ inputs.value }}
        path: $RUNNER_TEMP/empty.txt
        if-no-files-found: error
        overwrite: true
