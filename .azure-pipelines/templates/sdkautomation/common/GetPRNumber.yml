steps:
  - script: |
      curl \
        -s https://api.github.com/repos/$(Build.Repository.Name)/commits/$(Build.SourceVersion)/pulls \
        -H "Accept: application/vnd.github.groot-preview+json" \
      | python3 -c "import sys,json; a=json.load(sys.stdin); print(f'##vso[task.setvariable variable=PR_NUMBER]{a[0][\"number\"]}' if len(a)>0 and a[0][\"base\"][\"ref\"]=='master' else '##vso[task.logissue type=error]Last commit $(Build.SourceVersion) doesnot have a related PR')"
    displayName: Get PR_NUMBER
    condition: in(variables['Build.Reason'], 'IndividualCI', 'Manual')
