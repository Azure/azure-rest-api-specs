{
  "swagger": "2.0",
  "info": {
    "version": "2.0",
    "title": "Common types"
  },
  "paths": {},
  "definitions": {
    "ErrorDetail": {
      "description": "The error detail.",
      "type": "object",
      "properties": {
        "code": {
          "readOnly": true,
          "type": "string",
          "description": "The error code."
        },
        "message": {
          "readOnly": true,
          "type": "string",
          "description": "The error message."
        },
        "target": {
          "readOnly": true,
          "type": "string",
          "description": "The error target."
        },
        "details": {
          "readOnly": true,
          "type": "array",
          "items": {
            "$ref": "#/definitions/ErrorDetail"
          },
          "x-ms-identifiers": [
            "message",
            "target"
          ],
          "description": "The error details."
        },
        "additionalInfo": {
          "readOnly": true,
          "type": "array",
          "items": {
            "$ref": "#/definitions/ErrorAdditionalInfo"
          },
          "x-ms-identifiers": [],
          "description": "The error additional info."
        }
      }
    },
    "ErrorResponse": {
      "title": "Error response",
      "description": "Common error response for all Azure Resource Manager APIs to return error details for failed operations. (This also follows the OData error response format.).",
      "type": "object",
      "properties": {
        "error": {
          "description": "The error object.",
          "$ref": "#/definitions/ErrorDetail"
        }
      }
    },
    "ErrorAdditionalInfo": {
      "type": "object",
      "properties": {
        "type": {
          "readOnly": true,
          "type": "string",
          "description": "The additional info type."
        },
        "info": {
          "readOnly": true,
          "type": "object",
          "description": "The additional info."
        }
      },
      "description": "The resource management error additional info."
    },
    "Resource": {
      "title": "Resource",
      "description": "Describes an Azure resource.",
      "type": "object",
      "properties": {
        "id": {
          "readOnly": true,
          "type": "string",
          "format": "arm-id",
          "description": "Resource Id"
        },
        "name": {
          "readOnly": true,
          "type": "string",
          "description": "Resource name"
        },
        "type": {
          "readOnly": true,
          "type": "string",
          "description": "Resource type"
        },
        "systemData": {
          "readOnly": true,
          "type": "object",
          "description": "Azure Resource Manager metadata containing createdBy and modifiedBy information.",
          "$ref": "#/definitions/systemData"
        }
      },
      "x-ms-azure-resource": true
    },
    "TrackedResource": {
      "type": "object",
      "description": "Describes an Azure tracked resource.",
      "allOf": [
        {
          "$ref": "#/definitions/Resource"
        },
        {
          "$ref": "#/definitions/AzureTrackedResourceLocation"
        },
        {
          "$ref": "#/definitions/Kind"
        },
        {
          "$ref": "#/definitions/ETag"
        },
        {
          "$ref": "#/definitions/Tags"
        }
      ]
    },
    "ETag": {
      "type": "object",
      "description": "Entity tag is used for comparing two or more entities from the same requested resource.",
      "properties": {
        "etag": {
          "type": "string",
          "description": "Entity tag is used for comparing two or more entities from the same requested resource."
        }
      }
    },
    "Tags": {
      "type": "object",
      "description": "A list of key value pairs that describe the resource.",
      "properties": {
        "tags": {
          "type": "object",
          "description": "A list of key value pairs that describe the resource.",
          "additionalProperties": {
            "type": "string"
          }
        }
      }
    },
    "Kind": {
      "type": "object",
      "description": "Describes an Azure resource with kind",
      "properties": {
        "kind": {
          "type": "string",
          "description": "Kind of the resource"
        }
      }
    },
    "Location": {
      "type": "object",
      "description": "Describes an Azure resource with location",
      "properties": {
        "location": {
          "readOnly": true,
          "type": "string",
          "description": "Location where the resource is stored"
        }
      }
    },
    "AzureTrackedResourceLocation": {
      "type": "object",
      "description": "Describes an Azure resource with location",
      "properties": {
        "location": {
          "type": "string",
          "description": "Location where the resource is stored"
        }
      }
    },
    "AscLocationList": {
      "type": "object",
      "description": "List of locations where ASC saves your data",
      "properties": {
        "value": {
          "readOnly": true,
          "type": "array",
          "items": {
            "$ref": "#/definitions/AscLocation"
          }
        },
        "nextLink": {
          "readOnly": true,
          "type": "string",
          "description": "The URI to fetch the next page."
        }
      }
    },
    "AscLocation": {
      "type": "object",
      "description": "The ASC location of the subscription is in the \"name\" field",
      "properties": {
        "properties": {
          "x-ms-client-flatten": true,
          "$ref": "#/definitions/AscLocationProperties"
        }
      },
      "allOf": [
        {
          "$ref": "#/definitions/Resource"
        }
      ]
    },
    "AscLocationProperties": {
      "type": "object",
      "description": "An empty set of properties"
    },
    "ResourceDetails": {
      "type": "object",
      "description": "Details of the resource that was assessed",
      "discriminator": "source",
      "properties": {
        "source": {
          "type": "string",
          "description": "The platform where the assessed resource resides",
          "enum": [
            "Azure",
            "OnPremise",
            "OnPremiseSql"
          ],
          "x-ms-enum": {
            "name": "source",
            "modelAsString": true,
            "values": [
              {
                "value": "Azure",
                "description": "Resource is in Azure"
              },
              {
                "value": "OnPremise",
                "description": "Resource in an on premise machine connected to Azure cloud"
              },
              {
                "value": "OnPremiseSql",
                "description": "SQL Resource in an on premise machine connected to Azure cloud"
              }
            ]
          }
        }
      },
      "required": [
        "source"
      ]
    },
    "AzureResourceDetails": {
      "type": "object",
      "description": "Details of the Azure resource that was assessed",
      "x-ms-discriminator-value": "Azure",
      "allOf": [
        {
          "$ref": "#/definitions/ResourceDetails"
        }
      ],
      "properties": {
        "id": {
          "readOnly": true,
          "type": "string",
          "description": "Azure resource Id of the assessed resource"
        }
      }
    },
    "OnPremiseResourceDetails": {
      "type": "object",
      "description": "Details of the On Premise resource that was assessed",
      "x-ms-discriminator-value": "OnPremise",
      "allOf": [
        {
          "$ref": "#/definitions/ResourceDetails"
        }
      ],
      "properties": {
        "workspaceId": {
          "type": "string",
          "description": "Azure resource Id of the workspace the machine is attached to"
        },
        "vmuuid": {
          "type": "string",
          "description": "The unique Id of the machine"
        },
        "sourceComputerId": {
          "type": "string",
          "description": "The oms agent Id installed on the machine"
        },
        "machineName": {
          "type": "string",
          "description": "The name of the machine"
        }
      },
      "required": [
        "workspaceId",
        "vmuuid",
        "sourceComputerId",
        "machineName"
      ]
    },
    "OnPremiseSqlResourceDetails": {
      "type": "object",
      "description": "Details of the On Premise Sql resource that was assessed",
      "x-ms-discriminator-value": "OnPremiseSql",
      "allOf": [
        {
          "$ref": "#/definitions/OnPremiseResourceDetails"
        }
      ],
      "properties": {
        "serverName": {
          "type": "string",
          "description": "The Sql server name installed on the machine"
        },
        "databaseName": {
          "type": "string",
          "description": "The Sql database name installed on the machine"
        }
      },
      "required": [
        "serverName",
        "databaseName"
      ]
    },
    "AzureResourceLinks": {
      "description": "array of azure resource IDs",
      "readOnly": true,
      "type": "array",
      "items": {
        "$ref": "#/definitions/AzureResourceLink"
      }
    },
    "AzureResourceLink": {
      "type": "object",
      "description": "Describes an Azure resource with kind",
      "properties": {
        "id": {
          "readOnly": true,
          "type": "string",
          "description": "Azure resource Id"
        }
      }
    },
    "ExternalSecuritySolutionKind": {
      "type": "object",
      "description": "Describes an Azure resource with kind",
      "properties": {
        "kind": {
          "type": "string",
          "description": "The kind of the external solution",
          "enum": [
            "CEF",
            "ATA",
            "AAD"
          ],
          "x-ms-enum": {
            "name": "ExternalSecuritySolutionKind",
            "modelAsString": true,
            "values": [
              {
                "value": "CEF"
              },
              {
                "value": "ATA"
              },
              {
                "value": "AAD"
              }
            ]
          }
        }
      }
    },
    "systemData": {
      "description": "Metadata pertaining to creation and last modification of the resource.",
      "type": "object",
      "readOnly": true,
      "properties": {
        "createdBy": {
          "type": "string",
          "description": "The identity that created the resource."
        },
        "createdByType": {
          "type": "string",
          "description": "The type of identity that created the resource.",
          "enum": [
            "User",
            "Application",
            "ManagedIdentity",
            "Key"
          ],
          "x-ms-enum": {
            "name": "createdByType",
            "modelAsString": true
          }
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp of resource creation (UTC)."
        },
        "lastModifiedBy": {
          "type": "string",
          "description": "The identity that last modified the resource."
        },
        "lastModifiedByType": {
          "type": "string",
          "description": "The type of identity that last modified the resource.",
          "enum": [
            "User",
            "Application",
            "ManagedIdentity",
            "Key"
          ],
          "x-ms-enum": {
            "name": "createdByType",
            "modelAsString": true
          }
        },
        "lastModifiedAt": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp of resource last modification (UTC)"
        }
      }
    }
  },
  "parameters": {
    "SubscriptionIdParameter": {
      "name": "subscriptionId",
      "in": "path",
      "required": true,
      "type": "string",
      "format": "uuid",
      "description": "Azure subscription ID"
    },
    "ManagementGroupId": {
      "name": "managementGroupId",
      "in": "path",
      "required": true,
      "type": "string",
      "description": "Azure Management Group ID"
    },
    "ResourceGroupNameParameter": {
      "name": "resourceGroupName",
      "in": "path",
      "required": true,
      "type": "string",
      "description": "The name of the resource group within the user's subscription. The name is case insensitive.",
      "minLength": 1,
      "maxLength": 90,
      "x-ms-parameter-location": "method"
    },
    "ApiVersionParameter": {
      "name": "api-version",
      "in": "query",
      "required": true,
      "type": "string",
      "description": "API version for the operation",
      "minLength": 1
    },
    "AscLocation": {
      "name": "ascLocation",
      "in": "path",
      "required": true,
      "type": "string",
      "description": "The location where ASC stores the data of the subscription. can be retrieved from Get locations",
      "x-ms-parameter-location": "method"
    },
    "ResourceId": {
      "name": "resourceId",
      "in": "path",
      "required": true,
      "type": "string",
      "description": "The identifier of the resource.",
      "x-ms-parameter-location": "method",
      "x-ms-skip-url-encoding": true
    },
    "ScopeParameter": {
      "name": "scope",
      "in": "path",
      "required": true,
      "type": "string",
      "description": "The scope at which the operation is performed.",
      "minLength": 1,
      "maxLength": 90,
      "x-ms-parameter-location": "method",
      "x-ms-skip-url-encoding": true
    },
    "ODataFilter": {
      "name": "$filter",
      "in": "query",
      "required": false,
      "type": "string",
      "description": "OData filter. Optional.",
      "x-ms-parameter-location": "method"
    },
    "ODataSelect": {
      "name": "$select",
      "in": "query",
      "required": false,
      "type": "string",
      "description": "OData select. Optional.",
      "x-ms-parameter-location": "method"
    },
    "ODataExpand": {
      "name": "$expand",
      "in": "query",
      "required": false,
      "type": "string",
      "description": "OData expand. Optional.",
      "x-ms-parameter-location": "method"
    }
  }
}
