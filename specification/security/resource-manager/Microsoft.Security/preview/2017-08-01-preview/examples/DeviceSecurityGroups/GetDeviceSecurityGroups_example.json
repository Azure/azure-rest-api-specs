{
  "parameters": {
    "api-version": "2017-08-01-preview",
    "resourceId": "subscriptions/20ff7fc3-e762-44dd-bd96-b71116dcdc23/resourceGroups/SampleRG/providers/Microsoft.Devices/iotHubs/sampleiothub",
    "deviceSecurityGroupName": "samplesecuritygroup"
  },
  "responses": {
    "200": {
      "body": {
        "id": "/subscriptions/20ff7fc3-e762-44dd-bd96-b71116dcdc23/resourceGroups/SampleRG/providers/Microsoft.Devices/iotHubs/sampleiothub/providers/Microsoft.Security/deviceSecurityGroups/samplesecuritygroup",
        "name": "samplesecuritygroup",
        "type": "Microsoft.Security/deviceSecurityGroups",
        "properties": {
          "thresholdRules": [],
          "timeWindowRules": [
            {
              "ruleType": "ActiveConnectionsNotInAllowedRange",
              "displayName": "Number of active connections is not in allowed range",
              "description": "Get an alert when the number of active connections of a device in the time window is not in the allowed range",
              "isEnabled": false,
              "minThreshold": 0,
              "maxThreshold": 0,
              "timeWindowSize": "PT15M"
            },
            {
              "ruleType": "AmqpC2DMessagesNotInAllowedRange",
              "displayName": "Number of cloud to device messages (AMQP protocol) is not in allowed range",
              "description": "Get an alert when the number of cloud to device messages (AMQP protocol) in the time window is not in the allowed range",
              "isEnabled": false,
              "minThreshold": 0,
              "maxThreshold": 0,
              "timeWindowSize": "PT15M"
            },
            {
              "ruleType": "MqttC2DMessagesNotInAllowedRange",
              "displayName": "Number of cloud to device messages (MQTT protocol) is not in allowed range",
              "description": "Get an alert when the number of cloud to device messages (MQTT protocol) in the time window is not in the allowed range",
              "isEnabled": false,
              "minThreshold": 0,
              "maxThreshold": 0,
              "timeWindowSize": "PT15M"
            },
            {
              "ruleType": "HttpC2DMessagesNotInAllowedRange",
              "displayName": "Number of cloud to device messages (HTTP protocol) is not in allowed range",
              "description": "Get an alert when the number of cloud to device messages (HTTP protocol) in the time window is not in the allowed range",
              "isEnabled": false,
              "minThreshold": 0,
              "maxThreshold": 0,
              "timeWindowSize": "PT15M"
            },
            {
              "ruleType": "AmqpC2DRejectedMessagesNotInAllowedRange",
              "displayName": "Number of rejected cloud to device messages (AMQP protocol) is not in allowed range",
              "description": "Get an alert when the number of cloud to device messages (AMQP protocol) that were rejected by the device in the time window is not in the allowed range",
              "isEnabled": false,
              "minThreshold": 0,
              "maxThreshold": 0,
              "timeWindowSize": "PT15M"
            },
            {
              "ruleType": "MqttC2DRejectedMessagesNotInAllowedRange",
              "displayName": "Number of rejected cloud to device messages (MQTT protocol) is not in allowed range",
              "description": "Get an alert when the number of cloud to device messages (MQTT protocol) that were rejected by the device in the time window is not in the allowed range",
              "isEnabled": false,
              "minThreshold": 0,
              "maxThreshold": 0,
              "timeWindowSize": "PT15M"
            },
            {
              "ruleType": "HttpC2DRejectedMessagesNotInAllowedRange",
              "displayName": "Number of rejected cloud to device messages (HTTP protocol) is not in allowed range",
              "description": "Get an alert when the number of cloud to device messages (HTTP protocol) that were rejected by the device in the time window is not in the allowed range",
              "isEnabled": false,
              "minThreshold": 0,
              "maxThreshold": 0,
              "timeWindowSize": "PT15M"
            },
            {
              "ruleType": "AmqpD2CMessagesNotInAllowedRange",
              "displayName": "Number of device to cloud messages (AMQP protocol) is not in allowed range",
              "description": "Get an alert when the number of device to cloud messages (AMQP protocol) in the time window is not in the allowed range",
              "isEnabled": false,
              "minThreshold": 0,
              "maxThreshold": 0,
              "timeWindowSize": "PT15M"
            },
            {
              "ruleType": "MqttD2CMessagesNotInAllowedRange",
              "displayName": "Number of device to cloud messages (MQTT protocol) is not in allowed range",
              "description": "Get an alert when the number of device to cloud messages (MQTT protocol) in the time window is not in the allowed range",
              "isEnabled": false,
              "minThreshold": 0,
              "maxThreshold": 0,
              "timeWindowSize": "PT15M"
            },
            {
              "ruleType": "HttpD2CMessagesNotInAllowedRange",
              "displayName": "Number of device to cloud messages (HTTP protocol) is not in allowed range",
              "description": "Get an alert when the number of device to cloud messages (HTTP protocol) in the time window is not in the allowed range",
              "isEnabled": false,
              "minThreshold": 0,
              "maxThreshold": 0,
              "timeWindowSize": "PT15M"
            },
            {
              "ruleType": "DirectMethodInvokesNotInAllowedRange",
              "displayName": "Number of direct method invokes is not in allowed range",
              "description": "Get an alert when the number of direct method invokes in the time window is not in the allowed range",
              "isEnabled": false,
              "minThreshold": 0,
              "maxThreshold": 0,
              "timeWindowSize": "PT15M"
            },
            {
              "ruleType": "FailedLocalLoginsNotInAllowedRange",
              "displayName": "Number of failed local logins is not in allowed range",
              "description": "Get an alert when the number of failed local logins on the device in the time window is not in the allowed range",
              "isEnabled": false,
              "minThreshold": 0,
              "maxThreshold": 0,
              "timeWindowSize": "PT15M"
            },
            {
              "ruleType": "FileUploadsNotInAllowedRange",
              "displayName": "Number of file uploads is not in allowed range",
              "description": "Get an alert when the number of file uploads from the device to the cloud in the time window is not in the allowed range",
              "isEnabled": false,
              "minThreshold": 0,
              "maxThreshold": 0,
              "timeWindowSize": "PT15M"
            },
            {
              "ruleType": "QueuePurgesNotInAllowedRange",
              "displayName": "Number of device queue purges is not in allowed range",
              "description": "Get an alert when the number of device queue purges in the time window is not in the allowed range",
              "isEnabled": false,
              "minThreshold": 0,
              "maxThreshold": 0,
              "timeWindowSize": "PT15M"
            },
            {
              "ruleType": "TwinUpdatesNotInAllowedRange",
              "displayName": "Number of twin updates is not in allowed range",
              "description": "Get an alert when the number of twin updates (by the device or the service) in the time window is not in the allowed range",
              "isEnabled": false,
              "minThreshold": 0,
              "maxThreshold": 0,
              "timeWindowSize": "PT15M"
            },
            {
              "ruleType": "UnauthorizedOperationsNotInAllowedRange",
              "displayName": "Number of unauthorized operations is not in allowed range",
              "description": "Get an alert when the number unauthorized operations in the time window is not in the allowed range. Unauthorized operations are operations that affect the device (or done by it) that fail because of an unauthorized error",
              "isEnabled": false,
              "minThreshold": 0,
              "maxThreshold": 0,
              "timeWindowSize": "PT15M"
            }
          ],
          "allowlistRules": [
            {
              "ruleType": "ConnectionToIpNotAllowed",
              "displayName": "Outbound connection to an ip that isn't allowed",
              "description": "Get an alert when an outbound connection is created between your device and an ip that isn't allowed",
              "isEnabled": false,
              "valueType": "IpCidr",
              "allowlistValues": []
            },
            {
              "ruleType": "LocalUserNotAllowed",
              "displayName": "Login by a local user that isn't allowed",
              "description": "Get an alert when a local user that isn't allowed logins to the device",
              "isEnabled": false,
              "valueType": "String",
              "allowlistValues": []
            },
            {
              "ruleType": "ProcessNotAllowed",
              "displayName": "Execution of a process that isn't allowed",
              "description": "Get an alert when a process that isn't allowed is executed",
              "isEnabled": false,
              "valueType": "String",
              "allowlistValues": []
            }
          ],
          "denylistRules": []
        }
      }
    }
  }
}
