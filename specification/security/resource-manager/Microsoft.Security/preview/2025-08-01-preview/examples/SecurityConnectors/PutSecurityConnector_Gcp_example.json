{
  "parameters": {
    "api-version": "2025-08-01-preview",
    "subscriptionId": "20ff7fc3-e762-44dd-bd96-b71116dcdc23",
    "resourceGroupName": "gcpResourceGroup",
    "securityConnectorName": "gcp-sdk-def-cspm-connector",
    "securityConnector": {
      "location": "Central US",
      "tags": {
        "environment": "production",
        "team": "security",
        "project": "defender-cspm"
      },
      "properties": {
        "hierarchyIdentifier": "1012345678901",
        "environmentName": "GCP",
        "environmentData": {
          "environmentType": "GcpProject",
          "projectDetails": {
            "projectId": "sample-gcp-project",
            "projectNumber": "1012345678901",
            "workloadIdentityPoolId": "mdc-pool-1012345678901"
          },
          "organizationalData": {
            "organizationMembershipType": "Member",
            "parentHierarchyId": "organizations/123456789",
            "managementProjectNumber": "987654321098"
          },
          "scanInterval": 4
        },
        "offerings": [
          {
            "offeringType": "DefenderCspmGcp",
            "ciemDiscovery": {
              "workloadIdentityProviderId": "projects/1012345678901/locations/global/workloadIdentityPools/mdc-pool-1012345678901/providers/mdc-provider-1012345678901",
              "serviceAccountEmailAddress": "mdc-ciem-gcp1012345678901@sample-gcp-project.iam.gserviceaccount.com",
              "azureActiveDirectoryAppName": "GCP-CIEM-sample-gcp-project",
              "enableAuditLogIngestion": true
            },
            "ciem": {
              "logCollectionOidc": {
                "workloadIdentityProviderId": "My log collection workload identity provider Id",
                "serviceAccountEmailAddress": "logcollection@projectName.com"
              },
              "ciemOidc": {
                "workloadIdentityProviderId": "My ciem workload identity provider Id",
                "serviceAccountEmailAddress": "ciem@projectName.com"
              },
              "gcpAuditLogIngestion": {
                "provisioningType": "AutoProvisioning",
                "resourceNamePrefix": "mdc-defender-cspm"
              }
            },
            "vmScanners": {
              "enabled": true,
              "configuration": {
                "scanningMode": "Default",
                "exclusionTags": {
                  "skip-scan": "true",
                  "environment": "development"
                }
              }
            },
            "dataSensitivityDiscovery": {
              "enabled": true,
              "workloadIdentityProviderId": "projects/1012345678901/locations/global/workloadIdentityPools/mdc-pool-1012345678901/providers/mdc-datasensitivity-provider",
              "serviceAccountEmailAddress": "mdc-datasensitivity-gcp1012345678901@sample-gcp-project.iam.gserviceaccount.com"
            },
            "mdcContainersImageAssessment": {
              "enabled": true,
              "workloadIdentityProviderId": "projects/1012345678901/locations/global/workloadIdentityPools/mdc-pool-1012345678901/providers/mdc-containers-provider",
              "serviceAccountEmailAddress": "mdc-containers-gcp1012345678901@sample-gcp-project.iam.gserviceaccount.com"
            },
            "mdcContainersAgentlessDiscoveryK8s": {
              "enabled": true,
              "workloadIdentityProviderId": "projects/1012345678901/locations/global/workloadIdentityPools/mdc-pool-1012345678901/providers/mdc-k8s-discovery-provider",
              "serviceAccountEmailAddress": "mdc-k8s-discovery-gcp1012345678901@sample-gcp-project.iam.gserviceaccount.com"
            }
          }
        ]
      }
    }
  },
  "responses": {
    "200": {
      "body": {
        "id": "/subscriptions/20ff7fc3-e762-44dd-bd96-b71116dcdc23/resourceGroups/gcpResourceGroup/providers/Microsoft.Security/securityConnectors/gcp-sdkdef-cspm-connector",
        "name": "gcp-sdkdef-cspm-connector",
        "type": "Microsoft.Security/securityConnectors",
        "location": "Central US",
        "tags": {
          "environment": "production",
          "team": "security",
          "project": "defender-cspm"
        },
        "systemData": {
          "createdBy": "user@contoso.com",
          "createdByType": "User",
          "createdAt": "2025-07-21T10:30:00.0000000Z",
          "lastModifiedBy": "user@contoso.com",
          "lastModifiedByType": "User",
          "lastModifiedAt": "2025-07-21T10:30:00.0000000Z"
        },
        "properties": {
          "hierarchyIdentifier": "1012345678901",
          "hierarchyIdentifierTrialEndDate": "2025-08-20T10:30:00.0000000Z",
          "environmentName": "GCP",
          "environmentData": {
            "environmentType": "GcpProject",
            "projectDetails": {
              "projectId": "sample-gcp-project",
              "projectNumber": "1012345678901",
              "workloadIdentityPoolId": "mdc-pool-1012345678901",
              "projectName": "Sample GCP Project for Defender CSPM"
            },
            "organizationalData": {
              "organizationMembershipType": "Member",
              "parentHierarchyId": "organizations/123456789",
              "managementProjectNumber": "987654321098"
            },
            "scanInterval": 4
          },
          "offerings": [
            {
              "offeringType": "DefenderCspmGcp",
              "description": "Defender CSPM for GCP provides comprehensive cloud security posture management including permissions management, data sensitivity discovery, and advanced threat protection",
              "ciemDiscovery": {
                "workloadIdentityProviderId": "projects/1012345678901/locations/global/workloadIdentityPools/mdc-pool-1012345678901/providers/mdc-provider-1012345678901",
                "serviceAccountEmailAddress": "mdc-ciem-gcp1012345678901@sample-gcp-project.iam.gserviceaccount.com",
                "azureActiveDirectoryAppName": "GCP-CIEM-sample-gcp-project",
                "enableAuditLogIngestion": true
              },
              "ciem": {
                "logCollectionOidc": {
                  "workloadIdentityProviderId": "My log collection workload identity provider Id",
                  "serviceAccountEmailAddress": "logcollection@projectName.com"
                },
                "ciemOidc": {
                  "workloadIdentityProviderId": "My ciem workload identity provider Id",
                  "serviceAccountEmailAddress": "ciem@projectName.com"
                },
                "gcpAuditLogIngestion": {
                  "provisioningType": "AutoProvisioning",
                  "resourceNamePrefix": "mdc-defender-cspm"
                }
              },
              "vmScanners": {
                "enabled": true,
                "configuration": {
                  "scanningMode": "Default",
                  "exclusionTags": {
                    "skip-scan": "true",
                    "environment": "development"
                  }
                }
              },
              "dataSensitivityDiscovery": {
                "enabled": true,
                "workloadIdentityProviderId": "projects/1012345678901/locations/global/workloadIdentityPools/mdc-pool-1012345678901/providers/mdc-datasensitivity-provider",
                "serviceAccountEmailAddress": "mdc-datasensitivity-gcp1012345678901@sample-gcp-project.iam.gserviceaccount.com"
              },
              "mdcContainersImageAssessment": {
                "enabled": true,
                "workloadIdentityProviderId": "projects/1012345678901/locations/global/workloadIdentityPools/mdc-pool-1012345678901/providers/mdc-containers-provider",
                "serviceAccountEmailAddress": "mdc-containers-gcp1012345678901@sample-gcp-project.iam.gserviceaccount.com"
              },
              "mdcContainersAgentlessDiscoveryK8s": {
                "enabled": true,
                "workloadIdentityProviderId": "projects/1012345678901/locations/global/workloadIdentityPools/mdc-pool-1012345678901/providers/mdc-k8s-discovery-provider",
                "serviceAccountEmailAddress": "mdc-k8s-discovery-gcp1012345678901@sample-gcp-project.iam.gserviceaccount.com"
              }
            }
          ]
        }
      }
    },
    "201": {
      "body": {
        "id": "/subscriptions/20ff7fc3-e762-44dd-bd96-b71116dcdc23/resourceGroups/gcpResourceGroup/providers/Microsoft.Security/securityConnectors/gcp-sdkdef-cspm-connector",
        "name": "gcp-sdkdef-cspm-connector",
        "type": "Microsoft.Security/securityConnectors",
        "location": "Central US",
        "tags": {
          "environment": "production",
          "team": "security",
          "project": "defender-cspm"
        },
        "systemData": {
          "createdBy": "user@contoso.com",
          "createdByType": "User",
          "createdAt": "2025-07-21T10:30:00.0000000Z",
          "lastModifiedBy": "user@contoso.com",
          "lastModifiedByType": "User",
          "lastModifiedAt": "2025-07-21T10:30:00.0000000Z"
        },
        "properties": {
          "hierarchyIdentifier": "1012345678901",
          "hierarchyIdentifierTrialEndDate": "2025-08-20T10:30:00.0000000Z",
          "environmentName": "GCP",
          "environmentData": {
            "environmentType": "GcpProject",
            "projectDetails": {
              "projectId": "sample-gcp-project",
              "projectNumber": "1012345678901",
              "workloadIdentityPoolId": "mdc-pool-1012345678901",
              "projectName": "Sample GCP Project for Defender CSPM"
            },
            "organizationalData": {
              "organizationMembershipType": "Member",
              "parentHierarchyId": "organizations/123456789",
              "managementProjectNumber": "987654321098"
            },
            "scanInterval": 4
          },
          "offerings": [
            {
              "offeringType": "DefenderCspmGcp",
              "description": "Defender CSPM for GCP provides comprehensive cloud security posture management including permissions management, data sensitivity discovery, and advanced threat protection",
              "ciemDiscovery": {
                "workloadIdentityProviderId": "projects/1012345678901/locations/global/workloadIdentityPools/mdc-pool-1012345678901/providers/mdc-provider-1012345678901",
                "serviceAccountEmailAddress": "mdc-ciem-gcp1012345678901@sample-gcp-project.iam.gserviceaccount.com",
                "azureActiveDirectoryAppName": "GCP-CIEM-sample-gcp-project",
                "enableAuditLogIngestion": true
              },
              "ciem": {
                "logCollectionOidc": {
                  "workloadIdentityProviderId": "My log collection workload identity provider Id",
                  "serviceAccountEmailAddress": "logcollection@projectName.com"
                },
                "ciemOidc": {
                  "workloadIdentityProviderId": "My ciem workload identity provider Id",
                  "serviceAccountEmailAddress": "ciem@projectName.com"
                },
                "gcpAuditLogIngestion": {
                  "provisioningType": "AutoProvisioning",
                  "resourceNamePrefix": "mdc-defender-cspm"
                }
              },
              "vmScanners": {
                "enabled": true,
                "configuration": {
                  "scanningMode": "Default",
                  "exclusionTags": {
                    "skip-scan": "true",
                    "environment": "development"
                  }
                }
              },
              "dataSensitivityDiscovery": {
                "enabled": true,
                "workloadIdentityProviderId": "projects/1012345678901/locations/global/workloadIdentityPools/mdc-pool-1012345678901/providers/mdc-datasensitivity-provider",
                "serviceAccountEmailAddress": "mdc-datasensitivity-gcp1012345678901@sample-gcp-project.iam.gserviceaccount.com"
              },
              "mdcContainersImageAssessment": {
                "enabled": true,
                "workloadIdentityProviderId": "projects/1012345678901/locations/global/workloadIdentityPools/mdc-pool-1012345678901/providers/mdc-containers-provider",
                "serviceAccountEmailAddress": "mdc-containers-gcp1012345678901@sample-gcp-project.iam.gserviceaccount.com"
              },
              "mdcContainersAgentlessDiscoveryK8s": {
                "enabled": true,
                "workloadIdentityProviderId": "projects/1012345678901/locations/global/workloadIdentityPools/mdc-pool-1012345678901/providers/mdc-k8s-discovery-provider",
                "serviceAccountEmailAddress": "mdc-k8s-discovery-gcp1012345678901@sample-gcp-project.iam.gserviceaccount.com"
              }
            }
          ]
        }
      }
    }
  }
}