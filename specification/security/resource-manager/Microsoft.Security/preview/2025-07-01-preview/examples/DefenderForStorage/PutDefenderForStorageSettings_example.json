{
  "parameters": {
    "resourceId": "subscriptions/20ff7fc3-e762-44dd-bd96-b71116dcdc23/resourceGroups/myRg/providers/Microsoft.Storage/storageAccounts/myStorageAccount",
    "settingName": "current",
    "api-version": "2025-07-01-preview",
    "defenderForStorageSetting": {
      "properties": {
        "isEnabled": true,
        "malwareScanning": {
          "onUpload": {
            "isEnabled": true,
            "capGBPerMonth": 10000,
            "filters": {
              "excludeBlobsWithPrefix": [
                "unscanned-container",
                "sample-container/logs"
              ],
              "excludeBlobsWithSuffix": [
                ".log",
                ".jpg"
              ],
              "excludeBlobsLargerThan": 1024
            }
          },
          "scanResultsEventGridTopicResourceId": "/subscriptions/20ff7fc3-e762-44dd-bd96-b71116dcdc23/resourceGroups/myRg/providers/Microsoft.EventGrid/topics/myTopic",
          "blobScanResultsOptions": "BlobIndexTags",
          "automatedResponse": "BlobSoftDelete"
        },
        "sensitiveDataDiscovery": {
          "isEnabled": true
        },
        "overrideSubscriptionLevelSettings": true
      }
    }
  },
  "responses": {
    "200": {
      "body": {
        "id": "/subscriptions/20ff7fc3-e762-44dd-bd96-b71116dcdc23/resourceGroups/myRg/providers/Microsoft.Storage/storageAccounts/myStorageAccount/providers/Microsoft.Security/defenderForStorageSettings/current",
        "name": "current",
        "type": "Microsoft.Security/defenderForStorageSettings",
        "properties": {
          "isEnabled": true,
          "malwareScanning": {
            "onUpload": {
              "isEnabled": true,
              "capGBPerMonth": 10000,
              "filters": {
                "excludeBlobsWithPrefix": [
                  "sample-container/logs",
                  "single-excluded-container/",
                  "excluded-containers"
                ],
                "excludeBlobsWithSuffix": [
                  ".log",
                  ".jpg"
                ],
                "excludeBlobsLargerThan": 1024
              }
            },
            "scanResultsEventGridTopicResourceId": "/subscriptions/20ff7fc3-e762-44dd-bd96-b71116dcdc23/resourceGroups/myRg/providers/Microsoft.EventGrid/topics/myTopic",
            "blobScanResultsOptions": "BlobIndexTags",
            "automatedResponse": "BlobSoftDelete",
            "operationStatus": {
              "code": "Success",
              "message": "Malware Scanning has been enabled successfully"
            }
          },
          "sensitiveDataDiscovery": {
            "isEnabled": true,
            "operationStatus": {
              "code": "Success",
              "message": "Sensitive Data Discovery has been enabled successfully"
            }
          },
          "overrideSubscriptionLevelSettings": true
        }
      }
    },
    "201": {
      "body": {
        "id": "/subscriptions/20ff7fc3-e762-44dd-bd96-b71116dcdc23/resourceGroups/myRg/providers/Microsoft.Storage/storageAccounts/myStorageAccount/providers/Microsoft.Security/defenderForStorageSettings/current",
        "name": "current",
        "type": "Microsoft.Security/defenderForStorageSettings",
        "properties": {
          "isEnabled": true,
          "malwareScanning": {
            "onUpload": {
              "isEnabled": false,
              "capGBPerMonth": -1
            },
            "scanResultsEventGridTopicResourceId": "/subscriptions/20ff7fc3-e762-44dd-bd96-b71116dcdc23/resourceGroups/myRg/providers/Microsoft.EventGrid/topics/myTopic",
            "blobScanResultsOptions": "BlobIndexTags",
            "automatedResponse": "None",
            "operationStatus": {
              "code": "PartialSuccess",
              "message": "Failed to setup data scanner."
            }
          },
          "sensitiveDataDiscovery": {
            "isEnabled": false,
            "operationStatus": {
              "code": "PartialSuccess",
              "message": "Failed to setup data scanner."
            }
          },
          "overrideSubscriptionLevelSettings": true
        }
      }
    }
  }
}
