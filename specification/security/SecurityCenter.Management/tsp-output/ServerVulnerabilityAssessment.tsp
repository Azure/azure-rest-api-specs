import "@azure-tools/typespec-azure-core";
import "@azure-tools/typespec-azure-resource-manager";
import "@typespec/rest";
import "./models.tsp";

using TypeSpec.Rest;
using Azure.ResourceManager;
using Azure.ResourceManager.Foundations;
using TypeSpec.Http;

namespace Azure.ResourceManager.SecurityCenter;
@doc("Describes the server vulnerability assessment details on a resource")
model ServerVulnerabilityAssessment
  is ProxyResource<ServerVulnerabilityAssessmentProperties> {
  @doc("ServerVulnerabilityAssessment status. only a 'default' value is supported.")
  @key("serverVulnerabilityAssessment")
  @segment("serverVulnerabilityAssessments")
  name: "default";
}

@armResourceOperations
interface ServerVulnerabilityAssessment {
  @doc("Gets a server vulnerability assessment onboarding statuses on a given resource.")
  get is ArmResourceRead<
    ServerVulnerabilityAssessment,
    {
      ...BaseParameters<ServerVulnerabilityAssessment>;

      @doc("ServerVulnerabilityAssessment status. only a 'default' value is supported.")
      @path
      serverVulnerabilityAssessment: "default";
    }
  >;
  @doc("Creating a server vulnerability assessment on a resource, which will onboard a resource for having a vulnerability assessment on it")
  createOrUpdate is ArmResourceCreateOrReplaceSync<
    ServerVulnerabilityAssessment,
    {
      ...BaseParameters<ServerVulnerabilityAssessment>;

      @doc("ServerVulnerabilityAssessment status. only a 'default' value is supported.")
      @path
      serverVulnerabilityAssessment: "default";
    }
  >;
  @doc("Removing server vulnerability assessment from a resource.")
  delete is ArmResourceDeleteAsync<
    ServerVulnerabilityAssessment,
    {
      ...BaseParameters<ServerVulnerabilityAssessment>;

      @doc("ServerVulnerabilityAssessment status. only a 'default' value is supported.")
      @path
      serverVulnerabilityAssessment: "default";
    }
  >;
  @doc("Gets a list of server vulnerability assessment onboarding statuses on a given resource.")
  listByExtendedResource is ArmResourceListByParent<ServerVulnerabilityAssessment>;
}
