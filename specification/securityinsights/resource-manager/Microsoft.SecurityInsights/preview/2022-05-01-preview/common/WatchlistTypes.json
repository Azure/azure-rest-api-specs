{
  "swagger": "2.0",
  "info": {
    "version": "2022-05-01-preview",
    "title": "Common Watchlist types"
  },
  "paths": {},
  "definitions": {
    "WatchlistList": {
      "description": "List all the watchlists.",
      "type": "object",
      "properties": {
        "nextLink": {
          "description": "URL to fetch the next set of watchlists.",
          "readOnly": true,
          "type": "string"
        },
        "value": {
          "description": "Array of watchlist.",
          "items": {
            "$ref": "#/definitions/Watchlist"
          },
          "type": "array"
        }
      },
      "required": [
        "value"
      ]
    },
    "Watchlist": {
      "allOf": [
        {
          "$ref": "../../../../common/2.0/types.json#/definitions/ResourceWithEtag"
        }
      ],
      "description": "Represents a (Confidential) Watchlist in Azure Security Insights.",
      "properties": {
        "properties": {
          "$ref": "#/definitions/WatchlistProperties",
          "description": "Watchlist properties",
          "x-ms-client-flatten": true
        }
      },
      "type": "object"
    },
    "WatchlistProperties": {
      "description": "Describes watchlist properties",
      "properties": {
        "watchlistId": {
          "description": "The id (a Guid) of the watchlist",
          "type": "string"
        },
        "displayName": {
          "description": "The display name of the watchlist",
          "type": "string"
        },
        "provider": {
          "description": "The provider of the watchlist",
          "type": "string"
        },
        "source": {
          "description": "The filename of the watchlist, called 'source'",
          "type": "string"
        },
        "sourceType": {
          "description": "The sourceType of the watchlist",
          "enum": [
            "Local",
            "AzureStorage"
          ],
          "type": "string",
          "x-ms-enum": {
            "modelAsString": true,
            "name": "sourceType"
          }
        },
        "created": {
          "description": "The time the watchlist was created",
          "format": "date-time",
          "type": "string"
        },
        "updated": {
          "description": "The last time the watchlist was updated",
          "format": "date-time",
          "type": "string"
        },
        "createdBy": {
          "$ref": "../../../../common/2.0/types.json#/definitions/UserInfo",
          "description": "Describes a user that created the watchlist",
          "type": "object"
        },
        "updatedBy": {
          "$ref": "../../../../common/2.0/types.json#/definitions/UserInfo",
          "description": "Describes a user that updated the watchlist",
          "type": "object"
        },
        "description": {
          "description": "A description of the watchlist",
          "type": "string"
        },
        "watchlistType": {
          "description": "The type of the watchlist",
          "type": "string"
        },
        "watchlistAlias": {
          "description": "The alias of the watchlist",
          "type": "string"
        },
        "isDeleted": {
          "description": "A flag that indicates if the watchlist is deleted or not",
          "type": "boolean"
        },
        "labels": {
          "description": "List of labels relevant to this watchlist",
          "items": {
            "$ref": "../../../../common/2.0/types.json#/definitions/Label"
          },
          "type": "array"
        },
        "defaultDuration": {
          "description": "The default duration of a watchlist (in ISO 8601 duration format)",
          "format": "duration",
          "type": "string"
        },
        "tenantId": {
          "description": "The tenantId where the watchlist belongs to",
          "type": "string"
        },
        "numberOfLinesToSkip": {
          "description": "The number of lines in a csv/tsv content to skip before the header",
          "type": "integer",
          "format": "int32"
        },
        "rawContent": {
          "description": "The raw content that represents to watchlist items to create. In case of csv/tsv content type, it's the content of the file that will parsed by the endpoint",
          "type": "string"
        },
        "itemsSearchKey": {
          "description": "The search key is used to optimize query performance when using watchlists for joins with other data. For example, enable a column with IP addresses to be the designated SearchKey field, then use this field as the key field when joining to other event data by IP address.",
          "type": "string"
        },
        "contentType": {
          "description": "The content type of the raw content. Example : text/csv or text/tsv ",
          "type": "string"
        },
        "uploadStatus": {
          "description": "The status of the Watchlist upload : New, InProgress or Complete. Pls note : When a Watchlist upload status is equal to InProgress, the Watchlist cannot be deleted",
          "type": "string"
        },
        "watchlistCategory": {
          "description": "The watchlist category (normal or confidential). It's read only property, calculated by the API during PUT operation",
          "readOnly": true,
          "type": "string"
        }
      },
      "required": [
        "displayName",
        "provider",
        "itemsSearchKey"
      ],
      "type": "object"
    },
    "WatchlistItemList": {
      "description": "List all the watchlist items.",
      "properties": {
        "nextLink": {
          "description": "URL to fetch the next set of watchlist item.",
          "readOnly": true,
          "type": "string"
        },
        "value": {
          "description": "Array of watchlist items.",
          "items": {
            "$ref": "#/definitions/WatchlistItem"
          },
          "type": "array"
        }
      },
      "type": "object",
      "required": [
        "value"
      ]
    },
    "WatchlistItem": {
      "allOf": [
        {
          "$ref": "../../../../common/2.0/types.json#/definitions/ResourceWithEtag"
        }
      ],
      "description": "Represents a Watchlist item in Azure Security Insights.",
      "properties": {
        "properties": {
          "$ref": "#/definitions/WatchlistItemProperties",
          "description": "Watchlist Item properties",
          "x-ms-client-flatten": true
        }
      },
      "type": "object"
    },
    "WatchlistItemProperties": {
      "description": "Describes watchlist item properties",
      "properties": {
        "watchlistItemType": {
          "description": "The type of the watchlist item",
          "type": "string"
        },
        "watchlistItemId": {
          "description": "The id (a Guid) of the watchlist item",
          "type": "string"
        },
        "tenantId": {
          "description": "The tenantId to which the watchlist item belongs to",
          "type": "string"
        },
        "isDeleted": {
          "description": "A flag that indicates if the watchlist item is deleted or not",
          "type": "boolean"
        },
        "created": {
          "description": "The time the watchlist item was created",
          "format": "date-time",
          "type": "string"
        },
        "updated": {
          "description": "The last time the watchlist item was updated",
          "format": "date-time",
          "type": "string"
        },
        "createdBy": {
          "$ref": "../../../../common/2.0/types.json#/definitions/UserInfo",
          "description": "Describes a user that created the watchlist item",
          "type": "object"
        },
        "updatedBy": {
          "$ref": "../../../../common/2.0/types.json#/definitions/UserInfo",
          "description": "Describes a user that updated the watchlist item"
        },
        "itemsKeyValue": {
          "description": "key-value pairs for a watchlist item",
          "type": "object",
          "additionalProperties": {}
        },
        "entityMapping": {
          "description": "key-value pairs for a watchlist item entity mapping",
          "type": "object",
          "additionalProperties": {}
        }
      },
      "required": [
        "itemsKeyValue"
      ],
      "type": "object"
    }
  },
  "parameters": {
    "WatchlistAlias": {
      "description": "Watchlist Alias",
      "in": "path",
      "name": "watchlistAlias",
      "required": true,
      "type": "string",
      "x-ms-parameter-location": "method"
    },
    "Watchlist": {
      "description": "The watchlist",
      "in": "body",
      "name": "watchlist",
      "required": true,
      "schema": {
        "$ref": "#/definitions/Watchlist"
      },
      "x-ms-parameter-location": "method"
    },
    "WatchlistItem": {
      "description": "The watchlist item",
      "in": "body",
      "name": "watchlistItem",
      "required": true,
      "schema": {
        "$ref": "#/definitions/WatchlistItem"
      },
      "x-ms-parameter-location": "method"
    },
    "WatchlistItemId": {
      "description": "Watchlist Item Id (GUID)",
      "in": "path",
      "name": "watchlistItemId",
      "required": true,
      "type": "string",
      "x-ms-parameter-location": "method"
    }
  }
}
