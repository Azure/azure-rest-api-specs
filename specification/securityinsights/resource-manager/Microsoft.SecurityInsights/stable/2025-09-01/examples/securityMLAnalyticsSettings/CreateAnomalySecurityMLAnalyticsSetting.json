{
  "parameters": {
    "api-version": "2025-09-01",
    "resourceGroupName": "myRg",
    "securityMLAnalyticsSetting": {
      "etag": "\"260090e2-0000-0d00-0000-5d6fb8670000\"",
      "kind": "Anomaly",
      "properties": {
        "description": "When account logs from a source region that has rarely been logged in from during the last 14 days, an anomaly is triggered.",
        "anomalySettingsVersion": 0,
        "anomalyVersion": "1.0.5",
        "customizableObservations": {
          "multiSelectObservations": null,
          "prioritizeExcludeObservations": null,
          "singleSelectObservations": [
            {
              "name": "Device vendor",
              "description": "Select device vendor of network connection logs from CommonSecurityLog",
              "rerun": "RerunAlways",
              "sequenceNumber": 1,
              "supportedValues": [
                "Palo Alto Networks",
                "Fortinet",
                "Check Point"
              ],
              "supportedValuesKql": null,
              "value": [
                "Palo Alto Networks"
              ],
              "valuesKql": null
            }
          ],
          "singleValueObservations": null,
          "thresholdObservations": [
            {
              "name": "Daily data transfer threshold in MB",
              "description": "Suppress anomalies when daily data transfered (in MB) per hour is less than the chosen value",
              "maximum": "100",
              "minimum": "1",
              "rerun": "RerunAlways",
              "sequenceNumber": 1,
              "value": "25"
            },
            {
              "name": "Number of standard deviations",
              "description": "Triggers anomalies when number of standard deviations is greater than the chosen value",
              "maximum": "10",
              "minimum": "2",
              "rerun": "RerunAlways",
              "sequenceNumber": 2,
              "value": "3"
            }
          ]
        },
        "displayName": "Login from unusual region",
        "enabled": true,
        "frequency": "PT1H",
        "isDefaultSettings": true,
        "requiredDataConnectors": [
          {
            "connectorId": "AWS",
            "dataTypes": [
              "AWSCloudTrail"
            ]
          }
        ],
        "settingsDefinitionId": "f209187f-1d17-4431-94af-c141bf5f23db",
        "settingsStatus": "Production",
        "tactics": [
          "Exfiltration",
          "CommandAndControl"
        ],
        "techniques": [
          "T1037",
          "T1021"
        ]
      }
    },
    "settingsResourceName": "f209187f-1d17-4431-94af-c141bf5f23db",
    "subscriptionId": "d0cfe6b2-9ac0-4464-9919-dccaee2e48c0",
    "workspaceName": "myWorkspace"
  },
  "responses": {
    "200": {
      "body": {
        "name": "f209187f-1d17-4431-94af-c141bf5f23db",
        "type": "Microsoft.SecurityInsights/securityMLAnalyticsSettings",
        "etag": "\"01005144-0000-0d00-0000-6058632c0000\"",
        "id": "/subscriptions/d0cfe6b2-9ac0-4464-9919-dccaee2e48c0/resourceGroups/myRg/providers/Microsoft.OperationalIinsights/workspaces/myWorkspace/providers/Microsoft.SecurityInsights/securityMLAnalyticsSettings/f209187f-1d17-4431-94af-c141bf5f23db",
        "kind": "Anomaly",
        "properties": {
          "description": "When account logs from a source region that has rarely been logged in from during the last 14 days, an anomaly is triggered.",
          "anomalySettingsVersion": 0,
          "anomalyVersion": "1.0.5",
          "customizableObservations": {
            "multiSelectObservations": null,
            "prioritizeExcludeObservations": null,
            "singleSelectObservations": [
              {
                "name": "Device vendor",
                "description": "Select device vendor of network connection logs from CommonSecurityLog",
                "rerun": "RerunAlways",
                "sequenceNumber": 1,
                "supportedValues": [
                  "Palo Alto Networks",
                  "Fortinet",
                  "Check Point"
                ],
                "supportedValuesKql": null,
                "value": [
                  "Palo Alto Networks"
                ],
                "valuesKql": null
              }
            ],
            "singleValueObservations": null,
            "thresholdObservations": [
              {
                "name": "Daily data transfer threshold in MB",
                "description": "Suppress anomalies when daily data transfered (in MB) per hour is less than the chosen value",
                "maximum": "100",
                "minimum": "1",
                "rerun": "RerunAlways",
                "sequenceNumber": 1,
                "value": "25"
              },
              {
                "name": "Number of standard deviations",
                "description": "Triggers anomalies when number of standard deviations is greater than the chosen value",
                "maximum": "10",
                "minimum": "2",
                "rerun": "RerunAlways",
                "sequenceNumber": 2,
                "value": "3"
              }
            ]
          },
          "displayName": "Login from unusual region",
          "enabled": true,
          "frequency": "PT1H",
          "isDefaultSettings": true,
          "lastModifiedUtc": "2021-10-20T13:17:11.5340061Z",
          "requiredDataConnectors": [
            {
              "connectorId": "AWS",
              "dataTypes": [
                "AWSCloudTrail"
              ]
            }
          ],
          "settingsDefinitionId": "f209187f-1d17-4431-94af-c141bf5f23db",
          "settingsStatus": "Production",
          "tactics": [
            "Exfiltration",
            "CommandAndControl"
          ],
          "techniques": [
            "T1037",
            "T1021"
          ]
        }
      }
    },
    "201": {
      "body": {
        "name": "f209187f-1d17-4431-94af-c141bf5f23db",
        "type": "Microsoft.SecurityInsights/securityMLAnalyticsSettings",
        "etag": "\"01007444-0000-0d00-0000-605863a70000\"",
        "id": "/subscriptions/d0cfe6b2-9ac0-4464-9919-dccaee2e48c0/resourceGroups/myRg/providers/Microsoft.OperationalIinsights/workspaces/myWorkspace/providers/Microsoft.SecurityInsights/securityMLAnalyticsSettings/f209187f-1d17-4431-94af-c141bf5f23db",
        "kind": "Anomaly",
        "properties": {
          "description": "When account logs from a source region that has rarely been logged in from during the last 14 days, an anomaly is triggered.",
          "anomalySettingsVersion": 0,
          "anomalyVersion": "1.0.5",
          "customizableObservations": {
            "multiSelectObservations": null,
            "prioritizeExcludeObservations": null,
            "singleSelectObservations": [
              {
                "name": "Device vendor",
                "description": "Select device vendor of network connection logs from CommonSecurityLog",
                "rerun": "RerunAlways",
                "sequenceNumber": 1,
                "supportedValues": [
                  "Palo Alto Networks",
                  "Fortinet",
                  "Check Point"
                ],
                "supportedValuesKql": null,
                "value": [
                  "Palo Alto Networks"
                ],
                "valuesKql": null
              }
            ],
            "singleValueObservations": null,
            "thresholdObservations": [
              {
                "name": "Daily data transfer threshold in MB",
                "description": "Suppress anomalies when daily data transfered (in MB) per hour is less than the chosen value",
                "maximum": "100",
                "minimum": "1",
                "rerun": "RerunAlways",
                "sequenceNumber": 1,
                "value": "25"
              },
              {
                "name": "Number of standard deviations",
                "description": "Triggers anomalies when number of standard deviations is greater than the chosen value",
                "maximum": "10",
                "minimum": "2",
                "rerun": "RerunAlways",
                "sequenceNumber": 2,
                "value": "3"
              }
            ]
          },
          "displayName": "Login from unusual region",
          "enabled": true,
          "frequency": "PT1H",
          "isDefaultSettings": true,
          "lastModifiedUtc": "2021-10-20T13:17:11.5340061Z",
          "requiredDataConnectors": [
            {
              "connectorId": "AWS",
              "dataTypes": [
                "AWSCloudTrail"
              ]
            }
          ],
          "settingsDefinitionId": "f209187f-1d17-4431-94af-c141bf5f23db",
          "settingsStatus": "Production",
          "tactics": [
            "Exfiltration",
            "CommandAndControl"
          ],
          "techniques": [
            "T1037",
            "T1021"
          ]
        }
      }
    }
  },
  "operationId": "SecurityMLAnalyticsSettings_CreateOrUpdate",
  "title": "Creates or updates a Anomaly Security ML Analytics Settings."
}
