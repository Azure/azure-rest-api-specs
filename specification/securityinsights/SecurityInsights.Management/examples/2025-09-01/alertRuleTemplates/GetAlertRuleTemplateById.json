{
  "parameters": {
    "alertRuleTemplateId": "65360bb0-8986-4ade-a89d-af3cf44d28aa",
    "api-version": "2025-09-01",
    "operationalInsightsResourceProvider": "Microsoft.OperationalInsights",
    "resourceGroupName": "myRg",
    "subscriptionId": "d0cfe6b2-9ac0-4464-9919-dccaee2e48c0",
    "workspaceName": "myWorkspace"
  },
  "responses": {
    "200": {
      "body": {
        "name": "65360bb0-8986-4ade-a89d-af3cf44d28aa",
        "type": "Microsoft.SecurityInsights/AlertRuleTemplates",
        "id": "/subscriptions/d0cfe6b2-9ac0-4464-9919-dccaee2e48c0/resourceGroups/myRg/providers/Microsoft.OperationalInsights/workspaces/myWorkspace/providers/Microsoft.SecurityInsights/alertRuleTemplates/65360bb0-8986-4ade-a89d-af3cf44d28aa",
        "kind": "Scheduled",
        "properties": {
          "description": "This alert monitors changes to Amazon VPC (Virtual Private Cloud) settings such as new ACL entries and routes in route tables.\nMore information: https://medium.com/@GorillaStack/the-most-important-aws-cloudtrail-security-events-to-track-a5b9873f8255 \nand https://aws.amazon.com/vpc/",
          "alertDetailsOverride": {
            "alertDescriptionFormat": "Suspicious activity was made by {{AccountCustomEntity}}",
            "alertDisplayNameFormat": "Alert on event {{EventName}}",
            "alertSeverityColumnName": null,
            "alertTacticsColumnName": null
          },
          "alertRulesCreatedByTemplateCount": 0,
          "createdDateUTC": "2019-02-27T00:00:00Z",
          "customDetails": {
            "EventNames": "EventName",
            "EventTypes": "EventTypeName"
          },
          "displayName": "Changes to Amazon VPC settings",
          "entityMappings": [
            {
              "entityType": "Account",
              "fieldMappings": [
                {
                  "columnName": "AccountCustomEntity",
                  "identifier": "FullName"
                }
              ]
            },
            {
              "entityType": "IP",
              "fieldMappings": [
                {
                  "columnName": "IPCustomEntity",
                  "identifier": "Address"
                }
              ]
            }
          ],
          "eventGroupingSettings": {
            "aggregationKind": "AlertPerResult"
          },
          "lastUpdatedDateUTC": "2021-02-27T10:00:00Z",
          "query": "let timeframe = 1d;\nAWSCloudTrail\n| where TimeGenerated >= ago(timeframe)\n| where EventName == \"CreateNetworkAclEntry\"\n    or EventName == \"CreateRoute\"\n| project TimeGenerated, EventName, EventTypeName, UserIdentityAccountId, UserIdentityPrincipalid, UserAgent, UserIdentityUserName, SessionMfaAuthenticated, SourceIpAddress, AWSRegion, EventSource, AdditionalEventData, ResponseElements\n| extend AccountCustomEntity = UserIdentityUserName, IPCustomEntity = SourceIpAddress",
          "queryFrequency": "P1D",
          "queryPeriod": "P1D",
          "requiredDataConnectors": [
            {
              "connectorId": "AWS",
              "dataTypes": [
                "AWSCloudTrail"
              ]
            }
          ],
          "severity": "Low",
          "status": "Available",
          "tactics": [
            "PrivilegeEscalation",
            "LateralMovement"
          ],
          "triggerOperator": "GreaterThan",
          "triggerThreshold": 0,
          "version": "1.0.2"
        }
      }
    }
  },
  "operationId": "AlertRuleTemplates_Get",
  "title": "Get alert rule template by Id."
}
