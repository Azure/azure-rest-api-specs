{
  "swagger": "2.0",
  "info": {
    "title": "Experimentation",
    "description": "Rest API for Experimentation Service.",
    "version": "2023-09-30-preview"
  },
  "host": "management.azure.com",
  "schemes": [
    "https"
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "security": [
    {
      "azure_auth": [
        "user_impersonation"
      ]
    }
  ],
  "securityDefinitions": {
    "azure_auth": {
      "type": "oauth2",
      "authorizationUrl": "https://login.microsoftonline.com/common/oauth2/authorize",
      "flow": "implicit",
      "description": "Azure Active Directory OAuth2 Flow",
      "scopes": {
        "user_impersonation": "impersonate your user account"
      }
    }
  },
  "paths": {
    "/providers/Microsoft.Experimentation/operations": {
      "get": {
        "tags": [
          "Operations"
        ],
        "summary": "Lists all of the available Experimentation resource provider API operations.",
        "description": "Get the list of available Experimentation resource provider API operations.",
        "operationId": "Operations_List",
        "parameters": [
          {
            "$ref": "../../../../../common-types/resource-management/v5/types.json#/parameters/ApiVersionParameter"
          }
        ],
        "responses": {
          "200": {
            "description": "OK. The request has succeeded.",
            "schema": {
              "$ref": "../../../../../common-types/resource-management/v5/types.json#/definitions/OperationListResult"
            }
          },
          "default": {
            "description": "Error response describing why the operation failed.",
            "schema": {
              "$ref": "../../../../../common-types/resource-management/v5/types.json../../../../../common-types/resource-management/v5/types.json#/definitions/ErrorResponse"
            }
          }
        },
        "x-ms-pageable": {
          "nextLinkName": "nextLink"
        },
        "x-ms-examples": {
          "ListOperations": {
            "$ref": "./examples/ExperimentWorkspaces_OperationsList.json"
          }
        }
      }
    },
    "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Experimentation/experimentWorkspaces/{experimentWorkspaceName}": {
      "put": {
        "tags": [
          "ExperimentWorkspace"
        ],
        "operationId": "experimentWorkspaces_CreateOrUpdate",
        "x-ms-long-running-operation": true,
        "x-ms-long-running-operation-options": {
          "final-state-via": "azure-async-operation"
        },
        "x-ms-examples": {
          "GetWorkspaces": {
            "$ref": "./examples/ExperimentWorkspaces_CreateOrUpdate.json"
          }
        },
        "description": "Create an experiment workspace, or update an existing workspace",
        "parameters": [
          {
            "$ref": "../../../../../common-types/resource-management/v5/types.json#/parameters/SubscriptionIdParameter"
          },
          {
            "$ref": "#/parameters/experimentWorkspaceParameter"
          },
          {
            "$ref": "../../../../../common-types/resource-management/v5/types.json#/parameters/ApiVersionParameter"
          },
          {
            "$ref": "../../../../../common-types/resource-management/v5/types.json#/parameters/ResourceGroupNameParameter"
          },
          {
            "name": "parameters",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/ExperimentWorkspaceCreate"
            },
            "description": "Parameters supplied to the CreateOrUpdate experiment workspace operation."
          }
        ],
        "responses": {
          "201": {
            "description": "The request to create the experiment workspace is accepted and is running asynchronously",
            "schema": {
              "$ref": "#/definitions/ExperimentWorkspace"
            }
          },
          "200": {
            "description": "The request to update the experiment workspace is accepted and is running asynchronously",
            "schema": {
              "$ref": "#/definitions/ExperimentWorkspace"
            }
          },
          "default": {
            "description": "Error response describing why the operation failed.",
            "schema": {
              "$ref": "../../../../../common-types/resource-management/v5/types.json#/definitions/ErrorResponse"
            }
          }
        }
      },
      "patch": {
        "tags": [
          "ExperimentWorkspace"
        ],
        "operationId": "experimentWorkspaces_Patch",
        "x-ms-examples": {
          "GetWorkspaces": {
            "$ref": "./examples/ExperimentWorkspaces_Patch.json"
          }
        },
        "description": "Patch an experiment workspace",
        "parameters": [
          {
            "$ref": "../../../../../common-types/resource-management/v5/types.json#/parameters/SubscriptionIdParameter"
          },
          {
            "$ref": "#/parameters/experimentWorkspaceParameter"
          },
          {
            "$ref": "../../../../../common-types/resource-management/v5/types.json#/parameters/ApiVersionParameter"
          },
          {
            "$ref": "../../../../../common-types/resource-management/v5/types.json#/parameters/ResourceGroupNameParameter"
          },
          {
            "name": "parameters",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/ExperimentWorkspacePatch"
            },
            "description": "Parameters supplied to the Patch experiment workspace operation."
          }
        ],
        "responses": {
          "202": {
            "description": "The request to patch the experiment workspace is accepted and is running asynchronously. Check Azure-AsyncOperation headers to poll detailed status.",
            "schema": {
              "$ref": "#/definitions/ExperimentWorkspace"
            },
            "headers": {
              "Azure-AsyncOperation": {
                "description": "Azure Async Operation",
                "type": "string"
              },
              "Location": {
                "description": "Location Url to monitor progress.",
                "type": "string"
              }
            }
          },
          "200": {
            "description": "The experiment workspace is patched",
            "schema": {
              "$ref": "#/definitions/ExperimentWorkspace"
            }
          },
          "default": {
            "description": "Error response describing why the operation failed.",
            "schema": {
              "$ref": "../../../../../common-types/resource-management/v5/types.json#/definitions/ErrorResponse"
            }
          }
        },
        "x-ms-long-running-operation": true,
        "x-ms-long-running-operation-options": {
          "final-state-via": "azure-async-operation"
        }
      },
      "delete": {
        "tags": [
          "ExperimentWorkspace"
        ],
        "operationId": "experimentWorkspaces_Delete",
        "x-ms-examples": {
          "GetWorkspaces": {
            "$ref": "./examples/ExperimentWorkspaces_Delete.json"
          }
        },
        "description": "Deletes an experiment workspace",
        "parameters": [
          {
            "$ref": "../../../../../common-types/resource-management/v5/types.json#/parameters/SubscriptionIdParameter"
          },
          {
            "$ref": "#/parameters/experimentWorkspaceParameter"
          },
          {
            "$ref": "../../../../../common-types/resource-management/v5/types.json#/parameters/ApiVersionParameter"
          },
          {
            "$ref": "../../../../../common-types/resource-management/v5/types.json#/parameters/ResourceGroupNameParameter"
          }
        ],
        "responses": {
          "200": {
            "description": "The request to delete the experiment workspace is accepted and is running asynchronously"
          },
          "202": {
            "description": "The request to delete the experiment workspace is accepted and is running asynchronously"
          },
          "204": {
            "description": "The experiment Workspace doesn't exist"
          },
          "default": {
            "description": "Error response describing why the operation failed.",
            "schema": {
              "$ref": "../../../../../common-types/resource-management/v5/types.json#/definitions/ErrorResponse"
            }
          }
        }
      },
      "get": {
        "tags": [
          "ExperimentWorkspace"
        ],
        "operationId": "experimentWorkspaces_Get",
        "x-ms-examples": {
          "GetWorkspaces": {
            "$ref": "./examples/ExperimentWorkspaceGet.json"
          }
        },
        "description": "Gets an experiment workspace",
        "parameters": [
          {
            "$ref": "../../../../../common-types/resource-management/v5/types.json#/parameters/SubscriptionIdParameter"
          },
          {
            "$ref": "#/parameters/experimentWorkspaceParameter"
          },
          {
            "$ref": "../../../../../common-types/resource-management/v5/types.json#/parameters/ApiVersionParameter"
          },
          {
            "$ref": "../../../../../common-types/resource-management/v5/types.json#/parameters/ResourceGroupNameParameter"
          }
        ],
        "responses": {
          "200": {
            "description": "Get the experiment workspace for the specified name",
            "schema": {
              "$ref": "#/definitions/ExperimentWorkspace"
            }
          },
          "default": {
            "description": "Error response describing why the operation failed.",
            "schema": {
              "$ref": "../../../../../common-types/resource-management/v5/types.json#/definitions/ErrorResponse"
            }
          }
        }
      }
    },
    "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Experimentation/experimentWorkspaces": {
      "get": {
        "tags": [
          "ExperimentWorkspace"
        ],
        "operationId": "experimentWorkspaces_ListByResourceGroup",
        "x-ms-examples": {
          "GetWorkspaces": {
            "$ref": "./examples/ExperimentWorkspaces_ListByResourceGroup.json"
          }
        },
        "description": "Gets all experiment workspaces in a resource group.",
        "parameters": [
          {
            "$ref": "../../../../../common-types/resource-management/v5/types.json#/parameters/SubscriptionIdParameter"
          },
          {
            "$ref": "../../../../../common-types/resource-management/v5/types.json#/parameters/ApiVersionParameter"
          },
          {
            "$ref": "../../../../../common-types/resource-management/v5/types.json#/parameters/ResourceGroupNameParameter"
          }
        ],
        "responses": {
          "200": {
            "description": "Get all the experiment workspaces in the specified resource group",
            "schema": {
              "$ref": "#/definitions/ExperimentWorkspaceListResult"
            }
          },
          "default": {
            "description": "Error response describing why the operation failed.",
            "schema": {
              "$ref": "../../../../../common-types/resource-management/v5/types.json#/definitions/ErrorResponse"
            }
          }
        },
        "x-ms-pageable": {
          "nextLinkName": "nextLink"
        }
      }
    },
    "/subscriptions/{subscriptionId}/providers/Microsoft.Experimentation/experimentWorkspaces": {
      "get": {
        "tags": [
          "ExperimentWorkspace"
        ],
        "operationId": "experimentWorkspaces_List",
        "x-ms-examples": {
          "GetWorkspaces": {
            "$ref": "./examples/ExperimentWorkspaces_List.json"
          }
        },
        "description": "Gets all experiment workspaces in the specified subscription.",
        "parameters": [
          {
            "$ref": "../../../../../common-types/resource-management/v5/types.json#/parameters/SubscriptionIdParameter"
          },
          {
            "$ref": "../../../../../common-types/resource-management/v5/types.json#/parameters/ApiVersionParameter"
          }
        ],
        "responses": {
          "200": {
            "description": "Get all the experiment workspaces in the specified subscription",
            "schema": {
              "$ref": "#/definitions/ExperimentWorkspaceListResult"
            }
          },
          "default": {
            "description": "Error response describing why the operation failed.",
            "schema": {
              "$ref": "../../../../../common-types/resource-management/v5/types.json#/definitions/ErrorResponse"
            }
          }
        },
        "x-ms-pageable": {
          "nextLinkName": "nextLink"
        }
      }
    }
  },
  "definitions": {
    "ExperimentWorkspacePatch": {
      "type": "object",
      "description": "An experiment workspace properties.",
      "properties": {
        "tags": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "x-ms-mutability": [
            "read",
            "create",
            "update"
          ],
          "description": "Resource tags."
        },
        "identity": {
          "description": "The identity of the workspace",
          "$ref": "#/definitions/ManagedIdentity"
        }
      }
    },
    "ExperimentWorkspace": {
      "type": "object",
      "description": "An experiment workspace.",
      "allOf": [
        {
          "$ref": "../../../../../common-types/resource-management/v5/types.json#/definitions/TrackedResource"
        }
      ],
      "properties": {
        "properties": {
          "$ref": "#/definitions/ExperimentWorkspaceProperties",
          "description": "Resource properties.",
          "x-ms-client-flatten": true
        },
        "systemData": {
          "$ref": "../../../../../common-types/resource-management/v5/types.json#/definitions/systemData",
          "readOnly": true
        },
        "identity": {
          "description": "The identity of the workspace",
          "$ref": "#/definitions/ManagedIdentity"
        }
      }
    },
    "ExperimentWorkspaceProperties": {
      "type": "object",
      "description": "An experiment workspace properties.",
      "properties": {
        "expWorkspaceId": {
          "description": "The id for experiment workspace",
          "type": "string",
          "readOnly": true
        },
        "provisioningState": {
          "description": "The provisioning state for the resource",
          "type": "string",
          "readOnly": true
        },
        "afdTasUrl": {
          "description": "Afd Tas Url",
          "type": "string",
          "readOnly": true
        },
        "managementGroups": {
          "type": "array",
          "readOnly": true,
          "items": {
            "$ref": "#/definitions/ManagementGroup"
          },
          "description": "Management Groups"
        },
        "variantAssignmentConfigPublishing": {
          "$ref": "#/definitions/VariantAssignmentConfigPublishing"
        },
        "remoteVariantAssignment": {
          "$ref": "#/definitions/RemoteVariantAssignment"
        }
      }
    },
    "ExperimentWorkspaceCreate": {
      "type": "object",
      "description": "An experiment workspace.",
      "properties": {
        "properties": {
          "$ref": "#/definitions/ExperimentWorkspaceProperties",
          "description": "Resource properties.",
          "x-ms-client-flatten": true
        },
        "location": {
          "description": "Location of the resource.",
          "type": "string"
        },
        "name": {
          "description": "Name of the resource.",
          "type": "string"
        },
        "type": {
          "description": "Type of the resource.",
          "type": "string"
        },
        "tags": {
          "description": "Tags assigned to the resource.",
          "type": "object",
          "additionalProperties": {
            "type": "string"
          }
        },
        "identity": {
          "description": "The identity of the workspace",
          "$ref": "#/definitions/ManagedIdentity"
        }
      }
    },
    "ManagementGroup": {
      "type": "object",
      "description": "A management group.",
      "properties": {
        "name": {
          "description": "Management Group name.",
          "type": "string"
        },
        "tasEndpoint": {
          "description": "A treatment assignment service endpoint.",
          "type": "string",
          "readOnly": true
        },
        "tasCustomSubscriptionId": {
          "description": "Treatment Assignment Service custom subscription Id.",
          "type": "string"
        },
        "tasClusters": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/TASCluster"
          },
          "description": "Treatment Assignment Clusters"
        }
      }
    },
    "TASCluster": {
      "type": "object",
      "description": "An experiment workspace.",
      "properties": {
        "region": {
          "description": "Geographical region.",
          "type": "string"
        },
        "size": {
          "description": "Cluster size.",
          "type": "string"
        }
      }
    },
    "ExperimentWorkspaceListResult": {
      "type": "object",
      "properties": {
        "value": {
          "type": "array",
          "description": "Results of the list operation.",
          "items": {
            "$ref": "#/definitions/ExperimentWorkspace"
          }
        },
        "nextLink": {
          "type": "string",
          "description": "Link for next set of locations."
        }
      },
      "description": "The response of list experiment workspace operation."
    },
    "ManagedIdentity": {
      "description": "The workspace managed identity",
      "type": "object",
      "properties": {
        "type": {
          "description": "The type of managed identity for the workspace",
          "enum": [
            "None",
            "UserAssigned"
          ],
          "type": "string",
          "x-ms-enum": {
            "name": "ResourceIdentityType",
            "modelAsString": false
          }
        },
        "userAssignedIdentities": {
          "description": "The user assigned managed identities.",
          "$ref": "../../../../../common-types/resource-management/v5/managedidentity.json#/definitions/UserAssignedIdentities"
        }
      },
      "required": [
        "type"
      ]
    },
    "VariantAssignmentConfigPublishing": {
      "type": "object",
      "description": "The variant assignment configuration will be published to a storage account linked here. This involves using the Variant Assignment SDK. Using this assignment method, your service will pull the assignment blob from storage account registered in the workspace.",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Indicates whether variant assignment publishing model is enabled or not."
        },
        "storageAccountResourceId": {
          "type": "string",
          "description": "The resource identifier of storage account where blob should be delivered. Blob would be delivered to exp-blobs storage container in the storage account.",
          "format": "arm-id",
          "x-ms-arm-id-details": {
            "allowedResourceTypes": [
              {
                "scopes": [
                  "ResourceGroup"
                ],
                "type": "Microsoft.Storage/storageAccounts"
              }
            ]
          }
        },
        "userAssignedIdentityResourceId": {
          "type": "string",
          "description": "User assigned identity to use for accessing storage account. This identity should have access to storage account specified in storageAccountResourceId. If not specified, defaults to first alphabetically sorted user assigned identity assigned to the workspace.",
          "format": "arm-id",
          "x-ms-arm-id-details": {
            "allowedResourceTypes": [
              {
                "scopes": [
                  "ResourceGroup"
                ],
                "type": "Microsoft.ManagedIdentity/userAssignedIdentities"
              }
            ]
          }
        }
      }
    },
    "RemoteVariantAssignment": {
      "type": "object",
      "description": "The remote variant assignment, your service will do a network call to an assignment endpoint and retrieve the variants assigned. This option is recommended for testing with less than 100 RPS.",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Indicates whether the remote variant assignment is enabled or not. Provisioning a remote variant assignment endpoint is an asynchronous operation and can take up to 20 minutes."
        },
        "endpoint": {
          "type": "string",
          "description": "The endpoint where your service will make a network call to retrieve the variants assigned.",
          "readOnly": true
        },
        "provisioningState": {
          "description": "The provisioning state of the remote variant assignment service endpoint.",
          "readOnly": true,
          "x-nullable": true,
          "enum": [
            "Succeeded",
            "Failed",
            "Accepted",
            "Canceled"
          ],
          "type": "string",
          "x-ms-enum": {
            "name": "remoteVariantAssignmentProvisioningState",
            "modelAsString": false
          }
        }
      }
    }
  },
  "parameters": {
    "experimentWorkspaceParameter": {
      "name": "experimentWorkspaceName",
      "in": "path",
      "description": "The name of the experimentation workspace.",
      "required": true,
      "type": "string",
      "x-ms-parameter-location": "client"
    }
  }
}
