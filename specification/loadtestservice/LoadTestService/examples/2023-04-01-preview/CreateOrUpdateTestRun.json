{
  "operationId": "LoadTestRun_CreateOrUpdateTestRun",
  "title": "Create/update and start a load test run",
  "parameters": {
    "testRunId": "12316678-1234-1234-1234-122451189012",
    "oldTestRunId": "12345678-1234-1234-1234-123456789012",
    "api-version": "2023-04-01-preview",
    "body": {
      "displayName": "Performance_LoadTest_Run1",
      "testId": "12345678-1234-1234-1234-123456789012",
      "description": "sample description",
      "loadTestConfiguration": {
        "engineInstances": 6,
        "splitAllCSVs": true
      },
      "passFailCriteria": {
        "passFailMetrics": {
          "fefd759d-7fe8-4f83-8b6d-aeebe0f491fe": {
            "clientMetric": "response_time_ms",
            "aggregate": "percentage",
            "condition": ">",
            "value": 20,
            "action": "continue"
          }
        }
      },
      "autoStopCriteria": {
        "autoStopDisabled": true,
        "errorRate": 70,
        "errorRateTimeWindowInSeconds": 60
      },
      "secrets": {
        "secret1": {
          "value": "https://samplevault.vault.azure.net/secrets/samplesecret/f113f91fd4c44a368049849c164db827",
          "type": "AKV_SECRET_URI"
        }
      },
      "environmentVariables": {
        "envvar1": "sampletext"
      }
    }
  },
  "responses": {
    "200": {
      "body": {
        "testRunId": "12316678-1234-1234-1234-122451189012",
        "displayName": "Performance_LoadTest_Run1",
        "testId": "12345678-1234-1234-1234-123456789012",
        "description": "sample description",
        "status": "ACCEPTED",
        "startDateTime": "2021-12-05T16:43:48.125Z",
        "endDateTime": "2021-12-05T16:43:48.125Z",
        "loadTestConfiguration": {
          "engineInstances": 6,
          "splitAllCSVs": true
        },
        "testResult": "PASSED",
        "passFailCriteria": {
          "passFailMetrics": {
            "fefd759d-7fe8-4f83-8b6d-aeebe0f491fe": {
              "clientMetric": "response_time_ms",
              "aggregate": "percentage",
              "condition": ">",
              "value": 20,
              "action": "continue",
              "actualValue": 10,
              "result": "passed"
            }
          }
        },
        "autoStopCriteria": {
          "autoStopDisabled": true,
          "errorRate": 70,
          "errorRateTimeWindowInSeconds": 60
        },
        "testArtifacts": {
          "inputArtifacts": {
            "configFileInfo": {
              "url": "https://dummyurl.com/configresource",
              "fileName": "config.yaml",
              "fileType": "ADDITIONAL_ARTIFACTS",
              "expireDateTime": "2021-12-05T16:43:46.072Z",
              "validationStatus": ""
            },
            "testScriptFileInfo": {
              "url": "https://dummyurl.com/testscriptresource",
              "fileName": "sample.jmx",
              "fileType": "JMX_FILE",
              "expireDateTime": "2021-12-05T16:43:46.072Z",
              "validationStatus": "VALIDATION_SUCCESS"
            },
            "userPropFileInfo": {
              "url": "https://dummyurl.com/userpropresource",
              "fileName": "user.properties",
              "fileType": "USER_PROPERTIES",
              "expireDateTime": "2021-12-05T16:43:46.072Z",
              "validationStatus": ""
            },
            "inputArtifactsZipFileInfo": {
              "url": "https://dummyurl.com/inputartifactzipresource",
              "fileName": "inputartifacts.zip",
              "fileType": "ADDITIONAL_ARTIFACTS",
              "expireDateTime": "2021-12-05T16:43:46.072Z",
              "validationStatus": ""
            },
            "additionalFileInfo": []
          },
          "outputArtifacts": {
            "resultFileInfo": {
              "url": "https://dummyurl.com/dummyresourceresult",
              "fileName": "results.zip",
              "fileType": "ADDITIONAL_ARTIFACTS",
              "expireDateTime": "2021-12-05T16:43:46.072Z",
              "validationStatus": "VALIDATION_SUCCESS"
            },
            "logsFileInfo": {
              "url": "https://dummyurl.com/logresource",
              "fileName": "worker.log",
              "fileType": "ADDITIONAL_ARTIFACTS",
              "expireDateTime": "2022-05-16T09:14:46.0411793+00:00",
              "validationStatus": ""
            }
          }
        },
        "executedDateTime": "2021-12-05T16:43:48.125Z",
        "virtualUsers": 4,
        "testRunStatistics": {
          "Total": {
            "transaction": "Total",
            "sampleCount": 18,
            "errorCount": 19,
            "errorPct": 17,
            "meanResTime": 13,
            "medianResTime": 10,
            "maxResTime": 16,
            "minResTime": 18,
            "pct1ResTime": 27,
            "pct2ResTime": 20,
            "pct3ResTime": 3,
            "throughput": 5,
            "receivedKBytesPerSec": 13,
            "sentKBytesPerSec": 4
          }
        },
        "createdDateTime": "2021-12-05T16:43:46.072Z",
        "createdBy": "user@contoso.com",
        "lastModifiedDateTime": "2021-12-05T16:43:46.072Z",
        "lastModifiedBy": "user@contoso.com",
        "portalUrl": "https://portal.azure.com/dummyresource",
        "secrets": {
          "secret1": {
            "value": "https://samplevault.vault.azure.net/secrets/samplesecret/f113f91fd4c44a368049849c164db827",
            "type": "AKV_SECRET_URI"
          }
        },
        "environmentVariables": {
          "envvar1": "sampletext"
        },
        "duration": 18,
        "subnetId": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/samplerg/providers/Microsoft.Network/virtualNetworks/samplenetworkresource/subnets/AAAAA0A0A0"
      }
    },
    "201": {
      "body": {
        "testRunId": "12316678-1234-1234-1234-122451189012",
        "displayName": "Performance_LoadTest_Run1",
        "testId": "12345678-1234-1234-1234-123456789012",
        "description": "sample description",
        "status": "ACCEPTED",
        "startDateTime": "2021-12-05T16:43:48.125Z",
        "endDateTime": "2021-12-05T16:43:48.125Z",
        "loadTestConfiguration": {
          "engineInstances": 6,
          "splitAllCSVs": true
        },
        "testResult": "PASSED",
        "passFailCriteria": {
          "passFailMetrics": {
            "fefd759d-7fe8-4f83-8b6d-aeebe0f491fe": {
              "clientMetric": "response_time_ms",
              "aggregate": "percentage",
              "condition": ">",
              "value": 20,
              "action": "continue",
              "actualValue": 10,
              "result": "passed"
            }
          }
        },
        "autoStopCriteria": {
          "autoStopDisabled": true,
          "errorRate": 70,
          "errorRateTimeWindowInSeconds": 60
        },
        "testArtifacts": {
          "inputArtifacts": {
            "configFileInfo": {
              "url": "https://dummyurl.com/configresource",
              "fileName": "config.yaml",
              "fileType": "ADDITIONAL_ARTIFACTS",
              "expireDateTime": "2021-12-05T16:43:46.072Z",
              "validationStatus": ""
            },
            "testScriptFileInfo": {
              "url": "https://dummyurl.com/testscriptresource",
              "fileName": "sample.jmx",
              "fileType": "JMX_FILE",
              "expireDateTime": "2021-12-05T16:43:46.072Z",
              "validationStatus": "VALIDATION_SUCCESS"
            },
            "userPropFileInfo": {
              "url": "https://dummyurl.com/userpropresource",
              "fileName": "user.properties",
              "fileType": "USER_PROPERTIES",
              "expireDateTime": "2021-12-05T16:43:46.072Z",
              "validationStatus": ""
            },
            "inputArtifactsZipFileInfo": {
              "url": "https://dummyurl.com/inputartifactzipresource",
              "fileName": "inputartifacts.zip",
              "fileType": "ADDITIONAL_ARTIFACTS",
              "expireDateTime": "2021-12-05T16:43:46.072Z",
              "validationStatus": ""
            },
            "additionalFileInfo": []
          },
          "outputArtifacts": {
            "resultFileInfo": {
              "url": "https://dummyurl.com/dummyresourceresult",
              "fileName": "results.zip",
              "fileType": "ADDITIONAL_ARTIFACTS",
              "expireDateTime": "2021-12-05T16:43:46.072Z",
              "validationStatus": "VALIDATION_SUCCESS"
            },
            "logsFileInfo": {
              "url": "https://dummyurl.com/logresource",
              "fileName": "worker.log",
              "fileType": "ADDITIONAL_ARTIFACTS",
              "expireDateTime": "2022-05-16T09:14:46.0411793+00:00",
              "validationStatus": ""
            }
          }
        },
        "executedDateTime": "2021-12-05T16:43:48.125Z",
        "virtualUsers": 4,
        "testRunStatistics": {
          "Total": {
            "transaction": "Total",
            "sampleCount": 18,
            "errorCount": 19,
            "errorPct": 17,
            "meanResTime": 13,
            "medianResTime": 10,
            "maxResTime": 16,
            "minResTime": 18,
            "pct1ResTime": 27,
            "pct2ResTime": 20,
            "pct3ResTime": 3,
            "throughput": 5,
            "receivedKBytesPerSec": 13,
            "sentKBytesPerSec": 4
          }
        },
        "createdDateTime": "2021-12-05T16:43:46.072Z",
        "createdBy": "user@contoso.com",
        "lastModifiedDateTime": "2021-12-05T16:43:46.072Z",
        "lastModifiedBy": "user@contoso.com",
        "portalUrl": "https://portal.azure.com/dummyresource",
        "secrets": {
          "secret1": {
            "value": "https://samplevault.vault.azure.net/secrets/samplesecret/f113f91fd4c44a368049849c164db827",
            "type": "AKV_SECRET_URI"
          }
        },
        "environmentVariables": {
          "envvar1": "sampletext"
        },
        "duration": 18,
        "subnetId": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/samplerg/providers/Microsoft.Network/virtualNetworks/samplenetworkresource/subnets/AAAAA0A0A0"
      }
    }
  }
}
