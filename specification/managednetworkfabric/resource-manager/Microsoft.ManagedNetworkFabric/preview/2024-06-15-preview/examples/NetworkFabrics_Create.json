{
  "title": "NetworkFabrics_Create_MaximumSet_Gen",
  "operationId": "NetworkFabrics_Create",
  "parameters": {
    "api-version": "2024-06-15-preview",
    "subscriptionId": "0000ABCD-0A0B-0000-0000-000000ABCDEF",
    "resourceGroupName": "example-rg",
    "networkFabricName": "example-fabric",
    "resource": {
      "properties": {
        "annotation": "annotation",
        "networkFabricSku": "M4-A400-A100-C16-aa",
        "fabricVersion": "version1",
        "storageAccountConfiguration": {
          "storageAccountId": "/subscriptions/1234ABCD-0A1B-1234-5678-123456ABCDEF/resourceGroups/example-rg/providers/Microsoft.Storage/storageAccounts/nfStorage",
          "storageAccountIdentity": {
            "identityType": "UserAssignedIdentity",
            "userAssignedIdentityResourceId": "/subscriptions/12345678-1234-1234-1234-123456789abc/resourceGroups/myResourceGroup/providers/Microsoft.ManagedIdentity/userAssignedIdentities/my-id"
          }
        },
        "networkFabricControllerId": "/subscriptions/1234ABCD-0A1B-1234-5678-123456ABCDEF/resourceGroups/example-rg/providers/Microsoft.ManagedNetworkFabric/networkFabricControllers/example-fabricController",
        "rackCount": 4,
        "serverCountPerRack": 8,
        "storageArrayCount": 1,
        "ipv4Prefix": "10.18.0.0/19",
        "ipv6Prefix": "3FFE:FFFF:0:CD40::/59",
        "fabricASN": 29249,
        "terminalServerConfiguration": {
          "username": "username",
          "password": "xxx-xx-xx",
          "serialNumber": "123456",
          "primaryIpv4Prefix": "10.0.0.12/30",
          "primaryIpv6Prefix": "4FFE:FFFF:0:CD30::a8/127",
          "secondaryIpv4Prefix": "40.0.0.14/30",
          "secondaryIpv6Prefix": "6FFE:FFFF:0:CD30::ac/127"
        },
        "managementNetworkConfiguration": {
          "infrastructureVpnConfiguration": {
            "networkToNetworkInterconnectId": "/subscriptions/1234ABCD-0A1B-1234-5678-123456ABCDEF/resourceGroups/example-rg/providers/Microsoft.ManagedNetworkFabric/networkFabrics/example-fabric/networkToNetworkInterconnects/example-nni",
            "peeringOption": "OptionA",
            "optionBProperties": {
              "importRouteTargets": [
                "65046:10050"
              ],
              "exportRouteTargets": [
                "65046:10050"
              ],
              "routeTargets": {
                "importIpv4RouteTargets": [
                  "65046:10050"
                ],
                "importIpv6RouteTargets": [
                  "65046:10050"
                ],
                "exportIpv4RouteTargets": [
                  "65046:10050"
                ],
                "exportIpv6RouteTargets": [
                  "65046:10050"
                ]
              }
            },
            "optionAProperties": {
              "mtu": 1501,
              "vlanId": 3001,
              "peerASN": 1235,
              "bfdConfiguration": {
                "intervalInMilliSeconds": 300,
                "multiplier": 10
              },
              "primaryIpv4Prefix": "10.0.0.12/30",
              "primaryIpv6Prefix": "4FFE:FFFF:0:CD30::a8/127",
              "secondaryIpv4Prefix": "20.0.0.13/30",
              "secondaryIpv6Prefix": "6FFE:FFFF:0:CD30::ac/127"
            }
          },
          "workloadVpnConfiguration": {
            "networkToNetworkInterconnectId": "/subscriptions/1234ABCD-0A1B-1234-5678-123456ABCDEF/resourceGroups/example-rg/providers/Microsoft.ManagedNetworkFabric/networkFabrics/example-fabric/networkToNetworkInterconnects/example-nni",
            "peeringOption": "OptionA",
            "optionBProperties": {
              "importRouteTargets": [
                "65046:10050"
              ],
              "exportRouteTargets": [
                "65046:10050"
              ],
              "routeTargets": {
                "importIpv4RouteTargets": [
                  "65046:10050"
                ],
                "importIpv6RouteTargets": [
                  "65046:10050"
                ],
                "exportIpv4RouteTargets": [
                  "65046:10050"
                ],
                "exportIpv6RouteTargets": [
                  "65046:10050"
                ]
              }
            },
            "optionAProperties": {
              "mtu": 1500,
              "vlanId": 3000,
              "peerASN": 61234,
              "bfdConfiguration": {
                "intervalInMilliSeconds": 300,
                "multiplier": 5
              },
              "primaryIpv4Prefix": "10.0.0.14/30",
              "primaryIpv6Prefix": "2FFE:FFFF:0:CD30::a7/126",
              "secondaryIpv4Prefix": "10.0.0.15/30",
              "secondaryIpv6Prefix": "2FFE:FFFF:0:CD30::ac/126"
            }
          }
        },
        "hardwareAlertThreshold": 74,
        "controlPlaneAcls": [
          "/subscriptions/xxxxxx/resourceGroups/resourcegroupname/providers/Microsoft.ManagedNetworkFabric/accessControlLists/example-acl"
        ],
        "trustedIpPrefixes": [
          "/subscriptions/xxxxxx/resourceGroups/resourcegroupname/providers/Microsoft.ManagedNetworkFabric/ipPrefixes/example-prefix"
        ],
        "uniqueRdConfiguration": {
          "uniqueRdConfigurationState": "Enabled",
          "nniDerivedUniqueRdConfigurationState": "Enabled"
        }
      },
      "identity": {
        "type": "None",
        "userAssignedIdentities": {
          "key872": {}
        }
      },
      "tags": {
        "keyId": "keyValue"
      },
      "location": "eastuseuap"
    }
  },
  "responses": {
    "200": {
      "body": {
        "properties": {
          "annotation": "annotation",
          "networkFabricSku": "M4-A400-A100-C16-aa",
          "fabricVersion": "version1",
          "routerIds": [
            "routerId"
          ],
          "storageAccountConfiguration": {
            "storageAccountId": "/subscriptions/1234ABCD-0A1B-1234-5678-123456ABCDEF/resourceGroups/example-rg/providers/Microsoft.Storage/storageAccounts/nfStorage",
            "storageAccountIdentity": {
              "identityType": "UserAssignedIdentity",
              "userAssignedIdentityResourceId": "/subscriptions/12345678-1234-1234-1234-123456789abc/resourceGroups/myResourceGroup/providers/Microsoft.ManagedIdentity/userAssignedIdentities/my-id"
            }
          },
          "fabricLocks": [
            {
              "lockState": "Enabled",
              "lockType": "Configuration"
            }
          ],
          "networkFabricControllerId": "/subscriptions/1234ABCD-0A1B-1234-5678-123456ABCDEF/resourceGroups/example-rg/providers/Microsoft.ManagedNetworkFabric/networkFabricControllers/example-fabricController",
          "rackCount": 4,
          "serverCountPerRack": 8,
          "storageArrayCount": 1,
          "ipv4Prefix": "10.18.0.0/19",
          "ipv6Prefix": "3FFE:FFFF:0:CD40::/59",
          "fabricASN": 29249,
          "terminalServerConfiguration": {
            "username": "username",
            "serialNumber": "123456",
            "primaryIpv4Prefix": "10.0.0.12/30",
            "primaryIpv6Prefix": "4FFE:FFFF:0:CD30::a8/127",
            "secondaryIpv4Prefix": "40.0.0.14/30",
            "secondaryIpv6Prefix": "6FFE:FFFF:0:CD30::ac/127",
            "networkDeviceId": "/subscriptions/1234ABCD-0A1B-1234-5678-123456ABCDEF/resourceGroups/example-rg/providers/Microsoft.ManagedNetworkFabric/networkDevices/example-networkDevice"
          },
          "managementNetworkConfiguration": {
            "infrastructureVpnConfiguration": {
              "networkToNetworkInterconnectId": "/subscriptions/1234ABCD-0A1B-1234-5678-123456ABCDEF/resourceGroups/example-rg/providers/Microsoft.ManagedNetworkFabric/networkFabrics/example-fabric/networkToNetworkInterconnects/example-nni",
              "administrativeState": "Enabled",
              "peeringOption": "OptionA",
              "optionBProperties": {
                "importRouteTargets": [
                  "65046:10050"
                ],
                "exportRouteTargets": [
                  "65046:10050"
                ],
                "routeTargets": {
                  "importIpv4RouteTargets": [
                    "65046:10050"
                  ],
                  "importIpv6RouteTargets": [
                    "65046:10050"
                  ],
                  "exportIpv4RouteTargets": [
                    "65046:10050"
                  ],
                  "exportIpv6RouteTargets": [
                    "65046:10050"
                  ]
                }
              },
              "optionAProperties": {
                "mtu": 1501,
                "vlanId": 3001,
                "peerASN": 1235,
                "bfdConfiguration": {
                  "administrativeState": "Enabled",
                  "intervalInMilliSeconds": 300,
                  "multiplier": 10
                },
                "primaryIpv4Prefix": "10.0.0.12/30",
                "primaryIpv6Prefix": "4FFE:FFFF:0:CD30::a8/127",
                "secondaryIpv4Prefix": "20.0.0.13/30",
                "secondaryIpv6Prefix": "6FFE:FFFF:0:CD30::ac/127"
              }
            },
            "workloadVpnConfiguration": {
              "networkToNetworkInterconnectId": "/subscriptions/1234ABCD-0A1B-1234-5678-123456ABCDEF/resourceGroups/example-rg/providers/Microsoft.ManagedNetworkFabric/networkFabrics/example-fabric/networkToNetworkInterconnects/example-nni",
              "administrativeState": "Enabled",
              "peeringOption": "OptionA",
              "optionBProperties": {
                "importRouteTargets": [
                  "65046:10050"
                ],
                "exportRouteTargets": [
                  "65046:10050"
                ],
                "routeTargets": {
                  "importIpv4RouteTargets": [
                    "65046:10050"
                  ],
                  "importIpv6RouteTargets": [
                    "65046:10050"
                  ],
                  "exportIpv4RouteTargets": [
                    "65046:10050"
                  ],
                  "exportIpv6RouteTargets": [
                    "65046:10050"
                  ]
                }
              },
              "optionAProperties": {
                "mtu": 1500,
                "vlanId": 3000,
                "peerASN": 61234,
                "bfdConfiguration": {
                  "administrativeState": "Enabled",
                  "intervalInMilliSeconds": 300,
                  "multiplier": 5
                },
                "primaryIpv4Prefix": "10.0.0.14/30",
                "primaryIpv6Prefix": "2FFE:FFFF:0:CD30::a7/126",
                "secondaryIpv4Prefix": "10.0.0.15/30",
                "secondaryIpv6Prefix": "2FFE:FFFF:0:CD30::ac/126"
              }
            }
          },
          "racks": [
            "/subscriptions/1234ABCD-0A1B-1234-5678-123456ABCDEF/resourceGroups/example-rg/providers/Microsoft.ManagedNetworkFabric/networkRacks/example-networkRack"
          ],
          "l2IsolationDomains": [
            "/subscriptions/1234ABCD-0A1B-1234-5678-123456ABCDEF/resourceGroups/example-rg/providers/Microsoft.ManagedNetworkFabric/l2IsolationDomains/example-l2Domain"
          ],
          "l3IsolationDomains": [
            "/subscriptions/1234ABCD-0A1B-1234-5678-123456ABCDEF/resourceGroups/example-rg/providers/Microsoft.ManagedNetworkFabric/l3IsolationDomains/example-l3Domain"
          ],
          "hardwareAlertThreshold": 74,
          "controlPlaneAcls": [
            "/subscriptions/xxxxxx/resourceGroups/resourcegroupname/providers/Microsoft.ManagedNetworkFabric/accessControlLists/example-acl"
          ],
          "featureFlags": [
            {
              "featureFlagName": "uniqueRdConfiguration",
              "featureFlagValue": "Enabled"
            }
          ],
          "trustedIpPrefixes": [
            "/subscriptions/xxxxxx/resourceGroups/resourcegroupname/providers/Microsoft.ManagedNetworkFabric/ipPrefixes/example-prefix"
          ],
          "uniqueRdConfiguration": {
            "uniqueRdConfigurationState": "Enabled",
            "uniqueRds": [
              "unique-rd-1"
            ],
            "nniDerivedUniqueRdConfigurationState": "Enabled"
          },
          "activeCommitBatches": [
            "batch-id"
          ],
          "configurationState": "Succeeded",
          "provisioningState": "Accepted",
          "administrativeState": "Enabled"
        },
        "identity": {
          "principalId": "0000ABCD-0A0B-0000-0000-000000ABCDEF",
          "tenantId": "0000ABCD-0A0B-0000-0000-000000ABCDEF",
          "type": "None",
          "userAssignedIdentities": {
            "key872": {
              "principalId": "0000ABCD-0A0B-0000-0000-000000ABCDEF",
              "clientId": "0000ABCD-0A0B-0000-0000-000000ABCDEF"
            }
          }
        },
        "tags": {
          "keyId": "keyValue"
        },
        "location": "eastuseuap",
        "id": "/subscriptions/1234ABCD-0A1B-1234-5678-123456ABCDEF/resourceGroups/example-rg/providers/Microsoft.ManagedNetworkFabric/networkFabrics/example-fabric",
        "name": "example-fabric",
        "type": "Microsoft.ManagedNetworkFabric/networkFabrics",
        "systemData": {
          "createdBy": "email@address.com",
          "createdByType": "User",
          "createdAt": "2023-06-09T04:51:41.251Z",
          "lastModifiedBy": "UserId",
          "lastModifiedByType": "User",
          "lastModifiedAt": "2023-06-09T04:51:41.251Z"
        }
      }
    },
    "201": {
      "headers": {
        "Azure-AsyncOperation": "https://contoso.com/operationstatus"
      },
      "body": {
        "properties": {
          "annotation": "annotation",
          "networkFabricSku": "M4-A400-A100-C16-aa",
          "fabricVersion": "version1",
          "routerIds": [
            "routerId"
          ],
          "storageAccountConfiguration": {
            "storageAccountId": "/subscriptions/1234ABCD-0A1B-1234-5678-123456ABCDEF/resourceGroups/example-rg/providers/Microsoft.Storage/storageAccounts/nfStorage",
            "storageAccountIdentity": {
              "identityType": "UserAssignedIdentity",
              "userAssignedIdentityResourceId": "/subscriptions/12345678-1234-1234-1234-123456789abc/resourceGroups/myResourceGroup/providers/Microsoft.ManagedIdentity/userAssignedIdentities/my-id"
            }
          },
          "fabricLocks": [
            {
              "lockState": "Enabled",
              "lockType": "Configuration"
            }
          ],
          "networkFabricControllerId": "/subscriptions/1234ABCD-0A1B-1234-5678-123456ABCDEF/resourceGroups/example-rg/providers/Microsoft.ManagedNetworkFabric/networkFabricControllers/example-fabricController",
          "rackCount": 4,
          "serverCountPerRack": 8,
          "storageArrayCount": 1,
          "ipv4Prefix": "10.18.0.0/19",
          "ipv6Prefix": "3FFE:FFFF:0:CD40::/59",
          "fabricASN": 29249,
          "terminalServerConfiguration": {
            "username": "username",
            "serialNumber": "123456",
            "primaryIpv4Prefix": "10.0.0.12/30",
            "primaryIpv6Prefix": "4FFE:FFFF:0:CD30::a8/127",
            "secondaryIpv4Prefix": "40.0.0.14/30",
            "secondaryIpv6Prefix": "6FFE:FFFF:0:CD30::ac/127",
            "networkDeviceId": "/subscriptions/1234ABCD-0A1B-1234-5678-123456ABCDEF/resourceGroups/example-rg/providers/Microsoft.ManagedNetworkFabric/networkDevices/example-networkDevice"
          },
          "managementNetworkConfiguration": {
            "infrastructureVpnConfiguration": {
              "networkToNetworkInterconnectId": "/subscriptions/1234ABCD-0A1B-1234-5678-123456ABCDEF/resourceGroups/example-rg/providers/Microsoft.ManagedNetworkFabric/networkFabrics/example-fabric/networkToNetworkInterconnects/example-nni",
              "administrativeState": "Enabled",
              "peeringOption": "OptionA",
              "optionBProperties": {
                "importRouteTargets": [
                  "65046:10050"
                ],
                "exportRouteTargets": [
                  "65046:10050"
                ],
                "routeTargets": {
                  "importIpv4RouteTargets": [
                    "65046:10050"
                  ],
                  "importIpv6RouteTargets": [
                    "65046:10050"
                  ],
                  "exportIpv4RouteTargets": [
                    "65046:10050"
                  ],
                  "exportIpv6RouteTargets": [
                    "65046:10050"
                  ]
                }
              },
              "optionAProperties": {
                "mtu": 1501,
                "vlanId": 3001,
                "peerASN": 1235,
                "bfdConfiguration": {
                  "administrativeState": "Enabled",
                  "intervalInMilliSeconds": 300,
                  "multiplier": 10
                },
                "primaryIpv4Prefix": "10.0.0.12/30",
                "primaryIpv6Prefix": "4FFE:FFFF:0:CD30::a8/127",
                "secondaryIpv4Prefix": "20.0.0.13/30",
                "secondaryIpv6Prefix": "6FFE:FFFF:0:CD30::ac/127"
              }
            },
            "workloadVpnConfiguration": {
              "networkToNetworkInterconnectId": "/subscriptions/1234ABCD-0A1B-1234-5678-123456ABCDEF/resourceGroups/example-rg/providers/Microsoft.ManagedNetworkFabric/networkFabrics/example-fabric/networkToNetworkInterconnects/example-nni",
              "administrativeState": "Enabled",
              "peeringOption": "OptionA",
              "optionBProperties": {
                "importRouteTargets": [
                  "65046:10050"
                ],
                "exportRouteTargets": [
                  "65046:10050"
                ],
                "routeTargets": {
                  "importIpv4RouteTargets": [
                    "65046:10050"
                  ],
                  "importIpv6RouteTargets": [
                    "65046:10050"
                  ],
                  "exportIpv4RouteTargets": [
                    "65046:10050"
                  ],
                  "exportIpv6RouteTargets": [
                    "65046:10050"
                  ]
                }
              },
              "optionAProperties": {
                "mtu": 1500,
                "vlanId": 3000,
                "peerASN": 61234,
                "bfdConfiguration": {
                  "administrativeState": "Enabled",
                  "intervalInMilliSeconds": 300,
                  "multiplier": 5
                },
                "primaryIpv4Prefix": "10.0.0.14/30",
                "primaryIpv6Prefix": "2FFE:FFFF:0:CD30::a7/126",
                "secondaryIpv4Prefix": "10.0.0.15/30",
                "secondaryIpv6Prefix": "2FFE:FFFF:0:CD30::ac/126"
              }
            }
          },
          "racks": [
            "/subscriptions/1234ABCD-0A1B-1234-5678-123456ABCDEF/resourceGroups/example-rg/providers/Microsoft.ManagedNetworkFabric/networkRacks/example-networkRack"
          ],
          "l2IsolationDomains": [
            "/subscriptions/1234ABCD-0A1B-1234-5678-123456ABCDEF/resourceGroups/example-rg/providers/Microsoft.ManagedNetworkFabric/l2IsolationDomains/example-l2Domain"
          ],
          "l3IsolationDomains": [
            "/subscriptions/1234ABCD-0A1B-1234-5678-123456ABCDEF/resourceGroups/example-rg/providers/Microsoft.ManagedNetworkFabric/l3IsolationDomains/example-l3Domain"
          ],
          "hardwareAlertThreshold": 74,
          "controlPlaneAcls": [
            "/subscriptions/xxxxxx/resourceGroups/resourcegroupname/providers/Microsoft.ManagedNetworkFabric/accessControlLists/example-acl"
          ],
          "featureFlags": [
            {
              "featureFlagName": "uniqueRdConfiguration",
              "featureFlagValue": "Enabled"
            }
          ],
          "trustedIpPrefixes": [
            "/subscriptions/xxxxxx/resourceGroups/resourcegroupname/providers/Microsoft.ManagedNetworkFabric/ipPrefixes/example-prefix"
          ],
          "uniqueRdConfiguration": {
            "uniqueRdConfigurationState": "Enabled",
            "uniqueRds": [
              "unique-rd-1"
            ],
            "nniDerivedUniqueRdConfigurationState": "Enabled"
          },
          "activeCommitBatches": [
            "batch-id"
          ],
          "configurationState": "Succeeded",
          "provisioningState": "Accepted",
          "administrativeState": "Enabled"
        },
        "identity": {
          "principalId": "0000ABCD-0A0B-0000-0000-000000ABCDEF",
          "tenantId": "0000ABCD-0A0B-0000-0000-000000ABCDEF",
          "type": "None",
          "userAssignedIdentities": {
            "key872": {
              "principalId": "0000ABCD-0A0B-0000-0000-000000ABCDEF",
              "clientId": "0000ABCD-0A0B-0000-0000-000000ABCDEF"
            }
          }
        },
        "tags": {
          "keyId": "keyValue"
        },
        "location": "eastuseuap",
        "id": "/subscriptions/1234ABCD-0A1B-1234-5678-123456ABCDEF/resourceGroups/example-rg/providers/Microsoft.ManagedNetworkFabric/networkFabrics/example-fabric",
        "name": "example-fabric",
        "type": "Microsoft.ManagedNetworkFabric/networkFabrics",
        "systemData": {
          "createdBy": "email@address.com",
          "createdByType": "User",
          "createdAt": "2023-06-09T04:51:41.251Z",
          "lastModifiedBy": "UserId",
          "lastModifiedByType": "User",
          "lastModifiedAt": "2023-06-09T04:51:41.251Z"
        }
      }
    }
  }
}
