{
  "swagger": "2.0",
  "info": {
    "title": "Azure Schema Registry",
    "version": "2021-11-01",
    "description": "Azure Schema Registry is as a central schema repository, with support for versioning, management, compatibility checking, and RBAC."
  },
  "x-ms-parameterized-host": {
    "hostTemplate": "{endpoint}",
    "useSchemePrefix": true,
    "parameters": [
      {
        "$ref": "#/parameters/Endpoint"
      }
    ]
  },
  "schemes": [
    "https"
  ],
  "securityDefinitions": {
    "azure_auth": {
      "type": "oauth2",
      "authorizationUrl": "https://login.microsoftonline.com/common/oauth2/authorize",
      "flow": "implicit",
      "description": "Azure Active Directory OAuth2 Flow",
      "scopes": {
        "user_impersonation": "impersonate your user account"
      }
    }
  },
  "paths": {
    "/$schemaGroups/schemas/{id}": {
      "get": {
        "summary": "Get a registered schema by its unique ID reference.",
        "description": "Gets a registered schema by its unique ID.  Azure Schema Registry guarantees that ID is unique within a namespace.",
        "x-ms-examples": {
          "Get schema by ID": {
            "$ref": "./examples/OperationSchema_GetById.json"
          }
        },
        "operationId": "Schema_GetById",
        "produces": [
          "text/plain;charset=utf-8"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "References specific schema in registry namespace.",
            "required": true,
            "type": "string"
          },
          {
            "$ref": "#/parameters/ApiVersionParameter"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "headers": {
              "Location": {
                "type": "string",
                "description": "URL location of schema, identified by schema group, schema name, and version."
              },
              "Serialization-Type": {
                "type": "string",
                "description": "Serialization type for the schema being stored.",
                "enum": [
                  "avro"
                ],
                "x-ms-enum": {
                  "name": "SerializationType",
                  "modelAsString": true,
                  "values": [
                    {
                      "value": "avro",
                      "name": "AVRO",
                      "description": "Avro Serialization schema type"
                    }
                  ]
                }
              },
              "Schema-Id": {
                "type": "string",
                "description": "References specific schema in registry namespace."
              },
              "Schema-Id-Location": {
                "type": "string",
                "description": "URL location of schema, identified by schema ID."
              },
              "Schema-Group-Name": {
                "type": "string",
                "description": "References schema group."
              },
              "Schema-Name": {
                "type": "string",
                "description": "References schema name."
              },
              "Schema-Version": {
                "type": "integer",
                "description": "Version of the returned schema."
              }
            },
            "schema": {
              "description": "String representation (UTF-8) of the registered schema.",
              "type": "string"
            }
          },
          "default": {
            "description": "An error response received from the Azure Schema Registry service.",
            "headers": {
              "x-ms-error-code": {
                "type": "string",
                "description": "Error code for specific error that occurred."
              }
            },
            "schema": {
              "$ref": "#/definitions/ErrorResponse"
            }
          }
        }
      }
    },
    "/$schemaGroups/{groupName}/schemas/{schemaName}": {
      "post": {
        "summary": "Get ID for existing schema.",
        "description": "Gets the ID referencing an existing schema within the specified schema group, as matched by schema content comparison.",
        "x-ms-examples": {
          "Get schema ID": {
            "$ref": "./examples/OperationSchema_QueryIdByContent.json"
          }
        },
        "operationId": "Schema_QueryIdByContent",
        "consumes": [
          "text/plain;charset=utf-8"
        ],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "name": "groupName",
            "in": "path",
            "description": "Schema group under which schema is registered.  Group's serialization type should match the serialization type specified in the request.",
            "required": true,
            "type": "string"
          },
          {
            "name": "schemaName",
            "in": "path",
            "description": "Name of schema being registered.",
            "required": true,
            "type": "string",
            "maxLength": 50,
            "pattern": "^[A-Za-z0-9][A-Za-z0-9_-]*$"
          },
          {
            "name": "Serialization-Type",
            "in": "header",
            "type": "string",
            "description": "Serialization type for the schema being registered.",
            "required": true,
            "enum": [
              "avro"
            ],
            "x-ms-enum": {
              "name": "SerializationType",
              "modelAsString": true,
              "values": [
                {
                  "value": "avro",
                  "name": "AVRO",
                  "description": "Avro Serialization schema type"
                }
              ]
            },
            "x-nullable": false
          },
          {
            "name": "schema-content",
            "in": "body",
            "description": "String representation (UTF-8) of the registered schema.",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "$ref": "#/parameters/ApiVersionParameter"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "headers": {
              "Location": {
                "type": "string",
                "description": "URL location of schema, identified by schema group, schema name, and version."
              },
              "Serialization-Type": {
                "type": "string",
                "description": "Serialization type for the schema being stored.",
                "enum": [
                  "avro"
                ],
                "x-ms-enum": {
                  "name": "SerializationType",
                  "modelAsString": true,
                  "values": [
                    {
                      "value": "avro",
                      "name": "AVRO",
                      "description": "Avro Serialization schema type"
                    }
                  ]
                }
              },
              "Schema-Id": {
                "type": "string",
                "description": "References specific schema in registry namespace."
              },
              "Schema-Id-Location": {
                "type": "string",
                "description": "URL location of schema, identified by schema ID."
              },
              "Schema-Group-Name": {
                "type": "string",
                "description": "References schema group."
              },
              "Schema-Name": {
                "type": "string",
                "description": "References schema name."
              },
              "Schema-Version": {
                "type": "integer",
                "description": "Version of the returned schema."
              }
            },
            "schema": {
              "$ref": "#/definitions/SchemaId"
            }
          },
          "default": {
            "description": "An error response received from the Azure Schema Registry service.",
            "headers": {
              "x-ms-error-code": {
                "type": "string",
                "description": "Error code for specific error that occurred."
              }
            },
            "schema": {
              "$ref": "#/definitions/ErrorResponse"
            }
          }
        }
      },
      "put": {
        "summary": "Register new schema",
        "description": "Register new schema. If schema of specified name does not exist in specified group, schema is created at version 1. If schema of specified name exists already in specified group, schema is created at latest version + 1.\n",
        "x-ms-examples": {
          "Register schema": {
            "$ref": "./examples/OperationSchema_Register.json"
          }
        },
        "operationId": "Schema_Register",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "text/plain;charset=utf-8"
        ],
        "parameters": [
          {
            "name": "groupName",
            "in": "path",
            "description": "Schema group under which schema should be registered.  Group's serialization type should match the serialization type specified in the request.",
            "required": true,
            "type": "string"
          },
          {
            "name": "schemaName",
            "in": "path",
            "description": "Name of schema being registered.",
            "required": true,
            "type": "string",
            "maxLength": 50,
            "pattern": "^[A-Za-z0-9][A-Za-z0-9_-]*$"
          },
          {
            "name": "Serialization-Type",
            "in": "header",
            "type": "string",
            "description": "Serialization type for the schema being registered.",
            "required": true,
            "enum": [
              "avro"
            ],
            "x-ms-enum": {
              "name": "SerializationType",
              "modelAsString": true,
              "values": [
                {
                  "value": "avro",
                  "name": "AVRO",
                  "description": "Avro Serialization schema type"
                }
              ]
            },
            "x-nullable": false
          },
          {
            "name": "schema-content",
            "in": "body",
            "description": "String representation (UTF-8) of the schema being registered.",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "$ref": "#/parameters/ApiVersionParameter"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "headers": {
              "Location": {
                "type": "string",
                "description": "URL location of schema, identified by schema group, schema name, and version."
              },
              "Serialization-Type": {
                "type": "string",
                "description": "Serialization type for the schema being registered.",
                "enum": [
                  "avro"
                ],
                "x-ms-enum": {
                  "name": "SerializationType",
                  "modelAsString": true,
                  "values": [
                    {
                      "value": "avro",
                      "name": "AVRO",
                      "description": "Avro Serialization schema type"
                    }
                  ]
                }
              },
              "Schema-Id": {
                "type": "string",
                "description": "References specific schema in registry namespace."
              },
              "Schema-Id-Location": {
                "type": "string",
                "description": "URL location of schema, identified by schema ID."
              },
              "Schema-Group-Name": {
                "type": "string",
                "description": "References schema group."
              },
              "Schema-Name": {
                "type": "string",
                "description": "References schema name."
              },
              "Schema-Version": {
                "type": "integer",
                "description": "Version of the returned schema."
              }
            },
            "schema": {
              "description": "String representation (UTF-8) of the registered schema id.",
              "type": "string"
            }
          },
          "201": {
            "description": "Created",
            "headers": {
              "Location": {
                "type": "string",
                "description": "URL location of schema, identified by schema group, schema name, and version."
              },
              "Serialization-Type": {
                "type": "string",
                "description": "Serialization type for the schema being registered.",
                "enum": [
                  "avro"
                ],
                "x-ms-enum": {
                  "name": "SerializationType",
                  "modelAsString": true,
                  "values": [
                    {
                      "value": "avro",
                      "name": "AVRO",
                      "description": "Avro Serialization schema type"
                    }
                  ]
                }
              },
              "Schema-Id": {
                "type": "string",
                "description": "References specific schema in registry namespace."
              },
              "Schema-Id-Location": {
                "type": "string",
                "description": "URL location of schema, identified by schema ID."
              },
              "Schema-Group-Name": {
                "type": "string",
                "description": "References schema group."
              },
              "Schema-Name": {
                "type": "string",
                "description": "References schema name."
              },
              "Schema-Version": {
                "type": "integer",
                "description": "Version of the returned schema."
              }
            },
            "schema": {
              "description": "String representation (UTF-8) of the registered schema id.",
              "type": "string"
            }
          },
          "default": {
            "description": "An error response received from the Azure Schema Registry service.",
            "headers": {
              "x-ms-error-code": {
                "type": "string",
                "description": "Error code for specific error that occurred."
              }
            },
            "schema": {
              "$ref": "#/definitions/ErrorResponse"
            }
          }
        }
      }
    }
  },
  "definitions": {
    "SchemaId": {
      "type": "object",
      "description": "Object received from the registry containing schema identifiers.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Schema ID that uniquely identifies a schema in the registry namespace."
        }
      }
    },
    "ErrorResponse": {
      "type": "object",
      "description": "An error response returned from Azure Schema Registry service.",
      "properties": {
        "error": {
          "$ref": "#/definitions/ServiceErrorResponse"
        }
      }
    },
    "ServiceErrorResponse": {
      "description": "Error response returned from Azure Schema Registry service.",
      "properties": {
        "code": {
          "type": "string",
          "description": "HTTP status code."
        },
        "message": {
          "type": "string",
          "description": "Type of error."
        },
        "details": {
          "type": "string",
          "description": "Error message details to help user understand/debug failure."
        },
        "innererror": {
          "$ref": "#/definitions/InnerError"
        }
      },
      "required": [
        "code",
        "message"
      ]
    },
    "InnerError": {
      "type": "object",
      "description": "Internal error details.",
      "properties": {
        "errordetail": {
          "type": "string",
          "description": "Internal error message."
        }
      }
    }
  },
  "parameters": {
    "ApiVersionParameter": {
      "name": "api-version",
      "in": "query",
      "required": true,
      "type": "string",
      "description": "Schema Registry service API version that should be used."
    },
    "Endpoint": {
      "name": "endpoint",
      "description": "The Schema Registry service endpoint, for example my-namespace.servicebus.windows.net.",
      "required": true,
      "type": "string",
      "in": "path",
      "x-ms-skip-url-encoding": true,
      "x-ms-parameter-location": "client"
    }
  }
}
