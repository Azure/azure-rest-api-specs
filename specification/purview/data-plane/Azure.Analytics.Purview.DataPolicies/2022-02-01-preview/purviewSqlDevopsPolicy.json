{
    "swagger": "2.0",
    "info": {
      "title": "Purview data Policies Service REST API Document",
      "version": "2022-02-01-preview"
    },
    "paths": {
      "/sqlDevopsPolicies/{policyName}": {
        "delete": {
          "tags": [
            "SQLDevopsPolicy"
          ],
          "description": "Deletes a Sql Devops policy for a given policy name.",
          "operationId": "SQLDevopsPolicy_Delete",
          "parameters": [
            {
              "in": "path",
              "name": "policyName",
              "description": "The name of the policy to be deleted.",
              "required": true,
              "type": "string"
            },
            {
              "$ref": "#/parameters/api-version"
            }
          ],
          "responses": {
            "200": {
              "description": "Success"
            },
            "default": {
              "description": "An error response received from the Policy Service",
              "schema": {
                "$ref": "#/definitions/ErrorResponseModel"
              },
              "headers": {
                "x-ms-error-code": {
                  "type": "string",
                  "description": "The error code"
                }
              }
            }
          },
          "x-ms-examples": {
            "SQLDevopsPolicy_Delete": {
              "$ref": "./examples/SQLDevopsPolicy_Delete.json"
            }
          }
        }
      },
      "/sqlDevopsPolicies": {
        "put": {
          "tags": [
            "DataPolicy"
          ],
          "description": "Creates/Updates a Sql Devops policy for a Purview data source and Purview data role.",
          "operationId": "SQLDevopsPolicy_CreateOrUpdate",
          "consumes": [
            "application/json"
          ],
          "produces": [
            "application/json"
          ],
          "parameters": [
            {
              "$ref": "#/parameters/api-version"
            },
            {
              "in": "body",
              "name": "body",
              "description": "The body of the SqlDevops policy which needs to be created or updated",
              "required": true,
              "schema": {
                "$ref": "#/definitions/SqlDevOpsPolicy"
              }
            }
          ],
          "responses": {
            "201": {
              "description": "The Sql DevOps Policy that has been created.",
              "schema": {
                "$ref": "#/definitions/SqlDevOpsPolicy"
              }
            },
            "200": {
              "description": "The Sql DevOps Policy that has been updated.",
              "schema": {
                "$ref": "#/definitions/SqlDevOpsPolicy"
              }
            },
            "default": {
              "description": "An error response received from the Policy Service",
              "schema": {
                "$ref": "#/definitions/ErrorResponseModel"
              },
              "headers": {
                "x-ms-error-code": {
                  "type": "string",
                  "description": "The error code"
                }
              }
            }
          },
          "x-ms-examples": {
            "SQLDevopsPolicy_CreateOrUpdate": {
              "$ref": "./examples/SQLDevopsPolicy_CreateOrUpdate.json"
            }
          }
        },
        "get": {
          "tags": [
            "SQLDevopsPolicy"
          ],
          "description": "List SqlDevops policies",
          "operationId": "SQLDevopsPolicy_List",
          "produces": [
            "application/json"
          ],
          "parameters": [
            {
              "in": "query",
              "name": "$filter",
              "description": "A string to filter out the policies.",
              "type": "string"
            },
            {
              "$ref": "#/parameters/api-version"
            }
          ],
          "responses": {
            "200": {
              "description": "Success",
              "schema": {
                "$ref": "#/definitions/SqlDevOpsPolicyList"
              }
            },
            "default": {
              "description": "An error response received from the Policy Service",
              "schema": {
                "$ref": "#/definitions/ErrorResponseModel"
              },
              "headers": {
                "x-ms-error-code": {
                  "type": "string",
                  "description": "The error code"
                }
              }
            }
          },
          "x-ms-pageable": {
            "nextLinkName": "nextLink",
            "itemName": "values"
          },
          "x-ms-examples": {
            "SQLDevopsPolicy_List": {
              "$ref": "./examples/SQLDevopsPolicy_List.json"
            }
          }
        }
      }
    },
    "definitions": {
      "ErrorModel": {
        "description": "The error model for policy",
        "required": [
          "code",
          "message"
        ],
        "type": "object",
        "properties": {
          "code": {
            "description": "The error code",
            "minLength": 1,
            "type": "string"
          },
          "message": {
            "description": "The error message",
            "minLength": 1,
            "type": "string"
          },
          "target": {
            "description": "The error target. This describes the place in the request body where is causing the error.",
            "type": "string"
          },
          "details": {
            "description": "The error details",
            "type": "array",
            "items": {
              "$ref": "#/definitions/ErrorModel"
            }
          }
        }
      },
      "ErrorResponseModel": {
        "description": "The error response model for policy",
        "required": [
          "error"
        ],
        "type": "object",
        "properties": {
          "error": {
            "$ref": "#/definitions/ErrorModel"
          }
        }
      },
      "SqlDevOpsPolicy": {
        "required": [
          "decisionRules",
          "scope"
        ],
        "type": "object",
        "properties": {
          "policyName": {
            "readOnly": true,
            "type": "string"
          },
          "id": {
            "readOnly": true,
            "type": "string"
          },
          "systemData": {
            "$ref": "#/definitions/SystemData",
            "readOnly": true
          },
          "version": {
            "format": "int32",
            "type": "integer"
          },
          "decisionRules": {
            "type": "array",
            "items": {
              "$ref": "#/definitions/SqlDevopsPolicyDecisionRule"
            }
          },
          "scope": {
            "$ref": "#/definitions/SqlDevopsPolicyScope"
          }
        }
      },
      "SqlDevOpsPolicyList": {
        "required": [
          "value"
        ],
        "type": "object",
        "properties": {
          "value": {
            "type": "array",
            "items": {
              "$ref": "#/definitions/SqlDevOpsPolicy"
            }
          },
          "nextLink": {
            "type": "string"
          }
        }
      },
      "SqlDevopsPolicyDecisionRule": {
        "required": [
          "effect",
          "purviewRoleName"
        ],
        "type": "object",
        "properties": {
          "effect": {
            "description": "The decision effect that this policy should have. The supported values are: Permit.",
            "enum": [
              "Permit"
            ],
            "type": "string",
            "x-ms-enum": {
              "name": "Decision",
              "modelAsString": true
            }
          },
          "purviewRoleName": {
            "description": "The name of the Purview data role for which the access needs to be provided.",
            "minLength": 1,
            "type": "string"
          },
          "principals": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "principalGroups": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "resourceAzurePath": {
            "type": "string"
          }
        }
      },
      "SqlDevopsPolicyScope": {
        "type": "object",
        "properties": {
          "type": {
            "description": "The type of reference",
            "default": "DataSourceReference",
            "type": "string"
          },
          "referenceName": {
            "description": "The name of reference",
            "type": "string"
          }
        }
      },
      "SystemData": {
        "type": "object",
        "properties": {
          "createdBy": {
            "type": "string"
          },
          "createdByType": {
            "type": "string"
          },
          "createdAt": {
            "format": "date-time",
            "type": "string"
          },
          "lastModifiedBy": {
            "type": "string"
          },
          "lastModifiedByType": {
            "type": "string"
          },
          "lastModifiedAt": {
            "format": "date-time",
            "type": "string"
          }
        }
      }
    },
    "parameters": {
      "api-version": {
        "in": "query",
        "name": "api-version",
        "description": "The api version to use.",
        "required": true,
        "type": "string",
        "x-ms-client-name": "ApiVersion"
      },
      "Endpoint": {
        "in": "path",
        "name": "Endpoint",
        "description": "The endpoint of your Purview account. Example: https://{accountName}.purview.azure.com.",
        "required": true,
        "type": "string",
        "x-ms-parameter-location": "client",
        "x-ms-skip-url-encoding": true
      }
    },
    "securityDefinitions": {
      "azure_auth": {
        "type": "oauth2",
        "flow": "implicit",
        "authorizationUrl": "https://login.microsoftonline.com/common/oauth2/authorize",
        "scopes": {
          "user_impersonation": "impersonate your user account"
        },
        "description": "Azure Active Directory OAuth2 Flow."
      }
    },
    "x-ms-parameterized-host": {
      "hostTemplate": "{Endpoint}",
      "useSchemePrefix": false,
      "parameters": [
        {
          "$ref": "#/parameters/Endpoint"
        }
      ]
    },
    "basePath": "/policyStore",
    "security": [
      {
        "azure_auth": [
          "user_impersonation"
        ]
      }
    ]
  }