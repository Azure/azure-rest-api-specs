{
  "parameters": {
    "subscriptionId": "20ff7fc3-e762-44dd-bd96-b71116dcdc23",
    "location": "global",
    "api-version": "2019-01-01",
    "productId": "Microsoft.IotHubPreview.1.0.2",
    "planId": "5f7d40b0-c504-4ebe-9db2-6f906d0faf6e",
    "operationId": "DeploySubOwnerResources"
  },
  "responses": {
    "200": {
      "body": {
        "value": [
          {
            "id": "/subscriptions/be8b2e19-7f92-4644-b808-a18283aebb01/providers/Microsoft.Deployment.Admin/locations/global/actionplans/5f7d40b0-c504-4ebe-9db2-6f906d0faf6e/operations/DeploySubOwnerResources",
            "name": "global/5f7d40b0-c504-4ebe-9db2-6f906d0faf6e/DeploySubOwnerResources",
            "type": "Microsoft.Deployment.Admin/locations/actionplans/operations",
            "properties": {
              "title": "Deploy Subscription Owner RG",
              "description": "Script demonstrating how to deploy resources from subscription owner access.",
              "type": "Script",
              "parameters": {
                "vault": {
                  "name": "null-provider-vault",
                  "id": "/subscriptions/ca13578c-6d3b-4478-b63e-a65c89601d86/resourceGroups/Microsoft.NullProvider/providers/Microsoft.KeyVault/vaults/null-provider-vault"
                },
                "providerIdentity": {
                  "identifierUriPrefix": "nullprovider",
                  "displayName": "Azure Stack - NullProvider App",
                  "certificates": [
                    {
                      "secretUri": "https://null-provider-vault.adminvault.redmond.ext-n22r1708.masd.stbtest.microsoft.com/secrets/ProviderIdentityClientCertPublic"
                    }
                  ],
                  "applicationId": "99011b1e-4056-44d0-b1a2-9c9ed959f024",
                  "servicePrincipalObjectId": "b0121fa7-fcdb-4d09-80ef-cdcc9d04493b",
                  "identifierUris": [
                    "https://nullprovider.rp.azurestackci02.onmicrosoft.com/3d6d059d-5b08-4432-bc39-a29fe8de30c1"
                  ],
                  "tenantId": "6a8092d6-08d4-45af-894a-121400ef36a1",
                  "loginBaseEndpoint": "https://login.microsoftonline.com/",
                  "graphBaseEndpoint": "https://graph.windows.net/",
                  "graphResource": "https://graph.windows.net/",
                  "graphApiVersion": "1.6",
                  "identitySystem": "AzureAD",
                  "provisioningState": "Succeeded"
                },
                "result": true
              },
              "startTime": "2019-10-15T19:35:23.8889341Z",
              "endTime": "2019-10-15T19:36:29.4432822Z",
              "outputs": {
                "vault": {
                  "name": "null-provider-vault",
                  "id": "/subscriptions/ca13578c-6d3b-4478-b63e-a65c89601d86/resourceGroups/Microsoft.NullProvider/providers/Microsoft.KeyVault/vaults/null-provider-vault"
                },
                "providerIdentity": {
                  "identifierUriPrefix": "nullprovider",
                  "displayName": "Azure Stack - NullProvider App",
                  "certificates": [
                    {
                      "secretUri": "https://null-provider-vault.adminvault.redmond.ext-n22r1708.masd.stbtest.microsoft.com/secrets/ProviderIdentityClientCertPublic"
                    }
                  ],
                  "applicationId": "99011b1e-4056-44d0-b1a2-9c9ed959f024",
                  "servicePrincipalObjectId": "b0121fa7-fcdb-4d09-80ef-cdcc9d04493b",
                  "identifierUris": [
                    "https://nullprovider.rp.azurestackci02.onmicrosoft.com/3d6d059d-5b08-4432-bc39-a29fe8de30c1"
                  ],
                  "tenantId": "6a8092d6-08d4-45af-894a-121400ef36a1",
                  "loginBaseEndpoint": "https://login.microsoftonline.com/",
                  "graphBaseEndpoint": "https://graph.windows.net/",
                  "graphResource": "https://graph.windows.net/",
                  "graphApiVersion": "1.6",
                  "identitySystem": "AzureAD",
                  "provisioningState": "Succeeded"
                },
                "result": true
              },
              "provisioningState": "Succeeded"
            }
          },
          {
            "id": "/subscriptions/be8b2e19-7f92-4644-b808-a18283aebb01/providers/Microsoft.Deployment.Admin/locations/global/actionplans/5f7d40b0-c504-4ebe-9db2-6f906d0faf6e/operations/Configure",
            "name": "global/5f7d40b0-c504-4ebe-9db2-6f906d0faf6e/Configure",
            "type": "Microsoft.Deployment.Admin/locations/actionplans/operations",
            "properties": {
              "title": "Configure Something",
              "description": "Sample script demonstrating how to connect to ARM and how get secrets from provider's vault.",
              "type": "Script",
              "parameters": {
                "vault": {
                  "name": "null-provider-vault",
                  "id": "/subscriptions/ca13578c-6d3b-4478-b63e-a65c89601d86/resourceGroups/Microsoft.NullProvider/providers/Microsoft.KeyVault/vaults/null-provider-vault"
                },
                "providerIdentity": {
                  "identifierUriPrefix": "nullprovider",
                  "displayName": "Azure Stack - NullProvider App",
                  "certificates": [
                    {
                      "secretUri": "https://null-provider-vault.adminvault.redmond.ext-n22r1708.masd.stbtest.microsoft.com/secrets/ProviderIdentityClientCertPublic"
                    }
                  ],
                  "applicationId": "99011b1e-4056-44d0-b1a2-9c9ed959f024",
                  "servicePrincipalObjectId": "b0121fa7-fcdb-4d09-80ef-cdcc9d04493b",
                  "identifierUris": [
                    "https://nullprovider.rp.azurestackci02.onmicrosoft.com/3d6d059d-5b08-4432-bc39-a29fe8de30c1"
                  ],
                  "tenantId": "6a8092d6-08d4-45af-894a-121400ef36a1",
                  "loginBaseEndpoint": "https://login.microsoftonline.com/",
                  "graphBaseEndpoint": "https://graph.windows.net/",
                  "graphResource": "https://graph.windows.net/",
                  "graphApiVersion": "1.6",
                  "identitySystem": "AzureAD",
                  "provisioningState": "Succeeded"
                }
              },
              "startTime": "2019-10-15T19:33:58.9810782Z",
              "endTime": "2019-10-15T19:35:23.7610359Z",
              "outputs": {
                "vault": {
                  "name": "null-provider-vault",
                  "id": "/subscriptions/ca13578c-6d3b-4478-b63e-a65c89601d86/resourceGroups/Microsoft.NullProvider/providers/Microsoft.KeyVault/vaults/null-provider-vault"
                },
                "providerIdentity": {
                  "identifierUriPrefix": "nullprovider",
                  "displayName": "Azure Stack - NullProvider App",
                  "certificates": [
                    {
                      "secretUri": "https://null-provider-vault.adminvault.redmond.ext-n22r1708.masd.stbtest.microsoft.com/secrets/ProviderIdentityClientCertPublic"
                    }
                  ],
                  "applicationId": "99011b1e-4056-44d0-b1a2-9c9ed959f024",
                  "servicePrincipalObjectId": "b0121fa7-fcdb-4d09-80ef-cdcc9d04493b",
                  "identifierUris": [
                    "https://nullprovider.rp.azurestackci02.onmicrosoft.com/3d6d059d-5b08-4432-bc39-a29fe8de30c1"
                  ],
                  "tenantId": "6a8092d6-08d4-45af-894a-121400ef36a1",
                  "loginBaseEndpoint": "https://login.microsoftonline.com/",
                  "graphBaseEndpoint": "https://graph.windows.net/",
                  "graphResource": "https://graph.windows.net/",
                  "graphApiVersion": "1.6",
                  "identitySystem": "AzureAD",
                  "provisioningState": "Succeeded"
                },
                "result": true
              },
              "provisioningState": "Succeeded"
            }
          },
          {
            "id": "/subscriptions/be8b2e19-7f92-4644-b808-a18283aebb01/providers/Microsoft.Deployment.Admin/locations/global/actionplans/5f7d40b0-c504-4ebe-9db2-6f906d0faf6e/operations/Secrets",
            "name": "global/5f7d40b0-c504-4ebe-9db2-6f906d0faf6e/Secrets",
            "type": "Microsoft.Deployment.Admin/locations/actionplans/operations",
            "properties": {
              "title": "Import and/or Create Secrets",
              "description": "Import external secrets and/or create internal secrets.",
              "type": "Template",
              "parameters": {
                "vault": {
                  "name": "null-provider-vault",
                  "id": "/subscriptions/ca13578c-6d3b-4478-b63e-a65c89601d86/resourceGroups/Microsoft.NullProvider/providers/Microsoft.KeyVault/vaults/null-provider-vault"
                },
                "providerIdentity": {
                  "identifierUriPrefix": "nullprovider",
                  "displayName": "Azure Stack - NullProvider App",
                  "certificates": [
                    {
                      "secretUri": "https://null-provider-vault.adminvault.redmond.ext-n22r1708.masd.stbtest.microsoft.com/secrets/ProviderIdentityClientCertPublic"
                    }
                  ],
                  "applicationId": "99011b1e-4056-44d0-b1a2-9c9ed959f024",
                  "servicePrincipalObjectId": "b0121fa7-fcdb-4d09-80ef-cdcc9d04493b",
                  "identifierUris": [
                    "https://nullprovider.rp.azurestackci02.onmicrosoft.com/3d6d059d-5b08-4432-bc39-a29fe8de30c1"
                  ],
                  "tenantId": "6a8092d6-08d4-45af-894a-121400ef36a1",
                  "loginBaseEndpoint": "https://login.microsoftonline.com/",
                  "graphBaseEndpoint": "https://graph.windows.net/",
                  "graphResource": "https://graph.windows.net/",
                  "graphApiVersion": "1.6",
                  "identitySystem": "AzureAD",
                  "provisioningState": "Succeeded"
                }
              },
              "startTime": "2019-10-15T19:33:00.5573558Z",
              "endTime": "2019-10-15T19:33:58.9185836Z",
              "outputs": {
                "vault": {
                  "name": "null-provider-vault",
                  "id": "/subscriptions/ca13578c-6d3b-4478-b63e-a65c89601d86/resourceGroups/Microsoft.NullProvider/providers/Microsoft.KeyVault/vaults/null-provider-vault"
                },
                "providerIdentity": {
                  "identifierUriPrefix": "nullprovider",
                  "displayName": "Azure Stack - NullProvider App",
                  "certificates": [
                    {
                      "secretUri": "https://null-provider-vault.adminvault.redmond.ext-n22r1708.masd.stbtest.microsoft.com/secrets/ProviderIdentityClientCertPublic"
                    }
                  ],
                  "applicationId": "99011b1e-4056-44d0-b1a2-9c9ed959f024",
                  "servicePrincipalObjectId": "b0121fa7-fcdb-4d09-80ef-cdcc9d04493b",
                  "identifierUris": [
                    "https://nullprovider.rp.azurestackci02.onmicrosoft.com/3d6d059d-5b08-4432-bc39-a29fe8de30c1"
                  ],
                  "tenantId": "6a8092d6-08d4-45af-894a-121400ef36a1",
                  "loginBaseEndpoint": "https://login.microsoftonline.com/",
                  "graphBaseEndpoint": "https://graph.windows.net/",
                  "graphResource": "https://graph.windows.net/",
                  "graphApiVersion": "1.6",
                  "identitySystem": "AzureAD",
                  "provisioningState": "Succeeded"
                }
              },
              "provisioningState": "Succeeded"
            }
          },
          {
            "id": "/subscriptions/be8b2e19-7f92-4644-b808-a18283aebb01/providers/Microsoft.Deployment.Admin/locations/global/actionplans/5f7d40b0-c504-4ebe-9db2-6f906d0faf6e/operations/AddSubscriptionOwner",
            "name": "global/5f7d40b0-c504-4ebe-9db2-6f906d0faf6e/AddSubscriptionOwner",
            "type": "Microsoft.Deployment.Admin/locations/actionplans/operations",
            "properties": {
              "title": "Add Subscription Owner",
              "description": "Grant subscription owner access to the add-on RP",
              "type": "AddSubscriptionOwner",
              "parameters": {
                "vault": {
                  "name": "null-provider-vault",
                  "id": "/subscriptions/ca13578c-6d3b-4478-b63e-a65c89601d86/resourceGroups/Microsoft.NullProvider/providers/Microsoft.KeyVault/vaults/null-provider-vault"
                },
                "providerIdentity": {
                  "identifierUriPrefix": "nullprovider",
                  "displayName": "Azure Stack - NullProvider App",
                  "certificates": [
                    {
                      "secretUri": "https://null-provider-vault.adminvault.redmond.ext-n22r1708.masd.stbtest.microsoft.com/secrets/ProviderIdentityClientCertPublic"
                    }
                  ],
                  "applicationId": "99011b1e-4056-44d0-b1a2-9c9ed959f024",
                  "servicePrincipalObjectId": "b0121fa7-fcdb-4d09-80ef-cdcc9d04493b",
                  "identifierUris": [
                    "https://nullprovider.rp.azurestackci02.onmicrosoft.com/3d6d059d-5b08-4432-bc39-a29fe8de30c1"
                  ],
                  "tenantId": "6a8092d6-08d4-45af-894a-121400ef36a1",
                  "loginBaseEndpoint": "https://login.microsoftonline.com/",
                  "graphBaseEndpoint": "https://graph.windows.net/",
                  "graphResource": "https://graph.windows.net/",
                  "graphApiVersion": "1.6",
                  "identitySystem": "AzureAD",
                  "provisioningState": "Succeeded"
                }
              },
              "startTime": "2019-10-15T19:32:59.882963Z",
              "endTime": "2019-10-15T19:33:00.5417235Z",
              "outputs": {
                "vault": {
                  "name": "null-provider-vault",
                  "id": "/subscriptions/ca13578c-6d3b-4478-b63e-a65c89601d86/resourceGroups/Microsoft.NullProvider/providers/Microsoft.KeyVault/vaults/null-provider-vault"
                },
                "providerIdentity": {
                  "identifierUriPrefix": "nullprovider",
                  "displayName": "Azure Stack - NullProvider App",
                  "certificates": [
                    {
                      "secretUri": "https://null-provider-vault.adminvault.redmond.ext-n22r1708.masd.stbtest.microsoft.com/secrets/ProviderIdentityClientCertPublic"
                    }
                  ],
                  "applicationId": "99011b1e-4056-44d0-b1a2-9c9ed959f024",
                  "servicePrincipalObjectId": "b0121fa7-fcdb-4d09-80ef-cdcc9d04493b",
                  "identifierUris": [
                    "https://nullprovider.rp.azurestackci02.onmicrosoft.com/3d6d059d-5b08-4432-bc39-a29fe8de30c1"
                  ],
                  "tenantId": "6a8092d6-08d4-45af-894a-121400ef36a1",
                  "loginBaseEndpoint": "https://login.microsoftonline.com/",
                  "graphBaseEndpoint": "https://graph.windows.net/",
                  "graphResource": "https://graph.windows.net/",
                  "graphApiVersion": "1.6",
                  "identitySystem": "AzureAD",
                  "provisioningState": "Succeeded"
                }
              },
              "provisioningState": "Succeeded"
            }
          },
          {
            "id": "/subscriptions/be8b2e19-7f92-4644-b808-a18283aebb01/providers/Microsoft.Deployment.Admin/locations/global/actionplans/5f7d40b0-c504-4ebe-9db2-6f906d0faf6e/operations/SetVaultAccessPolicies",
            "name": "global/5f7d40b0-c504-4ebe-9db2-6f906d0faf6e/SetVaultAccessPolicies",
            "type": "Microsoft.Deployment.Admin/locations/actionplans/operations",
            "properties": {
              "title": "Set Vault Access Policies",
              "description": "Grant access to provider's vault to provider's identity.",
              "type": "Template",
              "parameters": {
                "vault": {
                  "name": "null-provider-vault",
                  "id": "/subscriptions/ca13578c-6d3b-4478-b63e-a65c89601d86/resourceGroups/Microsoft.NullProvider/providers/Microsoft.KeyVault/vaults/null-provider-vault"
                },
                "providerIdentity": {
                  "identifierUriPrefix": "nullprovider",
                  "displayName": "Azure Stack - NullProvider App",
                  "certificates": [
                    {
                      "secretUri": "https://null-provider-vault.adminvault.redmond.ext-n22r1708.masd.stbtest.microsoft.com/secrets/ProviderIdentityClientCertPublic"
                    }
                  ],
                  "applicationId": "99011b1e-4056-44d0-b1a2-9c9ed959f024",
                  "servicePrincipalObjectId": "b0121fa7-fcdb-4d09-80ef-cdcc9d04493b",
                  "identifierUris": [
                    "https://nullprovider.rp.azurestackci02.onmicrosoft.com/3d6d059d-5b08-4432-bc39-a29fe8de30c1"
                  ],
                  "tenantId": "6a8092d6-08d4-45af-894a-121400ef36a1",
                  "loginBaseEndpoint": "https://login.microsoftonline.com/",
                  "graphBaseEndpoint": "https://graph.windows.net/",
                  "graphResource": "https://graph.windows.net/",
                  "graphApiVersion": "1.6",
                  "identitySystem": "AzureAD",
                  "provisioningState": "Succeeded"
                }
              },
              "startTime": "2019-10-15T19:32:00.433533Z",
              "endTime": "2019-10-15T19:32:59.8360901Z",
              "outputs": {
                "vault": {
                  "name": "null-provider-vault",
                  "id": "/subscriptions/ca13578c-6d3b-4478-b63e-a65c89601d86/resourceGroups/Microsoft.NullProvider/providers/Microsoft.KeyVault/vaults/null-provider-vault"
                },
                "providerIdentity": {
                  "identifierUriPrefix": "nullprovider",
                  "displayName": "Azure Stack - NullProvider App",
                  "certificates": [
                    {
                      "secretUri": "https://null-provider-vault.adminvault.redmond.ext-n22r1708.masd.stbtest.microsoft.com/secrets/ProviderIdentityClientCertPublic"
                    }
                  ],
                  "applicationId": "99011b1e-4056-44d0-b1a2-9c9ed959f024",
                  "servicePrincipalObjectId": "b0121fa7-fcdb-4d09-80ef-cdcc9d04493b",
                  "identifierUris": [
                    "https://nullprovider.rp.azurestackci02.onmicrosoft.com/3d6d059d-5b08-4432-bc39-a29fe8de30c1"
                  ],
                  "tenantId": "6a8092d6-08d4-45af-894a-121400ef36a1",
                  "loginBaseEndpoint": "https://login.microsoftonline.com/",
                  "graphBaseEndpoint": "https://graph.windows.net/",
                  "graphResource": "https://graph.windows.net/",
                  "graphApiVersion": "1.6",
                  "identitySystem": "AzureAD",
                  "provisioningState": "Succeeded"
                }
              },
              "provisioningState": "Succeeded"
            }
          },
          {
            "id": "/subscriptions/be8b2e19-7f92-4644-b808-a18283aebb01/providers/Microsoft.Deployment.Admin/locations/global/actionplans/5f7d40b0-c504-4ebe-9db2-6f906d0faf6e/operations/Identity",
            "name": "global/5f7d40b0-c504-4ebe-9db2-6f906d0faf6e/Identity",
            "type": "Microsoft.Deployment.Admin/locations/actionplans/operations",
            "properties": {
              "title": "Create Identity",
              "description": "Create provider's identity.",
              "type": "Template",
              "parameters": {
                "vault": {
                  "name": "null-provider-vault",
                  "id": "/subscriptions/ca13578c-6d3b-4478-b63e-a65c89601d86/resourceGroups/Microsoft.NullProvider/providers/Microsoft.KeyVault/vaults/null-provider-vault"
                }
              },
              "startTime": "2019-10-15T19:30:30.1106752Z",
              "endTime": "2019-10-15T19:32:00.3866607Z",
              "outputs": {
                "vault": {
                  "name": "null-provider-vault",
                  "id": "/subscriptions/ca13578c-6d3b-4478-b63e-a65c89601d86/resourceGroups/Microsoft.NullProvider/providers/Microsoft.KeyVault/vaults/null-provider-vault"
                },
                "providerIdentity": {
                  "identifierUriPrefix": "nullprovider",
                  "displayName": "Azure Stack - NullProvider App",
                  "certificates": [
                    {
                      "secretUri": "https://null-provider-vault.adminvault.redmond.ext-n22r1708.masd.stbtest.microsoft.com/secrets/ProviderIdentityClientCertPublic"
                    }
                  ],
                  "applicationId": "99011b1e-4056-44d0-b1a2-9c9ed959f024",
                  "servicePrincipalObjectId": "b0121fa7-fcdb-4d09-80ef-cdcc9d04493b",
                  "identifierUris": [
                    "https://nullprovider.rp.azurestackci02.onmicrosoft.com/3d6d059d-5b08-4432-bc39-a29fe8de30c1"
                  ],
                  "tenantId": "6a8092d6-08d4-45af-894a-121400ef36a1",
                  "loginBaseEndpoint": "https://login.microsoftonline.com/",
                  "graphBaseEndpoint": "https://graph.windows.net/",
                  "graphResource": "https://graph.windows.net/",
                  "graphApiVersion": "1.6",
                  "identitySystem": "AzureAD",
                  "provisioningState": "Succeeded"
                }
              },
              "provisioningState": "Succeeded"
            }
          },
          {
            "id": "/subscriptions/be8b2e19-7f92-4644-b808-a18283aebb01/providers/Microsoft.Deployment.Admin/locations/global/actionplans/5f7d40b0-c504-4ebe-9db2-6f906d0faf6e/operations/CreateVault",
            "name": "global/5f7d40b0-c504-4ebe-9db2-6f906d0faf6e/CreateVault",
            "type": "Microsoft.Deployment.Admin/locations/actionplans/operations",
            "properties": {
              "title": "Create Vault",
              "description": "Create provider's vault with minimal access policies.",
              "type": "Template",
              "parameters": {
                "vault": {
                  "name": "null-provider-vault",
                  "id": "/subscriptions/ca13578c-6d3b-4478-b63e-a65c89601d86/resourceGroups/Microsoft.NullProvider/providers/Microsoft.KeyVault/vaults/null-provider-vault"
                }
              },
              "startTime": "2019-10-15T19:29:56.6504711Z",
              "endTime": "2019-10-15T19:30:30.0794295Z",
              "outputs": {
                "vault": {
                  "name": "null-provider-vault",
                  "id": "/subscriptions/ca13578c-6d3b-4478-b63e-a65c89601d86/resourceGroups/Microsoft.NullProvider/providers/Microsoft.KeyVault/vaults/null-provider-vault"
                }
              },
              "provisioningState": "Succeeded"
            }
          },
          {
            "id": "/subscriptions/be8b2e19-7f92-4644-b808-a18283aebb01/providers/Microsoft.Deployment.Admin/locations/global/actionplans/5f7d40b0-c504-4ebe-9db2-6f906d0faf6e/operations/Constants",
            "name": "global/5f7d40b0-c504-4ebe-9db2-6f906d0faf6e/Constants",
            "type": "Microsoft.Deployment.Admin/locations/actionplans/operations",
            "properties": {
              "title": "Create Constants",
              "description": "Create deployment constants.",
              "type": "Template",
              "parameters": {},
              "startTime": "2019-10-15T19:29:22.7017314Z",
              "endTime": "2019-10-15T19:29:56.6348495Z",
              "outputs": {
                "vault": {
                  "name": "null-provider-vault",
                  "id": "/subscriptions/ca13578c-6d3b-4478-b63e-a65c89601d86/resourceGroups/Microsoft.NullProvider/providers/Microsoft.KeyVault/vaults/null-provider-vault"
                }
              },
              "provisioningState": "Succeeded"
            }
          }
        ]
      }
    }
  }
}
