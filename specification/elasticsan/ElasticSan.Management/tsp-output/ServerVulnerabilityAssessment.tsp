import "@azure-tools/typespec-azure-core";
import "@azure-tools/typespec-azure-resource-manager";
import "@typespec/openapi";
import "@typespec/rest";
import "./models.tsp";

using TypeSpec.Rest;
using Azure.ResourceManager;
using Azure.ResourceManager.Foundations;
using TypeSpec.Http;
using TypeSpec.OpenAPI;

namespace Microsoft.Security;
@doc("Describes the server vulnerability assessment details on a resource")
model ServerVulnerabilityAssessment
  is ProxyResource<ServerVulnerabilityAssessmentProperties> {
  @doc("ServerVulnerabilityAssessment status. only a 'default' value is supported.")
  @path
  @key("serverVulnerabilityAssessment")
  @segment("serverVulnerabilityAssessments")
  name: "default";
}

@armResourceOperations
interface ServerVulnerabilityAssessments {
  #suppress "@azure-tools/typespec-azure-core/no-operation-id" "For backward compatibility"
  @doc("Gets a server vulnerability assessment onboarding statuses on a given resource.")
  @operationId("ServerVulnerabilityAssessment_Get")
  get is ArmResourceRead<
    ServerVulnerabilityAssessment,
    {
      ...BaseParameters<ServerVulnerabilityAssessment>;

      @doc("ServerVulnerabilityAssessment status. only a 'default' value is supported.")
      @path
      serverVulnerabilityAssessment: "default";
    }
  >;

  #suppress "@azure-tools/typespec-azure-core/no-operation-id" "For backward compatibility"
  @doc("Creating a server vulnerability assessment on a resource, which will onboard a resource for having a vulnerability assessment on it")
  @operationId("ServerVulnerabilityAssessment_CreateOrUpdate")
  createOrUpdate is ArmResourceCreateOrReplaceSync<
    ServerVulnerabilityAssessment,
    {
      ...BaseParameters<ServerVulnerabilityAssessment>;

      @doc("ServerVulnerabilityAssessment status. only a 'default' value is supported.")
      @path
      serverVulnerabilityAssessment: "default";
    }
  >;

  #suppress "@azure-tools/typespec-azure-core/no-operation-id" "For backward compatibility"
  @doc("Removing server vulnerability assessment from a resource.")
  @operationId("ServerVulnerabilityAssessment_Delete")
  delete is ArmResourceDeleteAsync<
    ServerVulnerabilityAssessment,
    {
      ...BaseParameters<ServerVulnerabilityAssessment>;

      @doc("ServerVulnerabilityAssessment status. only a 'default' value is supported.")
      @path
      serverVulnerabilityAssessment: "default";
    },
    ArmLroLocationHeader
  >;

  #suppress "@azure-tools/typespec-azure-core/no-operation-id" "For backward compatibility"
  @doc("Gets a list of server vulnerability assessment onboarding statuses on a given resource.")
  @operationId("ServerVulnerabilityAssessment_ListByExtendedResource")
  listByExtendedResource is ArmResourceListByParent<ServerVulnerabilityAssessment>;
}
