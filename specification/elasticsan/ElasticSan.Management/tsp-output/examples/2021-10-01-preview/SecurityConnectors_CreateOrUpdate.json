{
  "parameters": {
    "api-version": "2022-08-01-preview",
    "resourceGroupName": "exampleResourceGroup",
    "securityConnector": {
      "etag": "etag value (must be supplied for update)",
      "location": "Central US",
      "properties": {
        "environmentData": {
          "environmentType": "AwsAccount"
        },
        "environmentName": "AWS",
        "hierarchyIdentifier": "exampleHierarchyId",
        "offerings": [
          {
            "nativeCloudConnection": {
              "cloudRoleArn": "arn:aws:iam::00000000:role/ASCMonitor"
            },
            "offeringType": "CspmMonitorAws"
          }
        ]
      },
      "tags": {}
    },
    "securityConnectorName": "exampleSecurityConnectorName",
    "subscriptionId": "a5caac9c-5c04-49af-b3d0-e204f40345d5"
  },
  "responses": {
    "200": {
      "body": {
        "name": "exampleSecurityConnectorName",
        "type": "Microsoft.Security/securityConnectors",
        "etag": "",
        "id": "/subscriptions/a5caac9c-5c04-49af-b3d0-e204f40345d5/resourceGroups/exampleResourceGroup/providers/Microsoft.Security/securityConnectors/exampleSecurityConnectorName",
        "kind": "",
        "location": "Central US",
        "properties": {
          "environmentData": {
            "environmentType": "AwsAccount"
          },
          "environmentName": "AWS",
          "hierarchyIdentifier": "exampleHierarchyId",
          "offerings": [
            {
              "nativeCloudConnection": {
                "cloudRoleArn": "arn:aws:iam::00000000:role/ASCMonitor"
              },
              "offeringType": "CspmMonitorAws"
            }
          ]
        },
        "systemData": {
          "createdAt": "2021-08-31T13:47:50.328Z",
          "createdBy": "user@contoso.com",
          "createdByType": "User",
          "lastModifiedAt": "2021-08-31T13:47:50.328Z",
          "lastModifiedBy": "user@contoso.com",
          "lastModifiedByType": "User"
        },
        "tags": {}
      }
    },
    "201": {
      "body": {
        "name": "exampleSecurityConnectorName",
        "type": "Microsoft.Security/securityConnectors",
        "etag": "",
        "id": "/subscriptions/a5caac9c-5c04-49af-b3d0-e204f40345d5/resourceGroups/exampleResourceGroup/providers/Microsoft.Security/securityConnectors/exampleSecurityConnectorName",
        "kind": "",
        "location": "Central US",
        "properties": {
          "environmentData": {
            "environmentType": "AwsAccount"
          },
          "environmentName": "AWS",
          "hierarchyIdentifier": "exampleHierarchyId",
          "offerings": [
            {
              "nativeCloudConnection": {
                "cloudRoleArn": "arn:aws:iam::00000000:role/ASCMonitor"
              },
              "offeringType": "CspmMonitorAws"
            }
          ]
        },
        "systemData": {
          "createdAt": "2021-08-31T13:47:50.328Z",
          "createdBy": "user@contoso.com",
          "createdByType": "User",
          "lastModifiedAt": "2021-08-31T13:47:50.328Z",
          "lastModifiedBy": "user@contoso.com",
          "lastModifiedByType": "User"
        },
        "tags": {}
      }
    }
  },
  "operationId": "SecurityConnectors_CreateOrUpdate",
  "title": "Create or update a security connector"
}