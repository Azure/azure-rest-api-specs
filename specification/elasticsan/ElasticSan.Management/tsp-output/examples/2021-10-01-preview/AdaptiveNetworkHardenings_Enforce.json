{
  "parameters": {
    "adaptiveNetworkHardeningEnforceAction": "enforce",
    "adaptiveNetworkHardeningResourceName": "default",
    "api-version": "2020-01-01",
    "body": {
      "networkSecurityGroups": [
        "/subscriptions/20ff7fc3-e762-44dd-bd96-b71116dcdc23/resourceGroups/rg1/providers/Microsoft.Network/networkSecurityGroups/nsg1",
        "/subscriptions/20ff7fc3-e762-44dd-bd96-b71116dcdc23/resourceGroups/rg2/providers/Microsoft.Network/networkSecurityGroups/nsg2"
      ],
      "rules": [
        {
          "name": "rule1",
          "destinationPort": 3389,
          "direction": "Inbound",
          "ipAddresses": [
            "100.10.1.1",
            "200.20.2.2",
            "81.199.3.0/24"
          ],
          "protocols": [
            "TCP"
          ]
        },
        {
          "name": "rule2",
          "destinationPort": 22,
          "direction": "Inbound",
          "ipAddresses": [],
          "protocols": [
            "TCP"
          ]
        }
      ]
    },
    "resourceGroupName": "rg1",
    "resourceName": "vm1",
    "resourceNamespace": "Microsoft.Compute",
    "resourceType": "virtualMachines",
    "subscriptionId": "20ff7fc3-e762-44dd-bd96-b71116dcdc23"
  },
  "responses": {
    "200": {
      "description": "OK."
    },
    "202": {
      "description": "HTTP 202 (Accepted) if the operation was successfully started and will complete asynchronously."
    }
  },
  "operationId": "AdaptiveNetworkHardenings_Enforce",
  "title": "Enforces the given rules on the NSG(s) listed in the request"
}