{
    "parameters": {
      "subscriptionId": "14ddf0c5-77c5-4b53-84f6-e1fa43ad68f7",
      "resourceGroupName": "gigtest",
      "ruleName": "dynamiccpu",
      "api-version": "2024-03-01-preview",
      "parameters": {
        "tags": {
          "key1": "value1",
          "key2": "value2"
        },
        "properties": {
          "enabled": false,
          "actions": [
            {
              "actionGroupId": "/subscriptions/14ddf0c5-77c5-4b53-84f6-e1fa43ad68f7/resourcegroups/gigtest/providers/microsoft.insights/actiongroups/newgroup"
            }
          ]
        }
      }
    },
    "responses": {
      "200": {
        "body": {
          "id": "/subscriptions/14ddf0c5-77c5-4b53-84f6-e1fa43ad68f7/resourceGroups/gigtest/providers/microsoft.insights/metricAlerts/dynamiccpu",
          "type": "Microsoft.Insights/metricAlerts",
          "name": "dynamiccpu",
          "location": "global",
          "kind": "Query",
          "tags": {
            "key1": "value1",
            "key2": "value2"
          },
          "properties": {
            "description": "This is a dynamic metric alert",
            "severity": 3,
            "enabled": false,
            "scopes": [
              "/subscriptions/14ddf0c5-77c5-4b53-84f6-e1fa43ad68f7/resourceGroups/gigtest/providers/Microsoft.Compute/virtualMachines/gigwadme"
            ],
            "evaluationFrequency": "PT1M",
            "resolveConfiguration": {
              "autoResolved": true,
              "timeToResolve": "PT15M"
            },
            "criteria": {
              "query": "Perf | where ObjectName == \"Processor\" and CounterName == \"% Processor Time\" | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 5m)"
            },
            "actions": [
              {
                "actionGroupId": "/subscriptions/14ddf0c5-77c5-4b53-84f6-e1fa43ad68f7/resourcegroups/gigtest/providers/microsoft.insights/actiongroups/newgroup"
              }
            ]
          }
        }
      }
    }
  }
