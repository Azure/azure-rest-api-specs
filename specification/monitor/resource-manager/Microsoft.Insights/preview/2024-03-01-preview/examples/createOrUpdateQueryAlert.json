{
  "parameters": {
    "subscriptionId": "14ddf0c5-77c5-4b53-84f6-e1fa43ad68f7",
    "resourceGroupName": "gigtest",
    "ruleName": "logqueryrule",
    "api-version": "2024-03-01-preview",
    "parameters": {
      "location": "global",
      "kind": "Query",
      "tags": {
        "key1": "value1"
      },
      "properties": {
        "description": "Alert based on log analytics query",
        "severity": 2,
        "enabled": true,
        "scopes": [
          "/subscriptions/14ddf0c5-77c5-4b53-84f6-e1fa43ad68f7/resourceGroups/gigtest/providers/Microsoft.OperationalInsights/workspaces/gigworkspace"
        ],
        "evaluationFrequency": "PT5M",
        "targetResourceType": "Microsoft.OperationalInsights/workspaces",
        "targetResourceRegion": "eastus",
        "criteria": {
          "query": "Heartbeat | where TimeGenerated >= ago(5m) | summarize count() by Computer",
          "timeAggregation": "Count"
        },
        "resolveConfiguration": {
          "autoResolved": true,
          "timeToResolve": "PT15M"
        },
        "actions": [
          {
            "actionGroupId": "/subscriptions/14ddf0c5-77c5-4b53-84f6-e1fa43ad68f7/resourcegroups/gigtest/providers/microsoft.insights/actiongroups/emailteam"
          }
        ]
      }
    }
  },
  "responses": {
    "200": {
      "body": {
        "id": "/subscriptions/14ddf0c5-77c5-4b53-84f6-e1fa43ad68f7/resourceGroups/gigtest/providers/microsoft.insights/metricAlerts/logqueryrule",
        "type": "Microsoft.Insights/metricAlerts",
        "name": "logqueryrule",
        "location": "global",
        "kind": "Query",
        "tags": {
          "key1": "value1"
        },
        "properties": {
          "description": "Alert based on log analytics query",
          "severity": 2,
          "enabled": true,
          "scopes": [
            "/subscriptions/14ddf0c5-77c5-4b53-84f6-e1fa43ad68f7/resourceGroups/gigtest/providers/Microsoft.OperationalInsights/workspaces/gigworkspace"
          ],
          "evaluationFrequency": "PT5M",
          "targetResourceType": "Microsoft.OperationalInsights/workspaces",
          "targetResourceRegion": "eastus",
          "criteria": {
            "query": "Heartbeat | where TimeGenerated >= ago(5m) | summarize count() by Computer",
            "timeAggregation": "Count"
          },
          "resolveConfiguration": {
            "autoResolved": true,
            "timeToResolve": "PT15M"
          },
          "actions": [
            {
              "actionGroupId": "/subscriptions/14ddf0c5-77c5-4b53-84f6-e1fa43ad68f7/resourcegroups/gigtest/providers/microsoft.insights/actiongroups/emailteam"
            }
          ]
        }
      }
    },
    "201": {
      "body": {
        "id": "/subscriptions/14ddf0c5-77c5-4b53-84f6-e1fa43ad68f7/resourceGroups/gigtest/providers/microsoft.insights/metricAlerts/logqueryrule",
        "type": "Microsoft.Insights/metricAlerts",
        "name": "logqueryrule",
        "location": "global",
        "kind": "Query",
        "tags": {
          "key1": "value1"
        },
        "properties": {
          "description": "Alert based on log analytics query",
          "severity": 2,
          "enabled": true,
          "scopes": [
            "/subscriptions/14ddf0c5-77c5-4b53-84f6-e1fa43ad68f7/resourceGroups/gigtest/providers/Microsoft.OperationalInsights/workspaces/gigworkspace"
          ],
          "evaluationFrequency": "PT5M",
          "targetResourceType": "Microsoft.OperationalInsights/workspaces",
          "targetResourceRegion": "eastus",
          "criteria": {
            "query": "Heartbeat | where TimeGenerated >= ago(5m) | summarize count() by Computer",
            "timeAggregation": "Count"
          },
          "resolveConfiguration": {
            "autoResolved": true,
            "timeToResolve": "PT15M"
          },
          "actions": [
            {
              "actionGroupId": "/subscriptions/14ddf0c5-77c5-4b53-84f6-e1fa43ad68f7/resourcegroups/gigtest/providers/microsoft.insights/actiongroups/emailteam"
            }
          ]
        }
      }
    }
  }
}
