{
  "parameters": {
    "api-version": "2020-08-01",
    "subscriptionId": "subid",
    "resourceGroupName": "rg1",
    "firewallPolicyName": "firewallPolicy",
    "parameters": {
      "tags": {
        "key1": "value1"
      },
      "location": "West US",
      "properties": {
        "threatIntelMode": "Alert",
        "threatIntelWhitelist": {
          "ipAddresses": [
            "20.3.4.5"
          ],
          "fqdns": [
            "*.microsoft.com"
          ]
        },
        "dnsSettings": {
          "servers": [
            "30.3.4.5"
          ],
          "enableProxy": true,
          "requireProxyForNetworkRules": false
        },
        "sku": {
          "tier": "Premium"
        },
        "intrusionDetection": {
          "mode": "Alert",
          "configuration": {
            "signatureOverrides": [
              {
                "id": "2525004",
                "mode": "Deny"
              }
            ],
            "bypassTrafficSettings": [
              {
                "name": "bypassRule1",
                "description": "Rule 1",
                "protocol": "TCP",
                "sourceAddresses": [
                  "1.2.3.4"
                ],
                "destinationAddresses": [
                  "5.6.7.8"
                ],
                "destinationPorts": [
                  "*"
                ]
              }
            ]
          }
        },
        "transportSecurity": {
          "certificateAuthority": {
            "name": "clientcert",
            "keyVaultSecretId": "https://kv/secret"
          }
        }
      }
    }
  },
  "responses": {
    "200": {
      "body": {
        "name": "firewallPolicy",
        "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy",
        "type": "Microsoft.Network/firewallPolicies",
        "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
        "location": "West US",
        "tags": {
          "key1": "value1"
        },
        "properties": {
          "provisioningState": "Succeeded",
          "threatIntelMode": "Alert",
          "threatIntelWhitelist": {
            "ipAddresses": [
              "20.3.4.5"
            ],
            "fqdns": [
              "*.microsoft.com"
            ]
          },
          "ruleCollectionGroups": [
            {
              "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy/ruleCollectionGroups/ruleCollectionGroup1"
            },
            {
              "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy/ruleCollectionGroups/ruleCollectionGroup2"
            }
          ],
          "firewalls": [],
          "dnsSettings": {
            "servers": [
              "30.3.4.5"
            ],
            "enableProxy": true,
            "requireProxyForNetworkRules": false
          },
          "sku": {
            "tier": "Premium"
          },
          "intrusionDetection": {
            "mode": "Alert",
            "configuration": {
              "signatureOverrides": [
                {
                  "id": "2525004",
                  "mode": "Deny"
                }
              ],
              "bypassTrafficSettings": [
                {
                  "name": "bypassRule1",
                  "description": "Rule 1",
                  "protocol": "TCP",
                  "sourceAddresses": [
                    "1.2.3.4"
                  ],
                  "destinationAddresses": [
                    "5.6.7.8"
                  ],
                  "destinationPorts": [
                    "*"
                  ]
                }
              ]
            }
          },
          "transportSecurity": {
            "certificateAuthority": {
              "name": "clientcert",
              "keyVaultSecretId": "https://kv/secret"
            }
          }
        }
      }
    },
    "201": {
      "body": {
        "name": "firewallPolicy",
        "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy",
        "type": "Microsoft.Network/firewallPolicies",
        "etag": "w/\\00000000-0000-0000-0000-000000000000\\",
        "location": "West US",
        "tags": {
          "key1": "value1"
        },
        "properties": {
          "provisioningState": "Succeeded",
          "threatIntelMode": "Alert",
          "threatIntelWhitelist": {
            "ipAddresses": [
              "20.3.4.5"
            ],
            "fqdns": [
              "*.microsoft.com"
            ]
          },
          "ruleCollectionGroups": [
            {
              "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy/ruleCollectionGroups/ruleCollectionGroup1"
            },
            {
              "id": "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/firewallPolicies/firewallPolicy/ruleCollectionGroups/ruleCollectionGroup2"
            }
          ],
          "firewalls": [],
          "dnsSettings": {
            "servers": [
              "30.3.4.5"
            ],
            "enableProxy": true,
            "requireProxyForNetworkRules": false
          },
          "sku": {
            "tier": "Premium"
          },
          "intrusionDetection": {
            "mode": "Alert",
            "configuration": {
              "signatureOverrides": [
                {
                  "id": "2525004",
                  "mode": "Deny"
                }
              ],
              "bypassTrafficSettings": [
                {
                  "name": "bypassRule1",
                  "description": "Rule 1",
                  "protocol": "TCP",
                  "sourceAddresses": [
                    "1.2.3.4"
                  ],
                  "destinationAddresses": [
                    "5.6.7.8"
                  ],
                  "destinationPorts": [
                    "*"
                  ]
                }
              ]
            }
          },
          "transportSecurity": {
            "certificateAuthority": {
              "name": "clientcert",
              "keyVaultSecretId": "https://kv/secret"
            }
          }
        }
      }
    }
  }
}
