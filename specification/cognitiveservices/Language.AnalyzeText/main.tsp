import "@typespec/rest";
import "@typespec/http";
import "@typespec/versioning";
// import "@typespec/openapi";
import "@azure-tools/typespec-azure-core";
import "@azure-tools/typespec-client-generator-core";
// import "@azure-tools/typespec-autorest";
import "./common.tsp";
import "./models/common.models.tsp";
import "./models/custom.text.tsp";
import "./models/entity.linking.tsp";
import "./models/entity.recognition.tsp";
import "./models/healthcare.tsp";
import "./models/key.phrase.extraction.tsp";
import "./models/language.detection.tsp";
import "./models/pii.entity.recognition.tsp";
import "./models/sentiment.analysis.tsp";
import "./models/summarization.tsp";

using TypeSpec.Http;
using TypeSpec.Rest;
// using OpenAPI;
using TypeSpec.Versioning;
using Azure.Core;
using Azure.Core.Traits;
using Azure.ClientGenerator.Core;

@useAuth(
  TypeSpec.Http.ApiKeyAuth<
    TypeSpec.Http.ApiKeyLocation.header,
    "Ocp-Apim-Subscription-Key"
  >
)
@doc("The language service API is a suite of natural language processing (NLP) skills built with best-in-class Microsoft machine learning algorithms.  The API can be used to analyze unstructured text for tasks such as sentiment analysis, key phrase extraction, language detection and question answering. Further documentation can be found in <a href=\"https://docs.microsoft.com/azure/cognitive-services/language-service/overview\">https://docs.microsoft.com/azure/cognitive-services/language-service/overview</a>.0")
@service({
  title: "Microsoft Cognitive Language Service - Text Analysis",
})
@server(
  "{Endpoint}",
  "Single server endpoint",
  {
    @doc("Supported Cognitive Services endpoint (e.g., https://<resource-name>.api.cognitiveservices.azure.com).")
    Endpoint: string,
  }
)
@versioned(Versions)
namespace Language.AnalyzeText;

@doc("Analyze Conversations Service Versions")
enum Versions {
  @doc("Version 2022-05-01")
  @useDependency(Azure.Core.Versions.v1_0_Preview_2)
  v2022_05_01: "2022-05-01",

  @doc("Version 2023-04-01")
  @useDependency(Azure.Core.Versions.v1_0_Preview_2)
  v2023_04_01: "2023-04-01",

  @doc("Version 2023-04-15-preview")
  @useDependency(Azure.Core.Versions.v1_0_Preview_2)
  v2023_04_15_preview: "2023-04-15-preview",
}

alias ServiceTraits = NoRepeatableRequests & NoConditionalRequests & NoClientRequestId;

alias Operations = Azure.Core.ResourceOperations<ServiceTraits>;

#suppress "@azure-tools/typespec-azure-core/no-operation-id" "Operation ID is automatically generated by the OpenAPI emitters and should not normally be specified."
@doc("Analyzes the input conversation utterance.")
@actionSeparator("/:")
@action("analyze-text")
op analyzeConversation is Operations.ResourceCollectionAction<
    AnalyzeTextTask,
    AnalyzeTextTask,
    AnalyzeTextTaskResult
  >;

#suppress "@azure-tools/typespec-azure-core/no-operation-id" "Operation ID is automatically generated by the OpenAPI emitters and should not normally be specified."
@doc("Get the status of an analysis job. A job can consist of one or more tasks. After all tasks succeed, the job transitions to the succeeded state and results are available for each task.")
@summary("Get analysis status and results")
op jobStatus is Operations.ResourceRead<
  AnalyzeTextJobState, 
  AnalyzeTextQueryParameters
>;

#suppress "@azure-tools/typespec-azure-core/no-operation-id" "Operation ID is automatically generated by the OpenAPI emitters and should not normally be specified."
@doc("Analyzes the input conversation utterance.")
@route("/language/analyze-text/jobs")
@pollingOperation(jobStatus)
op submitJob is LanguageLongRunningOperation<AnalyzeTextJobsInput, AnalyzeTextJobState>;

#suppress "@azure-tools/typespec-azure-core/no-operation-id" "Operation ID is automatically generated by the OpenAPI emitters and should not normally be specified."
@doc("Cancel a long-running job for text analysis of conversations.")
@summary("Cancel a long-running Text Analysis conversations job")
@pollingOperation(jobStatus)
@actionSeparator(":")
@action("cancel")
op cancel is LanguageLongRunningResourceCancel<AnalyzeTextJobState>;