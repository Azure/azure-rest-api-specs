{
  "parameters": {
    "scope": "subscriptions/afa2a084-766f-4003-8ae1-c4aeb893a99f",
    "api-version": "2022-08-01-preview"
  },
  "responses": {
    "200": {
      "body": {
        "value": [
          {
            "properties": {
              "scope": "subscriptions/afa2a084-766f-4003-8ae1-c4aeb893a99f",
              "incidentCount": 1,
              "lastModifiedDateTime": "2022-04-05T03:04:06.467+00:00",
              "lastScannedDateTime": "2022-04-06T18:25:00.38+00:00",
              "isActive": true,
              "alertDefinition": {
                "properties": {
                  "displayName": "Too many permanent owners assigned to a resource",
                  "scope": "subscriptions/afa2a084-766f-4003-8ae1-c4aeb893a99f",
                  "description": "The number of users set to never expire is too high. To enhance the security of your resources, we recommend requiring activation for role use. Take a moment to review the list of users, and suggested changes here.",
                  "severityLevel": "Medium",
                  "securityImpact": "Providing users permanent access in a role may leave resources vulnerable to accidental or malicious activity.",
                  "mitigationSteps": "To mitigate this issue, require the user to activate the role before use.",
                  "howToPrevent": "Enable “Activation Required” in the role settings menu. This will ensure newly added users must activate their role.",
                  "isRemediatable": true,
                  "isConfigurable": true
                },
                "name": "TooManyPermanentOwnersAssignedToResource",
                "id": "/subscriptions/afa2a084-766f-4003-8ae1-c4aeb893a99f/providers/Microsoft.Authorization/roleManagementAlerts/alertDefinitions/TooManyPermanentOwnersAssignedToResource",
                "type": "Microsoft.Authorization/roleManagementAlerts/alertDefinitions"
              },
              "alertIncidents": [
                {
                  "properties": {
                    "alertIncidentType": "TooManyPermanentOwnersAssignedToResourceAlertIncident",
                    "assigneeName": "testUser",
                    "assigneeType": "User"
                  },
                  "name": "a9f38501-74ec-43ea-8663-6c538602150d",
                  "type": "Microsoft.Authorization/roleManagementAlerts/alertIncidents",
                  "id": "/subscriptions/afa2a084-766f-4003-8ae1-c4aeb893a99f/providers/Microsoft.Authorization/roleManagementAlerts/alerts/TooManyPermanentOwnersAssignedToResource/alertIncidents/a9f38501-74ec-43ea-8663-6c538602150d"
                }
              ],
              "alertConfiguration": {
                "properties": {
                  "alertConfigurationType": "TooManyPermanentOwnersAssignedToResourceAlertConfiguration",
                  "alertDefinitionId": "TooManyPermanentOwnersAssignedToResource",
                  "scope": "subscriptions/afa2a084-766f-4003-8ae1-c4aeb893a99f",
                  "isEnabled": true,
                  "thresholdNumberOfPermanentOwners": 10,
                  "thresholdPercentageOfPermanentOwnersOutOfAllOwners": 10
                },
                "name": "TooManyPermanentOwnersAssignedToResource",
                "id": "/subscriptions/afa2a084-766f-4003-8ae1-c4aeb893a99f/providers/Microsoft.Authorization/roleManagementAlerts/alertConfigurations/TooManyPermanentOwnersAssignedToResource",
                "type": "Microsoft.Authorization/roleManagementAlerts/alertConfigurations"
              }
            },
            "name": "TooManyPermanentOwnersAssignedToResource",
            "id": "/subscriptions/afa2a084-766f-4003-8ae1-c4aeb893a99f/providers/Microsoft.Authorization/roleManagementAlerts/alerts/TooManyPermanentOwnersAssignedToResource",
            "type": "Microsoft.Authorization/roleManagementAlerts/alerts"
          },
          {
            "properties": {
              "scope": "subscriptions/afa2a084-766f-4003-8ae1-c4aeb893a99f",
              "incidentCount": 1,
              "lastModifiedDateTime": "2022-04-05T03:04:06.467+00:00",
              "lastScannedDateTime": "2022-04-06T18:25:00.38+00:00",
              "isActive": true,
              "alertDefinition": {
                "properties": {
                  "displayName": "Too many owners assigned to a resource",
                  "scope": "subscriptions/afa2a084-766f-4003-8ae1-c4aeb893a99f",
                  "description": "The number of users with the Owner role is too high. We recommend assigning these individuals to less privileged roles or roles more suitable to their daily needs. Take a moment to review the current assignments, and suggested changes here.",
                  "severityLevel": "Medium",
                  "securityImpact": "As the number of users with the owner role increases, so does the potential for malicious or mistaken actions affecting your resource.",
                  "mitigationSteps": "To mitigate this issue, reduce the number of users in the Owner role. Review the list of users in the list, and reassign them to a less privileged role such as Contributor.",
                  "howToPrevent": "Choose a role that provides the fewest privileges necessary for a user or group to complete their tasks.",
                  "isRemediatable": true,
                  "isConfigurable": true
                },
                "name": "TooManyOwnersAssignedToResource",
                "id": "/subscriptions/afa2a084-766f-4003-8ae1-c4aeb893a99f/providers/Microsoft.Authorization/roleManagementAlerts/alertDefinitions/TooManyOwnersAssignedToResource",
                "type": "Microsoft.Authorization/roleManagementAlerts/alertDefinitions"
              },
              "alertIncidents": [
                {
                  "properties": {
                    "alertIncidentType": "TooManyOwnersAssignedToResourceAlertIncident",
                    "assigneeName": "testUser",
                    "assigneeType": "User"
                  },
                  "name": "a9f38501-74ec-43ea-8663-6c538602150d",
                  "type": "Microsoft.Authorization/roleManagementAlerts/alertIncidents",
                  "id": "/subscriptions/afa2a084-766f-4003-8ae1-c4aeb893a99f/providers/Microsoft.Authorization/roleManagementAlerts/alerts/TooManyOwnersAssignedToResource/alertIncidents/a9f38501-74ec-43ea-8663-6c538602150d"
                }
              ],
              "alertConfiguration": {
                "properties": {
                  "alertConfigurationType": "TooManyOwnersAssignedToResourceAlertConfiguration",
                  "alertDefinitionId": "TooManyOwnersAssignedToResource",
                  "scope": "subscriptions/afa2a084-766f-4003-8ae1-c4aeb893a99f",
                  "isEnabled": true,
                  "thresholdNumberOfOwners": 2,
                  "thresholdPercentageOfOwnersOutOfAllRoleMembers": 3
                },
                "name": "TooManyOwnersAssignedToResource",
                "id": "/subscriptions/afa2a084-766f-4003-8ae1-c4aeb893a99f/providers/Microsoft.Authorization/roleManagementAlerts/alertConfigurations/TooManyOwnersAssignedToResource",
                "type": "Microsoft.Authorization/roleManagementAlerts/alertConfigurations"
              }
            },
            "name": "TooManyOwnersAssignedToResource",
            "id": "/subscriptions/afa2a084-766f-4003-8ae1-c4aeb893a99f/providers/Microsoft.Authorization/roleManagementAlerts/alerts/TooManyOwnersAssignedToResource",
            "type": "Microsoft.Authorization/roleManagementAlerts/alerts"
          }
        ]
      }
    }
  }
}
