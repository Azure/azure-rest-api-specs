openapi: "3.0.2"
info:
  title: Delegation
  version: 2022-04-01-preview
  description: Use these REST APIs for performing operations on delegation and their operations associated with your Azure API Management deployment.

paths:
  /delegation/settings:
    description: Delegation settings
    get:
      operationId: DelegationSettings_Get
      x-apim-auth-rules:
        isPublic: true
      x-ms-examples:
        DelegationSettings_Get:
          $ref: "../examples/GetDelegationSettings.json"
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: ../schemas/delegationOperations.json#/definitions/DelegationSettings

  /delegation/urls/{action}:
    description: Unauthorized delegation URLs (Signin, Signup)
    post:
      operationId: DelegationSigninUrl_Create
      x-apim-auth-rules:
        isPublic: true
      parameters:
        - $ref: "#/components/parameters/action"
      requestBody:
        content:
          application/json:
            schema:
              $ref: ../schemas/delegationOperations.json#/definitions/DelegationOperationRequest
      x-ms-examples:
        DelegationSigninUrl_Create:
          $ref: "../examples/CreateDelegationSigninUrl.json"
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: ../schemas/delegationOperations.json#/definitions/DelegationOperationResponse

  /delegation/urls/users/{userId}/{action}:
    description: User specific delegation urls (CloseAccount, ChangePassword, ChangeProfile, Subscribe, Unsubscribe, Renew, Signout)
    post:
      operationId: UserDelegationUrl_Create
      x-apim-auth-rules:
        allowRules:
          - owner: "{userId}"
      parameters:
        - $ref: "#/components/parameters/userId"
        - $ref: "#/components/parameters/action"
      requestBody:
        content:
          application/json:
            schema:
              $ref: ../schemas/delegationOperations.json#/definitions/UserDelegationOperationRequest
      x-ms-examples:
        UserDelegationUrl_Create:
          $ref: "../examples/CreateUserDelegationUrl.json"
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: ../schemas/delegationOperations.json#/definitions/UserDelegationOperationResponse

components:
  parameters:
    userId:
      name: userId
      in: path
      description: Id of user
      required: true
      schema:
        type: string
    action:
      name: action
      in: path
      description: Action name
      required: true
      schema:
        type: string
