import "@typespec/http";
import "@typespec/rest";
import "@azure-tools/typespec-azure-core";
import "./models.persongroup.tsp";

using TypeSpec.Http;
using TypeSpec.Rest;
using Azure.Core;
using Azure.Core.Traits;
using Foundations;

namespace Face;

alias AddPersonGroupPersonFaceSummary = "Add a face to a person into a person group for face identification or verification.";
alias AddPersonGroupPersonFaceDescription = """
To deal with an image containing multiple faces, input face can be specified as an image with a targetFace rectangle. It returns a persistedFaceId representing the added face. No image will be stored. Only the extracted face feature(s) will be stored on server until PersonGroup PersonFace - Delete, PersonGroup Person - Delete or PersonGroup - Delete is called.
Note persistedFaceId is different from faceId generated by Face - Detect.

${AddFaceDescription}
""";
alias AddLargePersonGroupPersonFaceSummary = "Add a face to a person into a large person group for face identification or verification.";
alias AddLargePersonGroupPersonFaceDescription = """
To deal with an image containing multiple faces, input face can be specified as an image with a targetFace rectangle. It returns a persistedFaceId representing the added face. No image will be stored. Only the extracted face feature(s) will be stored on server until LargePersonGroup PersonFace - Delete, LargePersonGroup Person - Delete or LargePersonGroup - Delete is called.
Note persistedFaceId is different from faceId generated by Face - Detect.

${AddFaceDescription}
""";

interface PersonGroupOperations {
  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Create has no response body while standard op requires resource in body"
  @summary("Create a new person group with specified personGroupId, name, user-provided userData and recognitionModel.")
  @doc("""
  A person group is a container holding the uploaded person data, including face recognition features.
  After creation, use PersonGroup Person - Create to add persons into the group, and then call PersonGroup - Train to get this group ready for Face - Identify.
  No image will be stored. Only the person's extracted face feature(s) and userData will be stored on server until PersonGroup Person - Delete or PersonGroup - Delete is called.

  'recognitionModel' should be specified to associate with this person group. The default value for 'recognitionModel' is 'recognition_01', if the latest model needed, please explicitly specify the model you need in this parameter. New faces that are added to an existing person group will use the recognition model that's already associated with the collection. Existing face feature(s) in a person group can't be updated to features extracted by another version of recognition model.

  > [!NOTE]
  > * Free-tier subscription quota: 1,000 person groups. Each holds up to 1,000 persons.
  > * S0-tier subscription quota: 1,000,000 person groups. Each holds up to 10,000 persons.
  > * to handle larger scale face identification problem, please consider using LargePersonGroup.
  """)
  createPersonGroup is FaceCollectionResourceCreateOperation<PersonGroup>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Delete response with 200 while standard op requires 204"
  @doc("Delete an existing person group with specified personGroupId. Persisted data in this person group will be deleted.")
  deletePersonGroup is FaceResourceDeleteOperation<PersonGroup>;

  @doc("Retrieve person group name, userData and recognitionModel. To get person information under this personGroup, use PersonGroup Person - List.")
  getPersonGroup is FaceResourceReadOperationWithReturnRecognitionModelOptions<PersonGroup>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Update has no response body while standard op requires resource in body"
  @doc("Update an existing person group's name and userData. The properties keep unchanged if they are not in request body.")
  @returnsDoc("A successful call returns an empty response body.")
  updatePersonGroup is FaceResourceUpdateOperation<PersonGroup>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "List doesn't support Azure paging"
  @summary("List person groups' personGroupId, name, userData and recognitionModel.")
  @doc(
    """
  * Person groups are stored in alphabetical order of personGroupId.
  ${ListRequestOptionsDescription}
  """
  )
  getPersonGroups is FaceResourceListOperation<
    PersonGroup,
    PersonGroup,
    ReturnRecognitionModelOptions
  >;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Doesn't fit standard ops"
  @doc("To check person group training status completed or still ongoing. PersonGroup Training is an asynchronous operation triggered by PersonGroup - Train API.")
  getPersonGroupTrainingStatus is FaceResourceGetTrainingStatus<PersonGroup>;

  @pollingOperation(PersonGroupOperations.getPersonGroupTrainingStatus)
  @summary("Submit a person group training task. Training is a crucial step that only a trained person group can be used by Face - Identify.")
  @doc("""
  The training task is an asynchronous task. Training time depends on the number of person entries, and their faces in a person group. It could be several seconds to minutes. To check training status, please use PersonGroup - Get Training Status.
  """)
  trainPersonGroup is FaceResourceTrain<PersonGroup>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Create person perform on resource collection but not response created resource location in header"
  @summary("Create a new person in a specified person group. To add face to this person, please call PersonGroup PersonFace - Add.")
  @doc("""
  > [!NOTE]
  > * Free-tier subscription quota:
  >   * 1,000 persons in all person groups.
  > * S0-tier subscription quota:
  >   * 10,000 persons per person group.
  >   * 1,000,000 person groups.
  >   * 100,000,000 persons in all person groups.
  """)
  createPersonGroupPerson is FaceResourceCreateWithServiceProvidedName<
    PersonGroupPerson,
    UserDefinedFields,
    CreatePersonResult
  >;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Delete response with 200 while standard op requires 204"
  @doc("Delete an existing person from a person group. The persistedFaceId, userData, person name and face feature(s) in the person entry will all be deleted.")
  deletePersonGroupPerson is FaceResourceDeleteOperation<PersonGroupPerson>;

  @doc("Retrieve a person's name and userData, and the persisted faceIds representing the registered person face feature(s).")
  getPersonGroupPerson is Operations.ResourceRead<PersonGroupPerson>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Update has no response body while standard op requires resource in body"
  @doc("Update name or userData of a person.")
  updatePersonGroupPerson is FaceResourceUpdateOperation<PersonGroupPerson>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "List doesn't support Azure paging"
  @summary("List all persons' information in the specified person group, including personId, name, userData and persistedFaceIds of registered person faces.")
  @doc(
    """
  Persons are stored in alphabetical order of personId created in PersonGroup Person - Create.
  ${ListRequestOptionsDescription}
  """
  )
  getPersonGroupPersons is FaceResourceListOperation<PersonGroupPerson>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Add face perform on resource collection but not response created resource location in header"
  #suppress "@azure-tools/typespec-azure-core/byos" "It's an RPC call to detect face from an image, it doesn't store anything. There's a BYOS version of this call, but it's not this one."
  @summary(AddPersonGroupPersonFaceSummary)
  @doc(AddPersonGroupPersonFaceDescription)
  addPersonGroupPersonFace is AddFace<PersonGroupPersonFace>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Add face perform on resource collection but not response created resource location in header"
  @summary(AddPersonGroupPersonFaceSummary)
  @doc(AddPersonGroupPersonFaceDescription)
  addPersonGroupPersonFaceFromUrl is AddFaceFromUrl<PersonGroupPersonFace>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Delete response with 200 while standard op requires 204"
  @summary("Delete a face from a person in a person group by specified personGroupId, personId and persistedFaceId.")
  @doc("""
  Adding/deleting faces to/from a same person will be processed sequentially. Adding/deleting faces to/from different persons are processed in parallel.
  """)
  deletePersonGroupPersonFace is FaceResourceDeleteOperation<PersonGroupPersonFace>;

  @doc("Retrieve person face information. The persisted person face is specified by its personGroupId, personId and persistedFaceId.")
  getPersonGroupPersonFace is Operations.ResourceRead<PersonGroupPersonFace>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Update has no response body while standard op requires resource in body"
  @doc("Update a person persisted face's userData field.")
  updatePersonGroupPersonFace is FaceResourceUpdateOperation<
    PersonGroupPersonFace,
    FaceUserData
  >;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Create has no response body while standard op requires resource in body"
  @summary("Create a new large person group with user-specified largePersonGroupId, name, an optional userData and recognitionModel.")
  @doc("""
  A large person group is a container holding the uploaded person data, including the face recognition features. It can hold up to 1,000,000 entities.
  After creation, use LargePersonGroup Person - Create to add person into the group, and call LargePersonGroup - Train to get this group ready for Face - Identify.
  No image will be stored. Only the person's extracted face feature(s) and userData will be stored on server until LargePersonGroup Person - Delete or LargePersonGroup - Delete is called.

  'recognitionModel' should be specified to associate with this large person group. The default value for 'recognitionModel' is 'recognition_01', if the latest model needed, please explicitly specify the model you need in this parameter. New faces that are added to an existing large person group will use the recognition model that's already associated with the collection. Existing face feature(s) in a large person group can't be updated to features extracted by another version of recognition model.

  > [!NOTE]
  > * Free-tier subscription quota: 1,000 large person groups.
  > * S0-tier subscription quota: 1,000,000 large person groups.
  """)
  createLargePersonGroup is FaceCollectionResourceCreateOperation<LargePersonGroup>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Delete response with 200 while standard op requires 204"
  @doc("Delete an existing large person group with specified personGroupId. Persisted data in this large person group will be deleted.")
  deleteLargePersonGroup is FaceResourceDeleteOperation<LargePersonGroup>;

  @doc("Retrieve the information of a large person group, including its name, userData and recognitionModel. This API returns large person group information only, use LargePersonGroup Person - List instead to retrieve person information under the large person group.")
  getLargePersonGroup is FaceResourceReadOperationWithReturnRecognitionModelOptions<LargePersonGroup>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Update has no response body while standard op requires resource in body"
  @doc("Update an existing large person group's name and userData. The properties keep unchanged if they are not in request body.")
  updateLargePersonGroup is FaceResourceUpdateOperation<LargePersonGroup>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "List doesn't support Azure paging"
  @summary("List all existing large person groups' largePersonGroupId, name, userData and recognitionModel.")
  @doc(
    """
  * Large person groups are stored in alphabetical order of largePersonGroupId.
  ${ListRequestOptionsDescription}
  """
  )
  getLargePersonGroups is FaceResourceListOperation<
    LargePersonGroup,
    LargePersonGroup,
    ReturnRecognitionModelOptions
  >;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Doesn't fit standard ops"
  @summary("To check large person group training status completed or still ongoing. LargePersonGroup Training is an asynchronous operation triggered by LargePersonGroup - Train API.")
  @doc("""
  Training time depends on the number of person entries, and their faces in a large person group. It could be in seconds, or up to half an hour for 1,000,000 persons.
  """)
  getLargePersonGroupTrainingStatus is FaceResourceGetTrainingStatus<LargePersonGroup>;

  @pollingOperation(PersonGroupOperations.getLargePersonGroupTrainingStatus)
  @summary("Submit a large person group training task. Training is a crucial step that only a trained large person group can be used by Face - Identify.")
  @doc("""
  The training task is an asynchronous task. Training time depends on the number of person entries, and their faces in a large person group. It could be in several seconds, or up to half a hour for 1,000,000 persons. To check training completion, please use LargePersonGroup - Get Training Status.
  """)
  trainLargePersonGroup is FaceResourceTrain<LargePersonGroup>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Create person perform on resource collection but not response created resource location in header"
  @summary("Create a new person in a specified large person group. To add face to this person, please call LargePersonGroup PersonFace - Add.")
  @doc("""
  > [!NOTE]
  > * Free-tier subscription quota:
  >   * 1,000 persons in all large person groups.
  > * S0-tier subscription quota:
  >   * 1,000,000 persons per large person group.
  >   * 1,000,000 large person groups.
  >   * 1,000,000,000 persons in all large person groups. 
  """)
  createLargePersonGroupPerson is FaceResourceCreateWithServiceProvidedName<
    LargePersonGroupPerson,
    UserDefinedFields,
    CreatePersonResult
  >;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Delete response with 200 while standard op requires 204"
  @doc("Delete an existing person from a large person group. The persistedFaceId, userData, person name and face feature(s) in the person entry will all be deleted.")
  deleteLargePersonGroupPerson is FaceResourceDeleteOperation<LargePersonGroupPerson>;

  @doc("Retrieve a person's name and userData, and the persisted faceIds representing the registered person face feature(s).")
  getLargePersonGroupPerson is Operations.ResourceRead<LargePersonGroupPerson>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Update has no response body while standard op requires resource in body"
  @doc("Update name or userData of a person.")
  updateLargePersonGroupPerson is FaceResourceUpdateOperation<LargePersonGroupPerson>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "List doesn't support Azure paging"
  @summary("List all persons' information in the specified large person group, including personId, name, userData and persistedFaceIds of registered person faces.")
  @doc(
    """
  * Persons are stored in alphabetical order of personId created in LargePersonGroup Person - Create.
  ${ListRequestOptionsDescription}
  """
  )
  getLargePersonGroupPersons is FaceResourceListOperation<LargePersonGroupPerson>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Add face perform on resource collection but not response created resource location in header"
  #suppress "@azure-tools/typespec-azure-core/byos" "It's an RPC call to detect face from an image, it doesn't store anything. There's a BYOS version of this call, but it's not this one."
  @summary(AddLargePersonGroupPersonFaceSummary)
  @doc(AddLargePersonGroupPersonFaceDescription)
  addLargePersonGroupPersonFace is AddFace<LargePersonGroupPersonFace>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Add face perform on resource collection but not response created resource location in header"
  @summary(AddLargePersonGroupPersonFaceSummary)
  @doc(AddLargePersonGroupPersonFaceDescription)
  addLargePersonGroupPersonFaceFromUrl is AddFaceFromUrl<LargePersonGroupPersonFace>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Delete response with 200 while standard op requires 204"
  @summary("Delete a face from a person in a large person group by specified largePersonGroupId, personId and persistedFaceId.")
  @doc("""
  Adding/deleting faces to/from a same person will be processed sequentially. Adding/deleting faces to/from different persons are processed in parallel.
  """)
  deleteLargePersonGroupPersonFace is FaceResourceDeleteOperation<LargePersonGroupPersonFace>;

  @doc("Retrieve person face information. The persisted person face is specified by its largePersonGroupId, personId and persistedFaceId.")
  getLargePersonGroupPersonFace is Operations.ResourceRead<LargePersonGroupPersonFace>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Update has no response body while standard op requires resource in body"
  @doc("Update a person persisted face's userData field.")
  updateLargePersonGroupPersonFace is FaceResourceUpdateOperation<
    LargePersonGroupPersonFace,
    FaceUserData
  >;
}
