import "@typespec/http";
import "@typespec/rest";
import "@azure-tools/typespec-azure-core";
import "./models.facelist.tsp";

using TypeSpec.Http;
using TypeSpec.Rest;
using Azure.Core;
using Azure.Core.Traits;
using Foundations;

namespace Face;

alias AddFaceListFaceSummary = "Add a face to a specified face list, up to 1,000 faces.";
alias AddFaceListFaceDescription = """
To deal with an image containing multiple faces, input face can be specified as an image with a targetFace rectangle. It returns a persistedFaceId representing the added face. No image will be stored. Only the extracted face feature(s) will be stored on server until FaceList - Delete Face or FaceList - Delete is called.
Note persistedFaceId is different from faceId generated by Face - Detect.

${AddFaceDescription}
""";
alias AddLargeFaceListFaceSummary = "Add a face to a specified large face list, up to 1,000,000 faces.";
alias AddLargeFaceListFaceDescription = """
To deal with an image containing multiple faces, input face can be specified as an image with a targetFace rectangle. It returns a persistedFaceId representing the added face. No image will be stored. Only the extracted face feature(s) will be stored on server until LargeFaceList - Delete Face or LargeFaceList - Delete is called.
Note persistedFaceId is different from faceId generated by Face - Detect.

${AddFaceDescription}

> [!NOTE]
> * Free-tier subscription quota: 1,000 faces per large face list.
> * S0-tier subscription quota: 1,000,000 faces per large face list.
""";

interface FaceListOperations {
  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Create has no response body while standard op requires resource in body"
  @summary("Create an empty face list with user-specified faceListId, name, an optional userData and recognitionModel.")
  @doc("""
  Up to 64 face lists are allowed in one subscription.
  Face list is a list of faces, up to 1,000 faces, and used by Face - Find Similar.
  After creation, user should use FaceList - Add Face to import the faces. No image will be stored. Only the extracted face feature(s) will be stored on server until FaceList - Delete is called.
  Find Similar is used for scenario like finding celebrity-like faces, similar face filtering, or as a light way face identification. But if the actual use is to identify person, please use PersonGroup / LargePersonGroup and Face - Identify.
  Please consider LargeFaceList when the face number is large. It can support up to 1,000,000 faces.
  """)
  createFaceList is FaceCollectionResourceCreateOperation<FaceList>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Delete response with 200 while standard op requires 204"
  @doc("Delete a specified face list.")
  deleteFaceList is FaceResourceDeleteOperation<FaceList>;

  @doc("Retrieve a face list's faceListId, name, userData, recognitionModel and faces in the face list.")
  getFaceList is FaceResourceReadOperationWithReturnRecognitionModelOptions<FaceList>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Update has no response body while standard op requires resource in body"
  @doc("Update information of a face list, including name and userData.")
  updateFaceList is FaceResourceUpdateOperation<FaceList>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "List doesn't support Azure paging"
  @doc("""
  List face lists' faceListId, name, userData and recognitionModel.
  To get face information inside faceList use Get Face List.
  """)
  getFaceLists is Foundations.ResourceList<
    FaceList,
    ReturnRecognitionModelOptions,
    Body<FaceListItem[]>,
    ServiceTraits
  >;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Add face perform on resource collection but not response created resource location in header"
  #suppress "@azure-tools/typespec-azure-core/byos" "It's an RPC call to detect face from an image, it doesn't store anything. There's a BYOS version of this call, but it's not this one."
  @summary(AddFaceListFaceSummary)
  @doc(AddFaceListFaceDescription)
  addFaceListFace is AddFace<FaceListFace>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Add face perform on resource collection but not response created resource location in header"
  @summary(AddFaceListFaceSummary)
  @doc(AddFaceListFaceDescription)
  addFaceListFaceFromUrl is AddFaceFromUrl<FaceListFace>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Delete response with 200 while standard op requires 204"
  @summary("Delete a face from a face list by specified faceListId and persistedFaceId.")
  @doc("Adding/deleting faces to/from a same face list are processed sequentially and to/from different face lists are in parallel.")
  deleteFaceListFace is FaceResourceDeleteOperation<FaceListFace>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Create has no response body while standard op requires resource in body"
  @summary("Create an empty large face list with user-specified largeFaceListId, name, an optional userData and recognitionModel.")
  @doc("""
  Large face list is a list of faces, up to 1,000,000 faces, and used by Find Similar.
  After creation, user should use Add Large Face List Face to import the faces and Train Large Face List to make it ready for Find Similar. No image will be stored. Only the extracted face feature(s) will be stored on server until Delete Large Face List is called.
  Find Similar is used for scenario like finding celebrity-like faces, similar face filtering, or as a light way face identification. But if the actual use is to identify person, please use Person Group / Large Person Group and Identify.

  > [!NOTE]
  > * Free-tier subscription quota: 64 large face lists.
  > * S0-tier subscription quota: 1,000,000 large face lists.
  """)
  createLargeFaceList is FaceCollectionResourceCreateOperation<LargeFaceList>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Delete response with 200 while standard op requires 204"
  @summary("Delete a face from a large face list by specified largeFaceListId and persistedFaceId.")
  @doc("Adding/deleting faces to/from a same large face list are processed sequentially and to/from different large face lists are in parallel.")
  deleteLargeFaceList is FaceResourceDeleteOperation<LargeFaceList>;

  @doc("Retrieve a large face list's largeFaceListId, name, userData and recognitionModel.")
  getLargeFaceList is FaceResourceReadOperationWithReturnRecognitionModelOptions<LargeFaceList>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Update has no response body while standard op requires resource in body"
  @doc("Update information of a large face list, including name and userData.")
  updateLargeFaceList is FaceResourceUpdateOperation<LargeFaceList>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "List doesn't support Azure paging"
  @summary("List large face lists' information of largeFaceListId, name, userData and recognitionModel.")
  @doc(
    """
  To get face information inside largeFaceList use LargeFaceList Face - Get.
  Large face lists are stored in alphabetical order of largeFaceListId.
  ${ListRequestOptionsDescription}
  """
  )
  getLargeFaceLists is FaceResourceListOperation<
    LargeFaceList,
    LargeFaceList,
    ReturnRecognitionModelOptions
  >;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "GET operation on resource with sub-path"
  @doc("""
  To check the large face list training status completed or still ongoing. LargeFaceList Training is an asynchronous operation triggered by Train Large Face List.
  Training time depends on the number of face entries in a large face list. It could be in seconds, or up to half an hour for 1,000,000 faces.
  """)
  getLargeFaceListTrainingStatus is FaceResourceGetTrainingStatus<LargeFaceList>;

  @summary("Submit a large face list training task.")
  @doc("""
  Training is a crucial step that only a trained large face list can be used by Find Similar.
  The training task is an asynchronous task. Training time depends on the number of face entries in a large face list. It could be in seconds, or up to half an hour for 1,000,000 faces. To check training completion, please use Get Large Face List Training Status.
  """)
  @returnsDoc("A successful call returns an empty response body.")
  @pollingOperation(FaceListOperations.getLargeFaceListTrainingStatus)
  trainLargeFaceList is FaceResourceTrain<LargeFaceList>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Add face perform on resource collection but not response created resource location in header"
  #suppress "@azure-tools/typespec-azure-core/byos" "It's an RPC call to detect face from an image, it doesn't store anything. There's a BYOS version of this call, but it's not this one."
  @summary(AddLargeFaceListFaceSummary)
  @doc(AddLargeFaceListFaceDescription)
  addLargeFaceListFace is AddFace<LargeFaceListFace>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Add face perform on resource collection but not response created resource location in header"
  @summary(AddLargeFaceListFaceSummary)
  @doc(AddLargeFaceListFaceDescription)
  addLargeFaceListFaceFromUrl is AddFaceFromUrl<LargeFaceListFace>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Delete response with 200 while standard op requires 204"
  @doc("Delete a face from a large face list by specified largeFaceListId and persistedFaceId.")
  deleteLargeFaceListFace is FaceResourceDeleteOperation<LargeFaceListFace>;

  @doc("Retrieve persisted face in large face list by largeFaceListId and persistedFaceId.")
  getLargeFaceListFace is Operations.ResourceRead<LargeFaceListFace>;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "Update has no response body while standard op requires resource in body"
  @doc("Update a specified face's userData field in a large face list by its persistedFaceId.")
  updateLargeFaceListFace is FaceResourceUpdateOperation<
    LargeFaceListFace,
    FaceUserData
  >;

  #suppress "@azure-tools/typespec-azure-core/use-standard-operations" "List doesn't support Azure paging"
  @summary("List faces' persistedFaceId and userData in a specified large face list.")
  @doc(
    """
  Faces are stored in alphabetical order of persistedFaceId created in LargeFaceList Face - Add.
  ${ListRequestOptionsDescription}
  """
  )
  getLargeFaceListFaces is FaceResourceListOperation<LargeFaceListFace>;
}
