import "@typespec/http";
import "@typespec/rest";
import "@azure-tools/typespec-autorest";
import "@typespec/versioning";
import "@azure-tools/typespec-azure-core";
import "../common/models.tsp";
import "./models.tsp";
import "../servicepatterns.tsp";

using TypeSpec.Http;
using TypeSpec.Rest;
using TypeSpec.Versioning;
using Azure.Core;
using Azure.Core.Traits;
using Azure.Core.Foundations;

namespace Azure.AI.Projects;

alias ListDatasetVersionsParameters = {
  @doc("Please choose OrderBy value from ['createdtime', 'modifiedtime']")
  @query("$orderBy")
  $orderBy?: string;

  @doc("Top count of results, top count cannot be greater than the page size. If topCount > page size, results with be default page size count will be returned")
  @query("$top")
  $top?: int32;

  @doc("Continuation token for pagination.")
  @query("$skip")
  $skip?: string;

  @doc("Comma-separated list of tag names (and optionally values). Example: tag1,tag2=value2")
  @query("$tags")
  $tags?: string;

  @doc("[ListViewType.ActiveOnly, ListViewType.ArchivedOnly, ListViewType.All] View type for including/excluding (for example) archived entities.")
  @query("listViewType")
  listViewType?: ListViewType;
};

alias ListLatestDataSetVersionParameters = {
  @doc("View type for including/excluding (for example) archived entities.")
  @query("listViewType")
  listViewType?: ListViewType;
};

#suppress "@azure-tools/typespec-azure-core/use-standard-operations" "We are using service specific operation templates"
interface Datasets
  extends ServicePatterns.VersionedOperations<
      DatasetVersion,
      ListLatestDataSetVersionParameters,
      ListDatasetVersionsParameters
    > {
  @doc("Create or start a pending upload of a dataset for a specific version.")
  startPendingUpload is ServicePatterns.VersionedResourceAction<
    DatasetVersion,
    PendingUploadRequest,
    PendingUploadResponse
  >;

  @doc("Create or start a pending upload of a dataset. The dataset version will be generated by service.")
  @Rest.actionSeparator("/")
  @Rest.action("startPendingUpload")
  @Http.post
  startPendingUploadAutoIncrement is ServicePatterns.BuildingBlocks.RepeatableCoreOps.ResourceAction<
    DatasetVersion,
    PendingUploadRequest,
    PendingUploadResponse
  >;
}
